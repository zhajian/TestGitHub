(function(b,c){var a=function(q,v){var k=this;var Z=b.extend({},b.fn.ace_scroll.defaults,v);this.size=0;this.lock=false;this.lock_anyway=false;this.$element=b(q);this.element=q;var y=true;var L=false;var X=false;var V=false;var i=null,ab=null;var ae=null,I=null,u=null,T=null;var A=null;var aa=0,O=0,e=0,r=0,W=true;var p=false;var m="";var j=false;var x=0;var P,G,d,K,t,l;var S=1;var C=false;var g=false;var D="onmouseup" in window?window:"html";var M=Z.dragEvent||false;var z=v.scrollEvent||false;var ag=Z.detached||false;var ad=Z.updatePos||false;var f=Z.hideOnIdle||false;var s=Z.hideDelay||1500;var w=false;var Q=Z.observeContent||false;var J=0;var ac=true;this.create=function(ak){if(V){return}if(ak){Z=b.extend({},b.fn.ace_scroll.defaults,ak)}this.size=parseInt(this.$element.attr("data-size"))||Z.size||200;y=!Z.horizontal;P=y?"top":"left";G=y?"height":"width";d=y?"maxHeight":"maxWidth";K=y?"clientHeight":"clientWidth";t=y?"scrollTop":"scrollLeft";l=y?"scrollHeight":"scrollWidth";this.$element.addClass("ace-scroll");if(this.$element.css("position")=="static"){C=this.element.style.position;this.element.style.position="relative"}else{C=false}var ah=null;if(!ag){this.$element.wrapInner('<div class="scroll-content" />');this.$element.prepend('<div class="scroll-track"><div class="scroll-bar"></div></div>')}else{ah=b('<div class="scroll-track scroll-detached"><div class="scroll-bar"></div></div>').appendTo("body")}i=this.$element;if(!ag){i=this.$element.find(".scroll-content").eq(0)}if(!y){i.wrapInner("<div />")}ab=i.get(0);if(ag){ae=ah;N()}else{ae=this.$element.find(".scroll-track").eq(0)}I=ae.find(".scroll-bar").eq(0);u=ae.get(0);T=I.get(0);A=T.style;if(!y){ae.addClass("scroll-hz")}if(Z.styleClass){m=Z.styleClass;ae.addClass(m);j=!!m.match(/scroll\-left|scroll\-top/)}if(x==0){ae.show();B()}ae.hide();ae.on("mousedown",E);I.on("mousedown",n);i.on("scroll",function(){if(W){O=parseInt(Math.round(this[t]*S));A[P]=O+"px"}W=false;if(z){this.$element.trigger("scroll",[ab])}});if(Z.mouseWheel){this.lock=Z.mouseWheelLock;this.lock_anyway=Z.lockAnyway;this.$element.on(!!b.event.special.mousewheel?"mousewheel.ace_scroll":"mousewheel.ace_scroll DOMMouseScroll.ace_scroll",function(ap){if(L){return}R(true);if(!X){return !k.lock_anyway}if(g){g=false;b("html").off(".ace_scroll");b(D).off(".ace_scroll");if(M){k.$element.trigger("drag.end")}}ap.deltaY=ap.deltaY||0;var ar=(ap.deltaY>0||ap.originalEvent.detail<0||ap.originalEvent.wheelDelta>0)?1:-1;var am=false;var ao=ab[K],aq=ab[t];if(!k.lock){if(ar==-1){am=(ab[l]<=aq+ao)}else{am=(aq==0)}}k.move_bar(true);var an=parseInt(ao/8);if(an<80){an=80}if(an>k.size){an=k.size}an+=1;ab[t]=aq-(ar*an);return am&&!k.lock_anyway})}var ai=ace.vars.touch&&"ace_drag" in b.event.special&&Z.touchDrag;if(ai){var aj="",al=ai?"ace_drag":"swipe";this.$element.on(al+".ace_scroll",function(am){if(L){am.retval.cancel=true;return}R(true);if(!X){am.retval.cancel=this.lock_anyway;return}aj=am.direction;if((y&&(aj=="up"||aj=="down"))||(!y&&(aj=="left"||aj=="right"))){var an=y?am.dy:am.dx;if(an!=0){if(Math.abs(an)>20&&ai){an=an*2}k.move_bar(true);ab[t]=ab[t]+an}}})}if(f){ae.addClass("idle-hide")}if(Q){ae.on("mouseenter.ace_scroll",function(){w=true;R(false)}).on("mouseleave.ace_scroll",function(){w=false;if(g==false){U()}})}this.$element.on("mouseenter.ace_scroll touchstart.ace_scroll",function(am){ac=true;if(Q){R(true)}else{if(Z.hoverReset){k.reset(true)}}ae.addClass("scroll-hover")}).on("mouseleave.ace_scroll touchend.ace_scroll",function(){ae.removeClass("scroll-hover")});if(!y){i.children(0).css(G,this.size)}i.css(d,this.size);L=false;V=true};this.is_active=function(){return X};this.is_enabled=function(){return !L};this.move_bar=function(ah){W=ah};this.get_track=function(){return u};this.reset=function(al){if(L){return}if(!V){this.create()}var ak=this.size;if(al&&!ac){return}ac=false;if(ag){var aj=parseInt(Math.round((parseInt(i.css("border-top-width"))+parseInt(i.css("border-bottom-width")))/2.5));ak-=aj}var ai=y?ab[l]:ak;if((y&&ai==0)||(!y&&this.element.scrollWidth==0)){ae.removeClass("scroll-active");return}var ah=y?ak:ab.clientWidth;if(!y){i.children(0).css(G,ak)}i.css(d,this.size);if(ai>ah){X=true;ae.css(G,ah).show();S=parseFloat((ah/ai).toFixed(5));aa=parseInt(Math.round(ah*S));r=parseInt(Math.round(aa/2));e=ah-aa;O=parseInt(Math.round(ab[t]*S));A[G]=aa+"px";A[P]=O+"px";ae.addClass("scroll-active");if(x==0){B()}if(!p){if(Z.reset){ab[t]=0;A[P]=0}p=true}if(ag){N()}}else{X=false;ae.hide();ae.removeClass("scroll-active");i.css(d,"")}return};this.disable=function(){ab[t]=0;A[P]=0;L=true;X=false;ae.hide();this.$element.addClass("scroll-disabled");ae.removeClass("scroll-active");i.css(d,"")};this.enable=function(){L=false;this.$element.removeClass("scroll-disabled")};this.destroy=function(){X=false;L=false;V=false;this.$element.removeClass("ace-scroll scroll-disabled scroll-active");this.$element.off(".ace_scroll");if(!ag){if(!y){i.find("> div").children().unwrap()}i.children().unwrap();i.remove()}ae.remove();if(C!==false){this.element.style.position=C}if(o!=null){clearTimeout(o);o=null}};this.modify=function(ah){if(ah){Z=b.extend({},Z,ah)}this.destroy();this.create();ac=true;this.reset(true)};this.update=function(ah){if(ah){Z=b.extend({},Z,ah)}this.size=ah.size||this.size;this.lock=ah.mouseWheelLock||this.lock;this.lock_anyway=ah.lockAnyway||this.lock_anyway;if(ah.styleClass!=c){if(m){ae.removeClass(m)}m=ah.styleClass;if(m){ae.addClass(m)}j=!!m.match(/scroll\-left|scroll\-top/)}};this.start=function(){ab[t]=0};this.end=function(){ab[t]=ab[l]};this.hide=function(){ae.hide()};this.show=function(){ae.show()};this.update_scroll=function(){W=false;A[P]=O+"px";ab[t]=parseInt(Math.round(O/S))};function E(ak){ak.preventDefault();ak.stopPropagation();var aj=ae.offset();var ai=aj[P];var ah=y?ak.pageY:ak.pageX;if(ah>ai+O){O=ah-ai-aa+r;if(O>e){O=e}}else{O=ah-ai-r;if(O<0){O=0}}k.update_scroll()}var H=-1,F=-1;function n(ah){ah.preventDefault();ah.stopPropagation();if(y){F=H=ah.pageY}else{F=H=ah.pageX}g=true;b("html").off("mousemove.ace_scroll").on("mousemove.ace_scroll",Y);b(D).off("mouseup.ace_scroll").on("mouseup.ace_scroll",h);ae.addClass("active");if(M){k.$element.trigger("drag.start")}}function Y(ah){ah.preventDefault();ah.stopPropagation();if(y){F=ah.pageY}else{F=ah.pageX}if(F-H+O>e){F=H+e-O}else{if(F-H+O<0){F=H-O}}O=O+(F-H);H=F;if(O<0){O=0}else{if(O>e){O=e}}k.update_scroll()}function h(ah){ah.preventDefault();ah.stopPropagation();g=false;b("html").off(".ace_scroll");b(D).off(".ace_scroll");ae.removeClass("active");if(M){k.$element.trigger("drag.end")}if(X&&f&&!w){U()}}var o=null;var af=0;function R(aj){var ai=+new Date();if(Q&&ai-af>1000){var ah=ab[l];if(J!=ah){J=ah;ac=true;k.reset(true)}af=ai}if(X&&f){if(o!=null){clearTimeout(o);o=null}ae.addClass("not-idle");if(!w&&aj==true){U()}}}function U(){if(o!=null){clearTimeout(o);o=null}o=setTimeout(function(){o=null;ae.removeClass("not-idle")},s)}function B(){ae.css("visibility","hidden").addClass("scroll-hover");if(y){x=parseInt(ae.outerWidth())||0}else{x=parseInt(ae.outerHeight())||0}ae.css("visibility","").removeClass("scroll-hover")}this.track_size=function(){if(x==0){B()}return x};function N(){if(ad===false){return}var aj=i.offset();var ai=aj.left;var ah=aj.top;if(y){if(!j){ai+=(i.outerWidth()-x)}}else{if(!j){ah+=(i.outerHeight()-x)}}if(ad===true){ae.css({top:parseInt(ah),left:parseInt(ai)})}else{if(ad==="left"){ae.css("left",parseInt(ai))}else{if(ad==="top"){ae.css("top",parseInt(ah))}}}}this.create();ac=true;this.reset(true);J=ab[l];return this};b.fn.ace_scroll=function(f,g){var e;var d=this.each(function(){var j=b(this);var i=j.data("ace_scroll");var h=typeof f==="object"&&f;if(!i){j.data("ace_scroll",(i=new a(this,h)))}if(typeof f==="string"){e=i[f](g)}});return(e===c)?d:e};b.fn.ace_scroll.defaults={size:200,horizontal:false,mouseWheel:true,mouseWheelLock:false,lockAnyway:false,styleClass:false,observeContent:false,hideOnIdle:false,hideDelay:1500,hoverReset:true,reset:false,dragEvent:false,touchDrag:true,touchSwipe:false,scrollEvent:false,detached:false,updatePos:true}})(window.jQuery);