jQuery(function(f){var a="#grid-table";var b="#grid-pager";jQuery(a).jqGrid({url:G_CTX_PATH+"/merchant/list",datatype:"json",mtype:"GET",width:"300",height:"320",colNames:["租户号","租户名称","租户地址","租户联系人","联系电话","租户状态"],colModel:[{name:"merchantId",index:"merchantId",width:8,sortable:false},{name:"merchantName",index:"merchantName",width:18,sortable:false},{name:"merchantAddress",index:"merchantAddress",width:25,sortable:false},{name:"merchantContacts",index:"merchantContacts",width:8,sortable:false},{name:"contactNumber",index:"contactNumber",width:12,sortable:false},{name:"statusStr",index:"statusStr",width:8,sortable:false},],jsonReader:{root:"rows",total:function(h){var g=h.total;var i=parseInt(f("#grid-table").getGridParam("rowNum"));return g%i>0?g/i+1:g/i},page:"page",records:"total",repeatitems:false},postData:{},viewrecords:true,rowNum:10,rowList:[10,20,30],pager:b,altRows:true,multiboxonly:true,loadComplete:function(){var g=this;setTimeout(function(){updatePagerIcons(g)},0)},autowidth:true});function e(){f("#grid-table").jqGrid("setGridParam",{page:1});f("#grid-table").jqGrid("setGridParam",{postData:{merchantName:f("#sn").val(),merchantContacts:f("#mac").val(),contactNumber:f("#ssid").val(),merchantStatus:f("#onOff").val()},datatype:"json"}).trigger("reloadGrid")}function d(){f("#grid-table").jqGrid("setGridParam",{page:1});f("#grid-table").jqGrid("setGridParam",{postData:{},datatype:"json"}).trigger("reloadGrid")}click_tree_menu(function(g){f("#merchantId").val(g.attr("node"));e()});f("#equipmentSearchBtn").on("click",function(){e()});f("#healthBtn").on("click",function(){var h=f("#grid-table").jqGrid("getGridParam","selrow");if(h==null){ui_error("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请选择行");return}var g=jQuery("#grid-table").jqGrid("getRowData",h);window.location.href=G_CTX_PATH+"/store/show?merchantId="+g.merchantId});f("#conCountBtn").on("click",function(){var h=f("#grid-table").jqGrid("getGridParam","selrow");if(h==null){ui_error("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请选择行");return}var g=jQuery("#grid-table").jqGrid("getRowData",h);window.location.href=G_CTX_PATH+"/merchant/showMerchantUser?merchantId="+g.merchantId});f("#createBtn").on("click",function(){f("#data_form")[0].reset();Hg.refRepeatSubmit("data_form");f("input[name=merchantId]").val("");f("#div_status").attr("hidden","hidden");f("#24healthModal").modal()});f("#updateBtn").on("click",function(){f("#data_form")[0].reset();var h=f("#grid-table").jqGrid("getGridParam","selrow");if(h==null){ui_error("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请选择行");return}Hg.refRepeatSubmit("data_form");var g=jQuery("#grid-table").jqGrid("getRowData",h);f("#div_status").removeAttr("hidden");Hg.post("/merchant/getMerchantById",{id:g.merchantId},function(i){if(i.success){var j=i.merchant;c(j);f("#24healthModal").modal()}else{ui_error(i.data)}})});f("#save").on("click",function(){var j=f("input[name=merchantId]").val();var g="/merchant/insert";if(j!=""){g="/merchant/update"}var h=f("input[name=merchantName").val();if(h==""){ui_error("请填写租户名");return}var i=f("input[name=contactNumber").val();if(i==""){ui_error("请填联系方式");return}Hg.post(g,f("#data_form").serializeArray(),function(k){if(k.success){ui_alert("保存成功！",function(){d()})}else{Hg.refreshSubmitToken("data_form");ui_error(k.data)}f("#24healthModal").modal("hide")})});function c(g){f("input[name=merchantId]").val(g.merchantId);f("input[name=merchantName]").val(g.merchantName);f("input[name=merchantAddress]").val(g.merchantAddress);f("input[name=merchantContacts]").val(g.merchantContacts);f("input[name=contactNumber]").val(g.contactNumber);f("input[name=merchantTitle]").val(g.merchantTitle);f("input[name=merchantDesc]").val(g.merchantDesc);f("select[name=merchantStatus]").val(g.merchantStatus)}});