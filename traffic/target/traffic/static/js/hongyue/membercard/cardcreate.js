jQuery(function(c){var a="#grid-table";var b="#grid-pager";c.post(G_CTX_PATH+"/merchant/list",function(d){c("#merchantId").append("<option value=''>----请选择商户----</option>");c(d.rows).each(function(){var e=c("<option value='"+this.merchantId+"'>"+this.merchantName+"</option>");c("#merchantId").append(e)})});c.validator.addMethod("zhengshu",function(f,d){var e=/^[1-9]{1}[0-9]{0,9}/;return this.optional(d)||e.test(f)},"请输入大于1的整数");c.validator.addMethod("notnull",function(e,d){return(c("#merchantId").val()!="")},"请选择商户");c.validator.addMethod("effectime",function(e,d){return(c("#effecDate").val()!="")},"请选择有效日期");c("#createCardForm").validate({rules:{nums:{required:true,zhengshu:true},merchantId:{required:true,notnull:true},effecDate:{required:true,effectime:true}}});Hg.refRepeatSubmit("createCardForm");c("#createCardForm [tag=save]").click(function(){if(!c("#createCardForm").validate().form()){return false}var e=c(this);e.addClass("disabled").removeClass("btn-primary");var d=c("#createCardForm").serializeArray();c.ajax({type:"POST",url:G_CTX_PATH+"/mms/mcard/createCard",data:d,success:function(f,h,g){if(f.success){ui_alert("生成成功",function(){})}else{ajaxExceptionHandler(g,function(){Hg.refreshSubmitToken("createCardForm");ui_error(f.data)})}},complete:function(f,g){e.addClass("btn-primary").removeClass("disabled")}})})});