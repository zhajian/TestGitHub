jQuery(function(f){var a="#grid-table";var b="#grid-pager";jQuery(a).jqGrid({url:G_CTX_PATH+"/store/list",datatype:"json",mtype:"GET",width:"300",height:"320",colNames:["门店号","门店名称","门店地址","门店联系人","联系电话","门店状态"],colModel:[{name:"storeId",index:"storeId",width:8,sortable:false},{name:"storeName",index:"storeName",width:18,sortable:false},{name:"storeAddress",index:"storeAddress",width:25,sortable:false},{name:"storeContacts",index:"storeContacts",width:8,sortable:false},{name:"contactNumber",index:"contactNumber",width:12,sortable:false},{name:"statusStr",index:"statusStr",width:8,sortable:false},],jsonReader:{root:"rows",total:function(h){var g=h.total;var i=parseInt(f("#grid-table").getGridParam("rowNum"));return g%i>0?g/i+1:g/i},page:"page",records:"total",repeatitems:false},postData:{merchantId:f("#merchantId").val(),storeStatus:f("#onOff").val()},viewrecords:true,rowNum:10,rowList:[10,20,30],pager:b,altRows:true,multiboxonly:true,loadComplete:function(){var g=this;setTimeout(function(){updatePagerIcons(g)},0)},autowidth:true});function e(){f("#grid-table").jqGrid("setGridParam",{page:1});f("#grid-table").jqGrid("setGridParam",{postData:{storeName:f("#sn").val(),storeContacts:f("#mac").val(),contactNumber:f("#ssid").val(),storeStatus:f("#onOff").val()},datatype:"json"}).trigger("reloadGrid")}click_tree_menu(function(g){f("#merchantId").val(g.attr("node"));e()});f("#equipmentSearchBtn").on("click",function(){e()});function d(){f("#grid-table").jqGrid("setGridParam",{page:1});f("#grid-table").jqGrid("setGridParam",{postData:{},datatype:"json"}).trigger("reloadGrid")}f("#healthBtn").on("click",function(){f("#data_form")[0].reset();Hg.refRepeatSubmit("data_form");f("input[name=storeId]").val("");f("#div_status").attr("hidden","hidden");f("#24healthModal").modal()});f("#updateBtn").on("click",function(){f("#data_form")[0].reset();var h=f("#grid-table").jqGrid("getGridParam","selrow");if(h==null){ui_error("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;请选择行");return}Hg.refRepeatSubmit("data_form");var g=jQuery("#grid-table").jqGrid("getRowData",h);f("#div_status").removeAttr("hidden");Hg.post("/store/getStoreById",{id:g.storeId},function(j){if(j.success){var i=j.store;c(i);f("#24healthModal").modal()}else{ui_error(j.data)}})});f("#save").on("click",function(){var g=f("input[name=storeId]").val();var i="/store/insert";if(g!=""){i="/store/update"}var h=f("input[name=storeName").val();if(h==""){ui_error("请填写门店名");return}var j=f("input[name=contactNumber").val();if(j==""){ui_error("请填联系方式");return}Hg.post(i,f("#data_form").serializeArray(),function(k){if(k.success){ui_alert("保存成功！",function(){d()})}else{Hg.refreshSubmitToken("data_form");ui_error(k.data)}f("#24healthModal").modal("hide")})});function c(g){f("input[name=storeId]").val(g.storeId);f("input[name=storeName]").val(g.storeName);f("input[name=storeAddress]").val(g.storeAddress);f("input[name=storeContacts]").val(g.storeContacts);f("input[name=contactNumber]").val(g.contactNumber);f("input[name=storeDesc]").val(g.storeDesc);f("select[name=storeStatus]").val(g.storeStatus)}});