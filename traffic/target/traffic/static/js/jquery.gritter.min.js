(function(c){c.gritter={};c.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1000,time:6000};c.gritter.add=function(a){try{return d.add(a||{})}catch(b){var e="Gritter Error: "+b;(typeof(console)!="undefined"&&console.error)?console.error(e,a):alert(e)}};c.gritter.remove=function(a,b){d.removeSpecific(a,b||{})};c.gritter.removeAll=function(a){d.stop(a||{})};var d={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(v){if(typeof(v)=="string"){v={text:v}}if(v.text===null){throw'You must supply "text" parameter.'}if(!this._is_setup){this._runSetup()}var r=v.title,b=v.text,x=v.image||"",q=v.sticky||false,p=v.class_name||c.gritter.options.class_name,s=v.position||c.gritter.options.position,y=v.time||"";this._verifyWrapper();this._item_count++;var w=this._item_count,t=this._tpl_item;c(["before_open","after_open","before_close","after_close"]).each(function(f,e){d["_"+e+"_"+w]=(c.isFunction(v[e]))?v[e]:function(){}});this._custom_timer=0;if(y){this._custom_timer=y}var z=(x!="")?'<img src="'+x+'" class="gritter-image" />':"",u=(x!="")?"gritter-with-image":"gritter-without-image";if(r){r=this._str_replace("[[title]]",r,this._tpl_title)}else{r=""}t=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[r,b,this._tpl_close,z,this._item_count,u,p],t);if(this["_before_open_"+w]()===false){return false}c("#gritter-notice-wrapper").addClass(s).append(t);var a=c("#gritter-item-"+this._item_count);a.fadeIn(this.fade_in_speed,function(){d["_after_open_"+w](c(this))});if(!q){this._setFadeTimer(a,w)}c(a).bind("mouseenter mouseleave",function(e){if(e.type=="mouseenter"){if(!q){d._restoreItemIfFading(c(this),w)}}else{if(!q){d._setFadeTimer(c(this),w)}}d._hoverState(c(this),e.type)});c(a).find(".gritter-close").click(function(){d.removeSpecific(w,{},null,true)});return w},_countRemoveWrapper:function(e,b,a){b.remove();this["_after_close_"+e](b,a);if(c(".gritter-item-wrapper").length==0){c("#gritter-notice-wrapper").remove()}},_fade:function(k,m,a,l){var a=a||{},b=(typeof(a.fade)!="undefined")?a.fade:true,n=a.speed||this.fade_out_speed,e=l;this["_before_close_"+m](k,e);if(l){k.unbind("mouseenter mouseleave")}if(b){k.animate({opacity:0},n,function(){k.animate({height:0},300,function(){d._countRemoveWrapper(m,k,e)})})}else{this._countRemoveWrapper(m,k)}},_hoverState:function(a,b){if(b=="mouseenter"){a.addClass("hover");a.find(".gritter-close").show()}else{a.removeClass("hover");a.find(".gritter-close").hide()}},removeSpecific:function(h,a,b,e){if(!b){var b=c("#gritter-item-"+h)}this._fade(b,h,a||{},e)},_restoreItemIfFading:function(a,b){clearTimeout(this["_int_id_"+b]);a.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in c.gritter.options){this[opt]=c.gritter.options[opt]}this._is_setup=1},_setFadeTimer:function(a,b){var e=(this._custom_timer)?this._custom_timer:this.time;this["_int_id_"+b]=setTimeout(function(){d._fade(a,b)},e)},stop:function(b){var h=(c.isFunction(b.before_close))?b.before_close:function(){};var a=(c.isFunction(b.after_close))?b.after_close:function(){};var g=c("#gritter-notice-wrapper");h(g);g.fadeOut(function(){c(this).remove();a()})},_str_replace:function(B,y,f,i){var s=0,w=0,D="",j="",x=0,a=0,r=[].concat(B),A=[].concat(y),C=f,z=A instanceof Array,b=C instanceof Array;C=[].concat(C);if(i){this.window[i]=0}for(s=0,x=C.length;s<x;s++){if(C[s]===""){continue}for(w=0,a=r.length;w<a;w++){D=C[s]+"";j=z?(A[w]!==undefined?A[w]:""):A[0];C[s]=(D).split(r[w]).join(j);if(i&&C[s]!==D){this.window[i]+=(D.length-C[s].length)/r[w].length}}}return b?C:C[0]},_verifyWrapper:function(){if(c("#gritter-notice-wrapper").length==0){c("body").append(this._tpl_wrap)}}}})(jQuery);