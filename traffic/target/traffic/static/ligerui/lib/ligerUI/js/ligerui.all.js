(function($){Function.prototype.ligerExtend=function(parent,overrides){if(typeof parent!="function"){return this}this.base=parent.prototype;this.base.constructor=parent;var f=function(){};f.prototype=parent.prototype;this.prototype=new f();this.prototype.constructor=this;if(overrides){$.extend(this.prototype,overrides)}};Function.prototype.ligerDefer=function(o,defer,args){var fn=this;return setTimeout(function(){fn.apply(o,args||[])},defer)};window.liger=$.ligerui={version:"V1.2.0",managerCount:0,managers:{},managerIdPrev:"ligerui",autoNewId:true,error:{managerIsExist:"管理器id已经存在"},pluginPrev:"liger",getId:function(prev){prev=prev||this.managerIdPrev;var id=prev+(1000+this.managerCount);this.managerCount++;return id},add:function(manager){if(arguments.length==2){var m=arguments[1];m.id=m.id||m.options.id||arguments[0].id;this.addManager(m);return}if(!manager.id){manager.id=this.getId(manager.__idPrev())}if(this.managers[manager.id]){manager.id=this.getId(manager.__idPrev())}if(this.managers[manager.id]){throw new Error(this.error.managerIsExist)}this.managers[manager.id]=manager},remove:function(arg){if(typeof arg=="string"||typeof arg=="number"){delete liger.managers[arg]}else{if(typeof arg=="object"){if(arg instanceof liger.core.Component){delete liger.managers[arg.id]}else{if(!$(arg).attr(this.idAttrName)){return false}delete liger.managers[$(arg).attr(this.idAttrName)]}}}},get:function(arg,idAttrName){idAttrName=idAttrName||"ligeruiid";if(typeof arg=="string"||typeof arg=="number"){return liger.managers[arg]}else{if(typeof arg=="object"){var domObj=arg.length?arg[0]:arg;var id=domObj[idAttrName]||$(domObj).attr(idAttrName);if(!id){return null}return liger.managers[id]}}return null},find:function(type){var arr=[];for(var id in this.managers){var manager=this.managers[id];if(type instanceof Function){if(manager instanceof type){arr.push(manager)}}else{if(type instanceof Array){if($.inArray(manager.__getType(),type)!=-1){arr.push(manager)}}else{if(manager.__getType()==type){arr.push(manager)}}}}return arr},run:function(plugin,args,ext){if(!plugin){return}ext=$.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:false,hasElement:true,propertyToElemnt:null},ext||{});plugin=plugin.replace(/^ligerGet/,"");plugin=plugin.replace(/^liger/,"");if(this==null||this==window||ext.isStatic){if(!liger.plugins[plugin]){liger.plugins[plugin]={fn:$[liger.pluginPrev+plugin],isStatic:true}}return new $.ligerui[ext.controlNamespace][plugin]($.extend({},$[ext.defaultsNamespace][plugin]||{},$[ext.defaultsNamespace][plugin+"String"]||{},args.length>0?args[0]:{}))}if(!liger.plugins[plugin]){liger.plugins[plugin]={fn:$.fn[liger.pluginPrev+plugin],isStatic:false}}if(/Manager$/.test(plugin)){return liger.get(this,ext.idAttrName)}this.each(function(){if(this[ext.idAttrName]||$(this).attr(ext.idAttrName)){var manager=liger.get(this[ext.idAttrName]||$(this).attr(ext.idAttrName));if(manager&&args.length>0){manager.set(args[0])}return}if(args.length>=1&&typeof args[0]=="string"){return}var options=args.length>0?args[0]:null;var p=$.extend({},$[ext.defaultsNamespace][plugin],$[ext.defaultsNamespace][plugin+"String"],options);if(ext.propertyToElemnt){p[ext.propertyToElemnt]=this}if(ext.hasElement){new $.ligerui[ext.controlNamespace][plugin](this,p)}else{new $.ligerui[ext.controlNamespace][plugin](p)}});if(this.length==0){return null}if(args.length==0){return liger.get(this,ext.idAttrName)}if(typeof args[0]=="object"){return liger.get(this,ext.idAttrName)}if(typeof args[0]=="string"){var manager=liger.get(this,ext.idAttrName);if(manager==null){return}if(args[0]=="option"){if(args.length==2){return manager.get(args[1])}else{if(args.length>=3){return manager.set(args[1],args[2])}}}else{var method=args[0];if(!manager[method]){return}var parms=Array.apply(null,args);parms.shift();return manager[method].apply(manager,parms)}}return null},defaults:{},methods:{},core:{},controls:{},plugins:{}};$.ligerDefaults={};$.ligerMethos={};liger.defaults=$.ligerDefaults;liger.methods=$.ligerMethos;$.fn.liger=function(plugin){if(plugin){return liger.run.call(this,plugin,arguments)}else{return liger.get(this)}};liger.core.Component=function(options){this.events=this.events||{};this.options=options||{};this.children={}};$.extend(liger.core.Component.prototype,{__getType:function(){return"liger.core.Component"},__idPrev:function(){return"ligerui"},set:function(arg,value){if(!arg){return}if(typeof arg=="object"){var tmp;if(this.options!=arg){$.extend(this.options,arg);tmp=arg}else{tmp=$.extend({},arg)}if(value==undefined||value==true){for(var p in tmp){if(p.indexOf("on")==0){this.set(p,tmp[p])}}}if(value==undefined||value==false){for(var p in tmp){if(p.indexOf("on")!=0){this.set(p,tmp[p])}}}return}var name=arg;if(name.indexOf("on")==0){if(typeof value=="function"){this.bind(name.substr(2),value)}return}if(!this.options){this.options={}}if(this.trigger("propertychange",[arg,value])==false){return}this.options[name]=value;var pn="_set"+name.substr(0,1).toUpperCase()+name.substr(1);if(this[pn]){this[pn].call(this,value)}this.trigger("propertychanged",[arg,value])},get:function(name){var pn="_get"+name.substr(0,1).toUpperCase()+name.substr(1);if(this[pn]){return this[pn].call(this,name)}return this.options[name]},hasBind:function(arg){var name=arg.toLowerCase();var event=this.events[name];if(event&&event.length){return true}return false},trigger:function(arg,data){if(!arg){return}var name=arg.toLowerCase();var event=this.events[name];if(!event){return}data=data||[];if((data instanceof Array)==false){data=[data]}for(var i=0;i<event.length;i++){var ev=event[i];if(ev.handler.apply(ev.context,data)==false){return false}}},bind:function(arg,handler,context){if(typeof arg=="object"){for(var p in arg){this.bind(p,arg[p])}return}if(typeof handler!="function"){return false}var name=arg.toLowerCase();var event=this.events[name]||[];context=context||this;event.push({handler:handler,context:context});this.events[name]=event},unbind:function(arg,handler){if(!arg){this.events={};return}var name=arg.toLowerCase();var event=this.events[name];if(!event||!event.length){return}if(!handler){delete this.events[name]}else{for(var i=0,l=event.length;i<l;i++){if(event[i].handler==handler){event.splice(i,1);break}}}},destroy:function(){liger.remove(this)}});liger.core.UIComponent=function(element,options){liger.core.UIComponent.base.constructor.call(this,options);var extendMethods=this._extendMethods();if(extendMethods){$.extend(this,extendMethods)}this.element=element;this._init();this._preRender();this.trigger("render");this._render();this.trigger("rendered");this._rendered()};liger.core.UIComponent.ligerExtend(liger.core.Component,{__getType:function(){return"liger.core.UIComponent"},_extendMethods:function(){},_init:function(){this.type=this.__getType();if(!this.element){this.id=this.options.id||liger.getId(this.__idPrev())}else{this.id=this.options.id||this.element.id||liger.getId(this.__idPrev())}liger.add(this);if(!this.element){return}var attributes=this.attr();if(attributes&&attributes instanceof Array){for(var i=0;i<attributes.length;i++){var name=attributes[i];this.options[name]=$(this.element).attr(name)}}var p=this.options;if($(this.element).attr("ligerui")){try{var attroptions=$(this.element).attr("ligerui");if(attroptions.indexOf("{")!=0){attroptions="{"+attroptions+"}"}eval("attroptions = "+attroptions+";");if(attroptions){$.extend(p,attroptions)}}catch(e){}}},_preRender:function(){},_render:function(){},_rendered:function(){if(this.element){$(this.element).attr("ligeruiid",this.id)}},attr:function(){return[]},destroy:function(){if(this.element){$(this.element).remove()}this.options=null;liger.remove(this)}});liger.controls.Input=function(element,options){liger.controls.Input.base.constructor.call(this,element,options)};liger.controls.Input.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Input"},attr:function(){return["nullText"]},setValue:function(value){return this.set("value",value)},getValue:function(){return this.get("value")},_setReadonly:function(readonly){var wrapper=this.wrapper||this.text;if(!wrapper||!wrapper.hasClass("l-text")){return}var inputText=this.inputText;if(readonly){if(inputText){inputText.attr("readonly","readonly")}wrapper.addClass("l-text-readonly")}else{if(inputText){inputText.removeAttr("readonly")}wrapper.removeClass("l-text-readonly")}},setEnabled:function(){return this.set("disabled",false)},setDisabled:function(){return this.set("disabled",true)},updateStyle:function(){},resize:function(width,height){this.set({width:width,height:height})}});liger.win={top:false,mask:function(win){function setHeight(){if(!liger.win.windowMask){return}var h=$(window).height()+$(window).scrollTop();liger.win.windowMask.height(h)}if(!this.windowMask){this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body");$(window).bind("resize.ligeruiwin",setHeight);$(window).bind("scroll",setHeight)}this.windowMask.show();setHeight();this.masking=true},unmask:function(win){var jwins=$("body > .l-dialog:visible,body > .l-window:visible");for(var i=0,l=jwins.length;i<l;i++){var winid=jwins.eq(i).attr("ligeruiid");if(win&&win.id==winid){continue}var winmanager=liger.get(winid);if(!winmanager){continue}var modal=winmanager.get("modal");if(modal){return}}if(this.windowMask){this.windowMask.hide()}this.masking=false},createTaskbar:function(){if(!this.taskbar){this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body");if(this.top){this.taskbar.addClass("l-taskbar-top")}this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar);this.tasks={}}this.taskbar.show();this.taskbar.animate({bottom:0});return this.taskbar},removeTaskbar:function(){var self=this;self.taskbar.animate({bottom:-32},function(){self.taskbar.remove();self.taskbar=null})},activeTask:function(win){for(var winid in this.tasks){var t=this.tasks[winid];if(winid==win.id){t.addClass("l-taskbar-task-active")}else{t.removeClass("l-taskbar-task-active")}}},getTask:function(win){var self=this;if(!self.taskbar){return}if(self.tasks[win.id]){return self.tasks[win.id]}return null},addTask:function(win){var self=this;if(!self.taskbar){self.createTaskbar()}if(self.tasks[win.id]){return self.tasks[win.id]}var title=win.get("title");var task=self.tasks[win.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+title+"</div></div>");self.taskbar.tasks.append(task);self.activeTask(win);task.bind("click",function(){self.activeTask(win);if(win.actived){win.min()}else{win.active()}}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")});return task},hasTask:function(){for(var p in this.tasks){if(this.tasks[p]){return true}}return false},removeTask:function(win){var self=this;if(!self.taskbar){return}if(self.tasks[win.id]){self.tasks[win.id].unbind();self.tasks[win.id].remove();delete self.tasks[win.id]}if(!self.hasTask()){self.removeTaskbar()}},setFront:function(win){var wins=liger.find(liger.core.Win);for(var i in wins){var w=wins[i];if(w==win){$(w.element).css("z-index","9200");this.activeTask(w)}else{$(w.element).css("z-index","9100")}}}};liger.core.Win=function(element,options){liger.core.Win.base.constructor.call(this,element,options)};liger.core.Win.ligerExtend(liger.core.UIComponent,{__getType:function(){return"liger.controls.Win"},mask:function(){if(this.options.modal){liger.win.mask(this)}},unmask:function(){if(this.options.modal){liger.win.unmask(this)}},min:function(){},max:function(){},active:function(){}});liger.draggable={dragging:false};liger.resizable={reszing:false};liger.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){var f=function(n){return n<10?"0"+n:n},escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,quote=function(value){escapable.lastIndex=0;return escapable.test(value)?'"'+value.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+value+'"'};if(o===null){return"null"}var type=typeof o;if(type==="undefined"){return undefined}if(type==="string"){return quote(o)}if(type==="number"||type==="boolean"){return""+o}if(type==="object"){if(typeof o.toJSON==="function"){return liger.toJSON(o.toJSON())}if(o.constructor===Date){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null}var pairs=[];if(o.constructor===Array){for(var i=0,l=o.length;i<l;i++){pairs.push(liger.toJSON(o[i])||"null")}return"["+pairs.join(",")+"]"}var name,val;for(var k in o){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=quote(k)}else{continue}}type=typeof o[k];if(type==="function"||type==="undefined"){continue}val=liger.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(",")+"}"}};liger.getEditor=function(e){var type=e.type,control=e.control,master=e.master;if(!type){return null}if(control){control=control.substr(0,1).toUpperCase()+control.substr(1)}return $.extend({create:function(container,editParm,controlOptions){var field=editParm.field||editParm.column,options=controlOptions||{};var isInGrid=editParm.column?true:false;var p=$.extend({},e.options);var inputType="text";if($.inArray(type,["password","file"])!=-1){inputType=type}if(e.password){inputType="password"}var inputBody=$("<input type='"+inputType+"'/>");if(e.body){inputBody=e.body.clone()}inputBody.appendTo(container);if(editParm.field){var txtInputName=field.name;var prefixID=$.isFunction(options.prefixID)?options.prefixID(master):(options.prefixID||"");p.id=field.id||(prefixID+field.name);if($.inArray(type,["select","combobox","autocomplete","popup"])!=-1){txtInputName=field.textField||field.comboboxName;if(field.comboboxName&&!field.id){p.id=(options.prefixID||"")+field.comboboxName}}if($.inArray(type,["select","combobox","autocomplete","popup","radiolist","checkboxlist","listbox"])!=-1){p.valueFieldID=prefixID+field.name}if(!e.body){var inputName=prefixID+txtInputName;inputBody.attr($.extend({name:inputName},field.attr));if(field.cssClass){inputBody.addClass(field.cssClass)}if(field.validate&&!master.options.unSetValidateAttr){inputBody.attr("validate",liger.toJSON(field.validate))}}$.extend(p,field.options)}if(field.editor){$.extend(p,field.editor.options);if(field.editor.valueColumnName){p.valueField=field.editor.valueColumnName}if(field.editor.displayColumnName){p.textField=field.editor.displayColumnName}if(control){var defaults=liger.defaults[control];for(var proName in defaults){if(proName in field.editor){p[proName]=field.editor[proName]}}}var ext=field.editor.p||field.editor.ext;ext=typeof(ext)=="function"?ext(editParm):ext;$.extend(p,ext)}var lobj=inputBody["liger"+control](p);if(isInGrid){setTimeout(function(){inputBody.focus()},100)}return lobj},getValue:function(editor,editParm){if(editor.getValue){return editor.getValue()}},setValue:function(editor,value,editParm){if(editor.setValue){editor.setValue(value)}},getText:function(editor,editParm){if(editor.getText){return editor.getText()}},setText:function(editor,value,editParm){if(editor.setText){editor.setText(value)}},getSelected:function(editor,editParm){if(editor.getSelected){return editor.getSelected()}},resize:function(editor,width,height,editParm){if(editParm.field){width=width-2}if(editor.resize){editor.resize(width,height)}},destroy:function(editor,editParm){if(editor.destroy){editor.destroy()}}},e)};liger.editors={text:{control:"TextBox"},date:{control:"DateEditor",setValue:function(editor,value,editParm){if(typeof value=="string"&&/^\/Date/.test(value)){value=value.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+value)}editor.setValue(value)}},combobox:{control:"ComboBox"},spinner:{control:"Spinner"},checkbox:{control:"CheckBox"},checkboxlist:{control:"CheckBoxList",body:$("<div></div>"),resize:function(editor,width,height,editParm){editor.set("width",width-2)}},radiolist:{control:"RadioList",body:$("<div></div>"),resize:function(editor,width,height,editParm){editor.set("width",width-2)}},listbox:{control:"ListBox",body:$("<div></div>"),resize:function(editor,width,height,editParm){editor.set("width",width-2)}},popup:{control:"PopupEdit"},number:{control:"TextBox",options:{number:true}},currency:{control:"TextBox",options:{currency:true}},digits:{control:"TextBox",options:{digits:true}},password:{control:"TextBox",password:true}};liger.editors.string=liger.editors.text;liger.editors.select=liger.editors.combobox;liger.editors["int"]=liger.editors.digits;liger.editors["float"]=liger.editors.number;liger.editors.chk=liger.editors.checkbox;liger.editors.popupedit=liger.editors.popup;$.fn.live=$.fn.on?$.fn.on:$.fn.live;if(!$.browser){var userAgent=navigator.userAgent.toLowerCase();$.browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)}}})(jQuery);(function(a){liger.inject={prev:"liger-",defaults:{Grid_detail:{height:null,onShowDetail:null},Grid_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Grid_editor",Grid_popup:"PopupEdit",Grid_grid:"Grid",Grid_condition:"Form",Grid_toolbar:"Toolbar",Grid_fields:"Form_fields",Form_editor:"ComboBox,DateEditor,Spinner,TextBox,PopupEdit,CheckBoxList,RadioList,Form_editor",Form_grid:"Grid",Form_columns:"Grid_columns",Form_condition:"Form",Form_popup:"PopupEdit",Form_buttons:"Button",Portal_panel:"Panel"},config:{Grid:{dynamics:"data,isChecked,detail,rowDraggingRender,toolbar,columns",arrays:"columns",columns:{dynamics:"render,totalSummary,headerRender,columns,editor,columns",arrays:"columns",textProperty:"display",columns:"liger.inject.config.Grid.columns",editor:{dynamics:"data,columns,render,renderItem,grid,condition,ext",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},toolbar:{arrays:"items"}},Form:{dynamics:"validate,fields,buttons",arrays:"fields,buttons",fields:{textProperty:"label",dynamics:"validate,editor",editor:{dynamics:"data,columns,render,renderItem,grid,condition,attr",grid:"liger.inject.config.Grid",condition:"liger.inject.config.Form"}},buttons:"liger.inject.config.Button"},PopupEdit:{dynamics:"grid,condition"},Button:{textProperty:"text",dynamics:"click"},ComboBox:{dynamics:"columns,data,tree,grid,condition,render,parms,renderItem"},ListBox:{dynamics:"columns,data,render,parms"},RadioList:{dynamics:"data,parms"},CheckBoxList:{dynamics:"data,parms"},Panel:{},Portal:{dynamics:"rows,columns",arrays:"rows,columns",columns:{dynamics:"panels",arrays:"panels"},rows:{dynamics:"panels",arrays:"panels"},toolbar:{arrays:"items"}}},parse:function(b){try{if(b==null){return null}return new Function("return "+b+";")()}catch(c){return null}},parseDefault:function(d){var c=this;if(!d){return d}var b={};a(d.split(",")).each(function(f,e){if(!e){return}e=e.substr(0,1).toUpperCase()+e.substr(1);a.extend(b,c.parse("liger.defaults."+e))});return b},fotmatValue:function(c,b){if(b=="boolean"){return c=="true"||c=="1"}if(b=="number"&&c){return parseFloat(c.toString())}return c},getOptions:function(n){var j=n.jelement,h=n.defaults,c=n.config;c=a.extend({ignores:"",dynamics:"",arrays:""},c);var m=this,t={},q;if(c.textProperty){t[c.textProperty]=j.text()}for(var k in h){var o=k.toLowerCase();var d=a("> ."+o,j);if(a.inArray(k,c.ignores.split(","))!=-1){continue}if(d.length){var r=n.controlName+"_"+k;var f=m.defaults[r]||liger.defaults[r],b=c[k];if(typeof(f)=="string"){f=m.parseDefault(f)}else{if(typeof(f)=="funcion"){f=f()}}if(typeof(b)=="string"){b=m.parse(b)}else{if(typeof(b)=="funcion"){b=b()}}if(f){if(a.inArray(k,c.arrays.split(","))!=-1){q=[];a(">div,>li,>input",d).each(function(){q.push(m.getOptions({defaults:f,controlName:n.controlName,config:b,jelement:a(this)}))});t[k]=q}else{t[k]=m.getOptions({defaults:f,controlName:n.controlName,config:b,jelement:d})}}d.remove()}else{if(a.inArray(k,c.dynamics.split(","))!=-1||k.indexOf("on")==0){q=m.parse(j.attr("data-"+k)||j.attr(k));if(q){t[k]=m.fotmatValue(q)}}else{q=j.attr("data-"+k)||j.attr(k);if(q){t[k]=m.fotmatValue(q)}}}}var s=j.attr("data-options")||j.attr("data-property");if(s){s=m.parse("{"+s+"}")}if(s){a.extend(t,s)}return t},init:function(){var e=this,h=this.config;for(var c in e.defaults){if(typeof(e.defaults[c])=="string"){e.defaults[c]=e.parseDefault(e.defaults[c])}}for(var f in liger.controls){var b=h[f]||{};var d=e.prev+f.toLowerCase();a("."+d).each(function(){var m=a(this),j;var k=a.extend({onrender:null,onrendered:null},liger.defaults[f]);var g=e.getOptions({defaults:k,controlName:f,config:b,jelement:m});m[liger.pluginPrev+f](g)})}}};a(function(){liger.inject.init()})})(jQuery);(function(a){a.fn.ligerAccordion=function(b){return a.ligerui.run.call(this,"ligerAccordion",arguments)};a.fn.ligerGetAccordionManager=function(){return a.ligerui.get(this)};a.ligerDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:false,heightDiff:0};a.ligerMethos.Accordion={};a.ligerui.controls.Accordion=function(c,b){a.ligerui.controls.Accordion.base.constructor.call(this,c,b)};a.ligerui.controls.Accordion.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return a.ligerMethos.Accordion},_render:function(){var c=this,d=this.options;c.accordion=a(c.element);if(!c.accordion.hasClass("l-accordion-panel")){c.accordion.addClass("l-accordion-panel")}var b=0;if(a("> div[lselected=true]",c.accordion).length>0){b=a("> div",c.accordion).index(a("> div[lselected=true]",c.accordion))}a("> div",c.accordion).each(function(e,f){var g=a('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');if(e==b){a(".l-accordion-toggle",g).addClass("l-accordion-toggle-open")}if(a(f).attr("title")){a(".l-accordion-header-inner",g).html(a(f).attr("title"));a(f).attr("title","")}a(f).before(g);if(!a(f).hasClass("l-accordion-content")){a(f).addClass("l-accordion-content")}});a(".l-accordion-toggle",c.accordion).each(function(){if(!a(this).hasClass("l-accordion-toggle-open")&&!a(this).hasClass("l-accordion-toggle-close")){a(this).addClass("l-accordion-toggle-close")}if(a(this).hasClass("l-accordion-toggle-close")){a(this).parent().next(".l-accordion-content:visible").hide()}});a(".l-accordion-header",c.accordion).hover(function(){a(this).addClass("l-accordion-header-over")},function(){a(this).removeClass("l-accordion-header-over")});a(".l-accordion-toggle",c.accordion).hover(function(){if(a(this).hasClass("l-accordion-toggle-open")){a(this).addClass("l-accordion-toggle-open-over")}else{if(a(this).hasClass("l-accordion-toggle-close")){a(this).addClass("l-accordion-toggle-close-over")}}},function(){if(a(this).hasClass("l-accordion-toggle-open")){a(this).removeClass("l-accordion-toggle-open-over")}else{if(a(this).hasClass("l-accordion-toggle-close")){a(this).removeClass("l-accordion-toggle-close-over")}}});a(">.l-accordion-header",c.accordion).click(function(){var e=a(".l-accordion-toggle:first",this);if(e.hasClass("l-accordion-toggle-close")){e.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over");e.addClass("l-accordion-toggle-open");a(this).next(".l-accordion-content").show(d.speed).siblings(".l-accordion-content:visible").hide(d.speed);a(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")}else{e.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close");a(this).next(".l-accordion-content").hide(d.speed)}});c.headerHoldHeight=0;a("> .l-accordion-header",c.accordion).each(function(){c.headerHoldHeight+=a(this).height()});if(d.height&&typeof(d.height)=="string"&&d.height.indexOf("%")>0){c.onResize();if(d.changeHeightOnResize){a(window).resize(function(){c.onResize()})}}else{if(d.height){c.height=d.heightDiff+d.height;c.accordion.height(c.height);c.setHeight(d.height)}else{c.header=c.accordion.height()}}c.set(d)},onResize:function(){var b=this,c=this.options;if(!c.height||typeof(c.height)!="string"||c.height.indexOf("%")==-1){return false}if(b.accordion.parent()[0].tagName.toLowerCase()=="body"){var d=a(window).height();d-=parseInt(b.layout.parent().css("paddingTop"));d-=parseInt(b.layout.parent().css("paddingBottom"));b.height=c.heightDiff+d*parseFloat(b.height)*0.01}else{b.height=c.heightDiff+(b.accordion.parent().height()*parseFloat(c.height)*0.01)}b.accordion.height(b.height);b.setContentHeight(b.height-b.headerHoldHeight)},setHeight:function(b){var c=this,d=this.options;c.accordion.height(b);b-=c.headerHoldHeight;a("> .l-accordion-content",c.accordion).height(b)}})})(jQuery);(function(a){a.fn.ligerButton=function(b){return a.ligerui.run.call(this,"ligerButton",arguments)};a.fn.ligerGetButtonManager=function(){return a.ligerui.run.call(this,"ligerGetButtonManager",arguments)};a.ligerDefaults.Button={width:60,text:"Button",disabled:false,click:null,icon:null};a.ligerMethos.Button={};a.ligerui.controls.Button=function(c,b){a.ligerui.controls.Button.base.constructor.call(this,c,b)};a.ligerui.controls.Button.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return a.ligerMethos.Button},_render:function(){var b=this,c=this.options;b.button=a(b.element);b.button.addClass("l-button");b.button.append('<div class="l-button-l"></div><div class="l-button-r"></div><span></span>');b.button.hover(function(){if(c.disabled){return}b.button.addClass("l-button-over")},function(){if(c.disabled){return}b.button.removeClass("l-button-over")});c.click&&b.button.click(function(){if(!c.disabled){c.click()}});b.set(c)},_setIcon:function(b){var c=this;if(!b){c.button.removeClass("l-button-hasicon");c.button.find("img").remove()}else{c.button.addClass("l-button-hasicon");c.button.append('<img src="'+b+'" />')}},_setEnabled:function(b){if(b){this.button.removeClass("l-button-disabled")}},_setDisabled:function(b){if(b){this.button.addClass("l-button-disabled");this.options.disabled=true}else{this.button.removeClass("l-button-disabled");this.options.disabled=false}},_setWidth:function(b){this.button.width(b)},_setText:function(b){a("span",this.button).html(b)},setValue:function(b){this.set("text",b)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",false)},setDisabled:function(){this.set("disabled",true)}})})(jQuery);(function(a){a.fn.ligerCheckBox=function(b){return a.ligerui.run.call(this,"ligerCheckBox",arguments)};a.fn.ligerGetCheckBoxManager=function(){return a.ligerui.run.call(this,"ligerGetCheckBoxManager",arguments)};a.ligerDefaults.CheckBox={disabled:false,readonly:false};a.ligerMethos.CheckBox={};a.ligerui.controls.CheckBox=function(c,b){a.ligerui.controls.CheckBox.base.constructor.call(this,c,b)};a.ligerui.controls.CheckBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return a.ligerMethos.CheckBox},_render:function(){var b=this,c=this.options;b.input=a(b.element);b.link=a('<a class="l-checkbox"></a>');b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent();b.wrapper.prepend(b.link);b.link.click(function(){if(b.input.attr("disabled")||b.input.attr("readonly")){return false}if(c.disabled||c.readonly){return false}if(b.trigger("beforeClick",[b.element])==false){return false}if(a(this).hasClass("l-checkbox-checked")){b._setValue(false)}else{b._setValue(true)}b.input.trigger("change")});b.wrapper.hover(function(){if(!c.disabled){a(this).addClass("l-over")}},function(){a(this).removeClass("l-over")});this.set(c);this.updateStyle()},_setCss:function(b){this.wrapper.css(b)},_setValue:function(c){var b=this,d=this.options;if(!c){b.input[0].checked=false;b.link.removeClass("l-checkbox-checked")}else{b.input[0].checked=true;b.link.addClass("l-checkbox-checked")}},_setDisabled:function(b){if(b){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled")}else{this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled")}},_getValue:function(){return this.element.checked},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked){this.link.addClass("l-checkbox-checked")}else{this.link.removeClass("l-checkbox-checked")}}})})(jQuery);(function(a){a.fn.ligerCheckBoxList=function(b){return a.ligerui.run.call(this,"ligerCheckBoxList",arguments)};a.ligerDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.CheckBoxList=a.ligerMethos.CheckBoxList||{};a.ligerui.controls.CheckBoxList=function(c,b){a.ligerui.controls.CheckBoxList.base.constructor.call(this,c,b)};a.ligerui.controls.CheckBoxList.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return a.ligerMethos.CheckBoxList},_init:function(){a.ligerui.controls.CheckBoxList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null){b.valueField[0].name=b.valueField[0].id}if(c.valueFieldCssClass){b.valueField.addClass(c.valueFieldCssClass)}b.valueField.attr("data-ligerid",b.id);b.checkboxList=a(this.element);b.checkboxList.html('<div class="l-checkboxlist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-checkboxlist-table"></table></div>').addClass("l-checkboxlist").append(b.valueField);b.checkboxList.table=a("table:first",b.checkboxList);b.set(c);b._addClickEven()},destroy:function(){if(this.checkboxList){this.checkboxList.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(b){if(b){this.checkboxList.addClass(b)}},_setDisabled:function(b){if(b){this.checkboxList.addClass("l-checkboxlist-disabled");a("input:checkbox",this.radioList).attr("disabled",true)}else{this.checkboxList.removeClass("l-checkboxlist-disabled");a("input:checkbox",this.radioList).removeAttr("disabled")}},_setWidth:function(b){this.checkboxList.width(b)},_setHeight:function(b){this.checkboxList.height(b)},indexOf:function(e){var d=this,f=this.options;if(!d.data){return -1}for(var c=0,b=d.data.length;c<b;c++){if(typeof(e)=="object"){if(d.data[c]==e){return c}}else{if(d.data[c][f.valueField].toString()==e.toString()){return c}}}return -1},removeItems:function(b){var c=this;if(!c.data){return}a(b).each(function(e,f){var d=c.indexOf(f);if(d==-1){return}c.data.splice(d,1)});c.refresh()},removeItem:function(c){if(!this.data){return}var b=this.indexOf(c);if(b==-1){return}this.data.splice(b,1);this.refresh()},insertItem:function(d,b){var c=this;if(!c.data){c.data=[]}c.data.splice(b,0,d);c.refresh()},addItems:function(b){var c=this;if(!c.data){c.data=[]}a(b).each(function(d,e){c.data.push(e)});c.refresh()},addItem:function(c){var b=this;if(!b.data){b.data=[]}b.data.push(c);b.refresh()},_setValue:function(c){var b=this,d=this.options;d.value=c;b.valueField.val(d.value);this._dataInit()},setValue:function(b){this._setValue(b)},_setUrl:function(b){if(!b){return}var d=this,e=this.options;var c=a.isFunction(e.parms)?e.parms():e.parms;a.ajax({type:"post",url:b,data:c,cache:false,dataType:"json",success:function(f){d.setData(f);d.trigger("success",[f])},error:function(f,g){d.trigger("error",[f,g])}})},setUrl:function(b){return this._setUrl(b)},setParm:function(b,e){if(!b){return}var d=this;var c=d.get("parms");if(!c){c={}}c[b]=e;d.set("parms",c)},clearContent:function(){var b=this,c=this.options;a("table",b.checkboxList).html("")},_setData:function(b){this.setData(b)},setData:function(c){var b=this,d=this.options;if(!c||!c.length){return}b.data=c;b.refresh();b.updateStyle()},refresh:function(){var m=this,d=this.options,j=this.data;this.clearContent();if(!j){return}var f=[],o=d.rowSize,n=false,b=d.name||m.id;for(var k=0;k<j.length;k++){var e=j[k][d.valueField],h=j[k][d.textField],c=m.id+"-"+k;var q=k%o==0;if(q){if(n){f.push("</tr>")}f.push("<tr>");n=true}f.push("<td><input type='checkbox' name='"+b+"' value='"+e+"' id='"+c+"'/><label for='"+c+"'>"+h+"</label></td>")}if(n){f.push("</tr>")}m.checkboxList.table.append(f.join(""))},_getValue:function(){var d=this,e=this.options,c=e.name||d.id;var b=[];a('input:checkbox[name="'+c+'"]:checked').each(function(){b.push(this.value)});if(!b.length){return null}return b.join(e.split)},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var b=this,d=this.options;var c=b.valueField.val();b._changeValue(c)},_changeValue:function(e){var d=this,f=this.options,c=f.name||d.id;var b=e?e.split(f.split):[];a("input:checkbox[name='"+c+"']",d.checkboxList).each(function(){this.checked=a.inArray(this.value,b)>-1});d.valueField.val(e);d.selectedValue=e},_addClickEven:function(){var b=this,c=this.options;b.checkboxList.click(function(f){var d=b.getValue();if(d){b.valueField.val(d)}})}})})(jQuery);(function(a){a.fn.ligerComboBox=function(b){return a.ligerui.run.call(this,"ligerComboBox",arguments)};a.fn.ligerGetComboBoxManager=function(){return a.ligerui.run.call(this,"ligerGetComboBoxManager",arguments)};a.ligerDefaults.ComboBox={resize:true,isMultiSelect:false,isShowCheckBox:false,columns:null,selectBoxWidth:null,selectBoxHeight:120,onBeforeSelect:false,onSelected:null,initValue:null,initText:null,valueField:"id",textField:"text",valueFieldID:null,slide:false,split:";",data:null,tree:null,treeLeafOnly:true,condition:null,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:true,hideGridOnLoseFocus:false,url:null,emptyText:"（空）",addRowButton:"新增",addRowButtonClick:null,triggerIcon:null,onSuccess:null,onError:null,onBeforeOpen:null,onButtonClick:null,render:null,absolute:true,cancelable:true,css:null,parms:null,renderItem:null,autocomplete:false,highLight:false,readonly:false,ajaxType:"post",alwayShowInTop:false,valueFieldCssClass:null};a.ligerDefaults.ComboBoxString={Search:"搜索"};a.ligerMethos.ComboBox=a.ligerMethos.ComboBox||{};a.ligerui.controls.ComboBox=function(c,b){a.ligerui.controls.ComboBox.base.constructor.call(this,c,b)};a.ligerui.controls.ComboBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return a.ligerMethos.ComboBox},_init:function(){a.ligerui.controls.ComboBox.base._init.call(this);var b=this.options;if(b.columns){b.isShowCheckBox=true}if(b.isMultiSelect){b.isShowCheckBox=true}},_render:function(){var b=this,c=this.options;b.data=c.data;b.inputText=null;b.select=null;b.textFieldID="";b.valueFieldID="";b.valueField=null;if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;b.inputText=a(this.element);b.textFieldID=this.element.id}else{if(this.element.tagName.toLowerCase()=="select"){a(this.element).hide();b.select=a(this.element);c.isMultiSelect=false;c.isShowCheckBox=false;c.cancelable=false;b.textFieldID=this.element.id+"_txt";b.inputText=a('<input type="text" readonly="true"/>');b.inputText.attr("id",b.textFieldID).insertAfter(a(this.element))}}if(b.inputText[0].name==undefined){b.inputText[0].name=b.textFieldID}b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input").filter("input:hidden");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"}if(c.valueFieldCssClass){b.valueField.addClass(c.valueFieldCssClass)}if(b.valueField[0].name==undefined){b.valueField[0].name=b.valueField[0].id}if(c.initValue!=null){b.valueField[0].value=c.initValue}b.valueField.attr("data-ligerid",b.id);b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');if(c.triggerIcon){b.link.find("div:first").addClass(c.triggerIcon)}b.selectBox=a('<div class="l-box-select" style="display:none"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>');b.selectBox.table=a("table:first",b.selectBox);b.selectBoxInner=b.selectBox.find(".l-box-select-inner:first");b.wrapper=b.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link);b.textwrapper=b.wrapper.wrap('<div class="l-text-wrapper"></div>').parent();if(c.absolute){b.selectBox.appendTo("body").addClass("l-box-select-absolute")}else{b.textwrapper.append(b.selectBox)}b.textwrapper.append(b.valueField);b.inputText.addClass("l-text-field");if(c.isShowCheckBox&&!b.select){a("table",b.selectBox).addClass("l-table-checkbox")}else{c.isShowCheckBox=false;a("table",b.selectBox).addClass("l-table-nocheckbox")}b.link.hover(function(){if(c.disabled||c.readonly){return}this.className="l-trigger-hover"},function(){if(c.disabled||c.readonly){return}this.className="l-trigger"}).mousedown(function(){if(c.disabled||c.readonly){return}this.className="l-trigger-pressed"}).mouseup(function(){if(c.disabled||c.readonly){return}this.className="l-trigger-hover"}).click(function(){if(c.disabled||c.readonly){return}if(b.trigger("buttonClick")==false){return false}if(b.trigger("beforeOpen")==false){return false}b._toggleSelectBox(b.selectBox.is(":visible"))});b.inputText.click(function(){if(c.disabled||c.readonly){return}if(b.trigger("beforeOpen")==false){return false}b._toggleSelectBox(b.selectBox.is(":visible"))}).blur(function(){if(c.disabled){return}b.wrapper.removeClass("l-text-focus")}).focus(function(){if(c.disabled||c.readonly){return}b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(c.disabled||c.readonly){return}b.wrapper.addClass("l-text-over")},function(){if(c.disabled||c.readonly){return}b.wrapper.removeClass("l-text-over")});b.resizing=false;b.selectBox.hover(null,function(d){if(c.hideOnLoseFocus&&b.selectBox.is(":visible")&&!b.boxToggling&&!b.resizing){b._toggleSelectBox(true)}});b.bulidContent();b.set(c);if(c.selectBoxWidth){b.selectBox.width(c.selectBoxWidth)}else{b.selectBox.css("width",b.wrapper.css("width"))}if(c.grid){b.bind("show",function(){if(!b.grid){b.setGrid(c.grid);b.set("SelectBoxHeight",c.selectBoxHeight)}})}b.updateSelectBoxPosition();a(document).bind("click.combobox",function(f){var d=(f.target||f.srcElement).tagName.toLowerCase();if(d=="html"||d=="body"){b._toggleSelectBox(true)}})},destroy:function(){if(this.wrapper){this.wrapper.remove()}if(this.selectBox){this.selectBox.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("","");a("a.l-checkbox-checked",this.selectBox).removeClass("l-checkbox-checked");a("td.l-selected",this.selectBox).removeClass("l-selected");a(":checkbox",this.selectBox).each(function(){this.checked=false});this.trigger("clear")},_setSelectBoxHeight:function(b){if(!b){return}var c=this,d=this.options;if(d.grid){c.grid&&c.grid.set("height",c.getGridHeight(b))}else{var e=a("tr",c.selectBox.table).length;if(!d.selectBoxHeight&&e<8){d.selectBoxHeight=e*30}if(d.selectBoxHeight){if(e<8){c.selectBoxInner.height("auto")}else{c.selectBoxInner.height(d.selectBoxHeight)}}}},_setCss:function(b){if(b){this.wrapper.addClass(b)}},_setCancelable:function(c){var b=this,d=this.options;if(!c&&b.unselect){b.unselect.remove();b.unselect=null}if(!c&&!b.unselect){return}b.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();b.wrapper.hover(function(){b.unselect.show()},function(){b.unselect.hide()});if(!d.disabled&&!d.readonly&&d.cancelable){b.wrapper.append(b.unselect)}b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){b.clear()})},_setDisabled:function(b){if(b){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},_setReadonly:function(b){if(b){this.wrapper.addClass("l-text-readonly")}else{this.wrapper.removeClass("l-text-readonly")}},_setLable:function(b){var c=this,d=this.options;if(b){if(c.labelwrapper){c.labelwrapper.find(".l-text-label:first").html(b+":&nbsp")}else{c.labelwrapper=c.textwrapper.wrap('<div class="l-labeltext"></div>').parent();c.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+b+":&nbsp</div>");c.textwrapper.css("float","left")}if(!d.labelWidth){d.labelWidth=a(".l-text-label",c.labelwrapper).outerWidth()}else{a(".l-text-label",c.labelwrapper).outerWidth(d.labelWidth)}a(".l-text-label",c.labelwrapper).width(d.labelWidth);a(".l-text-label",c.labelwrapper).height(c.wrapper.height());c.labelwrapper.append('<br style="clear:both;" />');if(d.labelAlign){a(".l-text-label",c.labelwrapper).css("text-align",d.labelAlign)}c.textwrapper.css({display:"inline"});c.labelwrapper.width(c.wrapper.outerWidth()+d.labelWidth+2)}},_setWidth:function(c){var b=this,d=this.options;if(c>20){b.wrapper.css({width:c});b.inputText.css({width:c-20});if(!d.selectBoxWidth){b.selectBox.css({width:c})}}},_setHeight:function(c){var b=this;if(c>10){b.wrapper.height(c);b.inputText.height(c-2)}},_setResize:function(b){var d=this,e=this.options;if(e.columns){return}if(b&&a.fn.ligerResizable){var c=e.selectBoxHeight?"e":"se,s,e";d.selectBox.ligerResizable({handles:c,onStartResize:function(){d.resizing=true;d.trigger("startResize")},onEndResize:function(){d.resizing=false;if(d.trigger("endResize")==false){return false}},onStopResize:function(g,f){if(d.grid){if(g.newWidth){d.selectBox.width(g.newWidth)}if(g.newHeight){d.set({selectBoxHeight:g.newHeight})}d.grid.refreshSize();d.trigger("endResize");return false}return true}});d.selectBox.append("<div class='l-btn-nw-drop'></div>")}},findTextByValue:function(e){var b=this,f=this.options;if(e==null){return""}var d="";var c=function(j){var g=e.toString().split(f.split);for(var h=0;h<g.length;h++){if(g[h]==j){return true}}return false};a(b.data).each(function(h,j){var k=j[f.valueField];var g=j[f.textField];if(c(k)){d+=g+f.split}});if(d.length>0){d=d.substr(0,d.length-1)}return d},findValueByText:function(f){var c=this,e=this.options;if(!f&&f==""){return""}var d=function(j){var g=f.toString().split(e.split);for(var h=0;h<g.length;h++){if(g[h]==j){return true}}return false};var b="";a(c.data).each(function(h,j){var k=j[e.valueField];var g=j[e.textField];if(d(g)){b+=k+e.split}});if(b.length>0){b=b.substr(0,b.length-1)}return b},insertItem:function(d,b){var c=this,e=this.options;c.data=c.data||[];c.data.splice(b,0,d);c.setData(c.data)},addItem:function(c){var b=this,d=this.options;b.insertItem(c,(b.data||[]).length)},_setValue:function(e,h){var d=this,f=this.options;h=d.findTextByValue(e);if(f.tree){d.selectValueByTree(e)}else{if(!f.isMultiSelect){d._changeValue(e,h);a("tr[value='"+e+"'] td",d.selectBox).addClass("l-selected");a("tr[value!='"+e+"'] td",d.selectBox).removeClass("l-selected")}else{d._changeValue(e,h);if(e!=null){var b=e.toString().split(f.split);a("table.l-table-checkbox :checkbox",d.selectBox).each(function(){this.checked=false});for(var c=0;c<b.length;c++){a("table.l-table-checkbox tr[value="+b[c]+"] :checkbox",d.selectBox).each(function(){this.checked=true})}}}}},selectValue:function(b){this._setValue(b)},bulidContent:function(){var b=this,c=this.options;this.clearContent();if(b.select){b.setSelect()}else{if(c.tree){b.setTree(c.tree)}}},reload:function(){var b=this,c=this.options;if(c.url){b.set("url",c.url)}else{if(b.grid){b.grid.reload()}}},_setUrl:function(b){if(!b){return}var d=this,e=this.options;var c=a.isFunction(e.parms)?e.parms():e.parms;a.ajax({type:e.ajaxType,url:b,data:c,cache:false,dataType:"json",success:function(f){d.setData(f);d.trigger("success",[f])},error:function(f,g){d.trigger("error",[f,g])}})},setUrl:function(b){return this._setUrl(b)},setParm:function(b,e){if(!b){return}var d=this;var c=d.get("parms");if(!c){c={}}c[b]=e;d.set("parms",c)},clearContent:function(){var b=this,c=this.options;a("table",b.selectBox).html("");b.inputText.val("");b.valueField.val("")},setSelect:function(){var b=this,c=this.options;this.clearContent();a("option",b.select).each(function(e){var g=a(this).val();var d=a(this).html();var f=a("<tr><td index='"+e+"' value='"+g+"' text='"+d+"'>"+d+"</td>");a("table.l-table-nocheckbox",b.selectBox).append(f);a("td",f).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})});a("td:eq("+b.select[0].selectedIndex+")",b.selectBox).each(function(){if(a(this).hasClass("l-selected")){b.selectBox.hide();return}a(".l-selected",b.selectBox).removeClass("l-selected");a(this).addClass("l-selected");if(b.select[0].selectedIndex!=a(this).attr("index")&&b.select[0].onchange){b.select[0].selectedIndex=a(this).attr("index");b.select[0].onchange()}var d=parseInt(a(this).attr("index"));b.select[0].selectedIndex=d;b.select.trigger("change");b.selectBox.hide();var e=a(this).attr("value");var f=a(this).html();if(c.render){b.inputText.val(c.render(e,f))}else{b.inputText.val(f)}});b._addClickEven()},_setData:function(b){this.setData(b)},setData:function(k){var n=this,b=this.options;if(!k||!k.length){k=[]}if(n.data!=k){n.data=k}this.clearContent();if(b.columns){n.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px'></td></tr>");n.selectBox.table.append(n.selectBox.table.headrow);n.selectBox.table.addClass("l-box-select-grid");for(var e=0;e<b.columns.length;e++){var q=a("<td columnindex='"+e+"' columnname='"+b.columns[e].name+"'>"+b.columns[e].header+"</td>");if(b.columns[e].width){q.width(b.columns[e].width)}n.selectBox.table.headrow.append(q)}}var f=[];if(b.emptyText&&!n.emptyRow){n.emptyRow={};n.emptyRow[b.textField]=b.emptyText;n.emptyRow[b.valueField]=null;k.splice(0,0,n.emptyRow)}for(var m=0;m<k.length;m++){var c=k[m][b.valueField];var h=k[m][b.textField];if(!b.columns){f.push("<tr value='"+c+"'>");if(b.isShowCheckBox){f.push("<td style='width:18px;'  index='"+m+"' value='"+c+"' text='"+h+"' ><input type='checkbox' /></td>")}var d=h;if(b.renderItem){d=b.renderItem.call(n,{data:k[m],value:c,text:h,key:n.inputText.val()})}else{if(b.autocomplete&&b.highLight){d=n._highLight(h,n.inputText.val())}}f.push("<td index='"+m+"' value='"+c+"' text='"+h+"' align='left'>"+d+"</td></tr>")}else{f.push("<tr value='"+c+"'><td style='width:18px;'  index='"+m+"' value='"+c+"' text='"+h+"' ><input type='checkbox' /></td>");for(var e=0;e<b.columns.length;e++){var o=b.columns[e].name;f.push("<td>"+k[m][o]+"</td>")}f.push("</tr>")}}if(!b.columns){if(b.isShowCheckBox){a("table.l-table-checkbox",n.selectBox).append(f.join(""))}else{a("table.l-table-nocheckbox",n.selectBox).append(f.join(""))}}else{n.selectBox.table.append(f.join(""))}if(b.addRowButton&&b.addRowButtonClick&&!n.addRowButton){n.addRowButton=a('<div class="l-box-select-add"><a href="javascript:void(0)" class="link"><div class="icon"></div></a></div>');n.addRowButton.find(".link").append(b.addRowButton).click(b.addRowButtonClick);n.selectBoxInner.after(n.addRowButton)}n.set("selectBoxHeight",b.selectBoxHeight);if(b.isShowCheckBox&&a.fn.ligerCheckBox){a("table input:checkbox",n.selectBox).ligerCheckBox()}a(".l-table-checkbox input:checkbox",n.selectBox).change(function(){if(this.checked&&n.hasBind("beforeSelect")){var g=null;if(a(this).parent().get(0).tagName.toLowerCase()=="div"){g=a(this).parent().parent()}else{g=a(this).parent()}if(g!=null&&n.trigger("beforeSelect",[g.attr("value"),g.attr("text")])==false){n.selectBox.slideToggle("fast");return false}}if(!b.isMultiSelect){if(this.checked){a("input:checked",n.selectBox).not(this).each(function(){this.checked=false;a(".l-checkbox-checked",a(this).parent()).removeClass("l-checkbox-checked")});n.selectBox.slideToggle("fast")}}n._checkboxUpdateValue()});a("table.l-table-nocheckbox td",n.selectBox).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});n._addClickEven();if(!b.autocomplete){n.updateStyle()}},setTree:function(b){var c=this,d=this.options;this.clearContent();c.selectBox.table.remove();if(b.checkbox!=false){b.onCheck=function(){var e=c.treeManager.getChecked();var f=[];var g=[];a(e).each(function(h,j){if(d.treeLeafOnly&&j.data.children){return}f.push(j.data[d.valueField]);g.push(j.data[d.textField])});c._changeValue(f.join(d.split),g.join(d.split))}}else{b.onSelect=function(e){if(c.trigger("BeforeSelect"[e])==false){return}if(d.treeLeafOnly&&e.data.children){return}var f=e.data[d.valueField];var g=e.data[d.textField];c._changeValue(f,g)};b.onCancelSelect=function(e){c._changeValue("","")}}b.onAfterAppend=function(g,e){if(!c.treeManager){return}var f=null;if(d.initValue){f=d.initValue}else{if(c.valueField.val()!=""){f=c.valueField.val()}}c.selectValueByTree(f)};c.tree=a("<ul></ul>");a("div:first",c.selectBox).append(c.tree);c.tree.ligerTree(b);c.treeManager=c.tree.ligerGetTreeManager()},selectValueByTree:function(d){var c=this,e=this.options;if(d!=null){var f="";var b=d.toString().split(e.split);a(b).each(function(g,h){c.treeManager.selectNode(h.toString());f+=c.treeManager.getTextByID(h);if(g<b.length-1){f+=e.split}});c._changeValue(d,f)}},setGrid:function(b){var n=this,d=this.options;if(n.grid){return}d.hideOnLoseFocus=d.hideGridOnLoseFocus?true:false;this.clearContent();n.selectBox.addClass("l-box-select-lookup");n.selectBox.table.remove();var c=a("div:first",n.selectBox);var s=a("<div></div>").appendTo(c);var o=a("<div></div>").appendTo(c);n.conditionPanel=s;if(d.condition){var j=a.extend({labelWidth:60,space:20,width:d.selectBoxWidth},d.condition);n.condition=s.ligerForm(j)}else{s.remove()}b=a.extend({columnWidth:120,alternatingRow:false,frozen:true,rownumbers:true,allowUnSelectRow:true},b,{width:"100%",height:n.getGridHeight(),inWindow:false,parms:d.parms,isChecked:function(t){var g=n.getValue();if(!g){return false}if(!d.valueField||!t[d.valueField]){return false}return a.inArray(t[d.valueField].toString(),g.split(d.split))!=-1}});n.grid=n.gridManager=o.ligerGrid(b);n.grid.bind("afterShowData",function(){n.updateSelectBoxPosition()});var q=[],h=function(){var g=[],t=[];a(q).each(function(u,v){g.push(v[d.valueField]);t.push(v[d.textField])});if(b.checkbox){n.selected=q}else{if(q.length){n.selected=q[0]}else{n.selected=null}}n._changeValue(g.join(d.split),t.join(d.split));n.trigger("gridSelect",{value:g.join(d.split),text:t.join(d.split),data:q})},r=function(t){for(var g=q.length-1;g>=0;g--){if(q[g][d.valueField]==t[d.valueField]){q.splice(g,1)}}},f=function(t){for(var g=q.length-1;g>=0;g--){if(q[g][d.valueField]==t[d.valueField]){return}}q.push(t)};if(b.checkbox){var e=function(g,t){g&&f(t);!g&&r(t)};n.grid.bind("CheckAllRow",function(g){a(n.grid.rows).each(function(t){e(g,t)});h()});n.grid.bind("CheckRow",function(g,t){e(g,t);h()})}else{n.grid.bind("SelectRow",function(g){q=[g];h();n._toggleSelectBox(true)});n.grid.bind("UnSelectRow",function(){q=[];h()})}n.bind("show",function(){n.grid.refreshSize()});n.bind("clear",function(){q=[];n.grid.selecteds=[];n.grid._showData()});if(d.condition){var m=a('<li style="margin-right:9px"><div></div></li>');var k=a('<li style="margin-right:9px;float:right"><div></div></li>');a("ul:first",s).append(m).append(k).after('<div class="l-clear"></div>');a("div",m).ligerButton({text:d.Search,width:40,click:function(){var g=n.condition.toConditions();n.grid.setParm(b.conditionParmName||"condition",a.ligerui.toJSON(g));n.grid.reload()}});a("div",k).ligerButton({text:"关闭",width:40,click:function(){n.selectBox.hide()}})}n.grid.refreshSize()},getGridHeight:function(b){var c=this,d=this.options;b=b||c.selectBox.height();b-=c.conditionPanel.height();return b},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},getSelected:function(){return this.selected},getText:function(){return this.inputText.val()},setText:function(b){this.inputText.val(b)},updateStyle:function(){var b=this,c=this.options;c.initValue=b._getValue();b._dataInit()},_dataInit:function(){var b=this,d=this.options;var c=null;if(d.initValue!=null&&d.initText!=null){b._changeValue(d.initValue,d.initText)}if(d.initValue!=null){c=d.initValue;if(d.tree){if(c){b.selectValueByTree(c)}}else{if(b.data){var e=b.findTextByValue(c);b._changeValue(c,e)}}}else{if(b.valueField.val()!=""){c=b.valueField.val();if(d.tree){if(c){b.selectValueByTree(c)}}else{if(b.data){var e=b.findTextByValue(c);b._changeValue(c,e)}}}}if(!d.isShowCheckBox){a("table tr",b.selectBox).find("td:first").each(function(){if(c!=null&&c==a(this).attr("value")){a(this).addClass("l-selected")}else{a(this).removeClass("l-selected")}})}else{a(":checkbox",b.selectBox).each(function(){var h=null;var g=a(this);if(g.parent().get(0).tagName.toLowerCase()=="div"){h=g.parent().parent()}else{h=g.parent()}if(h==null){return}a(".l-checkbox",h).removeClass("l-checkbox-checked");g[0].checked=false;var f=(c||"").toString().split(d.split);a(f).each(function(j,k){if(c!=null&&k==h.attr("value")){a(".l-checkbox",h).addClass("l-checkbox-checked");g[0].checked=true}})})}},_changeValue:function(e,c){var b=this,d=this.options;b.valueField.val(e);if(d&&d.render){b.inputText.val(d.render(e,c))}else{b.inputText.val(c)}b.selectedValue=e;b.selectedText=c;b.inputText.trigger("change").focus();b.trigger("selected",[e,c])},_checkboxUpdateValue:function(){var d=this,e=this.options;var b="";var c="";a("input:checked",d.selectBox).each(function(){var f=null;if(a(this).parent().get(0).tagName.toLowerCase()=="div"){f=a(this).parent().parent()}else{f=a(this).parent()}if(!f){return}b+=f.attr("value")+e.split;c+=f.attr("text")+e.split});if(b.length>0){b=b.substr(0,b.length-1)}if(c.length>0){c=c.substr(0,c.length-1)}d._changeValue(b,c)},_addClickEven:function(){var b=this,c=this.options;a(".l-table-nocheckbox td",b.selectBox).click(function(){var e=a(this).attr("value");var d=parseInt(a(this).attr("index"));var f=a(this).attr("text");if(b.hasBind("beforeSelect")&&b.trigger("beforeSelect",[e,f])==false){if(c.slide){b.selectBox.slideToggle("fast")}else{b.selectBox.hide()}return false}if(a(this).hasClass("l-selected")){if(c.slide){b.selectBox.slideToggle("fast")}else{b.selectBox.hide()}return}a(".l-selected",b.selectBox).removeClass("l-selected");a(this).addClass("l-selected");if(b.select){if(b.select[0].selectedIndex!=d){b.select[0].selectedIndex=d;b.select.trigger("change")}}if(c.slide){b.boxToggling=true;b.selectBox.hide("fast",function(){b.boxToggling=false})}else{b.selectBox.hide()}b._changeValue(e,f)})},updateSelectBoxPosition:function(){var c=this,e=this.options;if(e&&e.absolute){var b=a(document).height();if(e.alwayShowInTop||Number(c.wrapper.offset().top+1+c.wrapper.outerHeight()+c.selectBox.height())>b&&b>Number(c.selectBox.height()+1)){c.selectBox.css({left:c.wrapper.offset().left,top:c.wrapper.offset().top-1-c.selectBox.height()})}else{c.selectBox.css({left:c.wrapper.offset().left,top:c.wrapper.offset().top+1+c.wrapper.outerHeight()})}}else{var f=c.wrapper.offset().top-a(window).scrollTop();var d=c.selectBox.height()+textHeight+4;if(f+d>a(window).height()&&f>d){c.selectBox.css("marginTop",-1*(c.selectBox.height()+textHeight+5))}}},_toggleSelectBox:function(c){var d=this,e=this.options;var f=d.wrapper.height();d.boxToggling=true;if(c){if(e.slide){d.selectBox.slideToggle("fast",function(){d.boxToggling=false})}else{d.selectBox.hide();d.boxToggling=false}}else{d.updateSelectBoxPosition();if(e.slide){d.selectBox.slideToggle("fast",function(){d.boxToggling=false;if(!e.isShowCheckBox&&a("td.l-selected",d.selectBox).length>0){var g=(a("td.l-selected",d.selectBox).offset().top-d.selectBox.offset().top);a(".l-box-select-inner",d.selectBox).animate({scrollTop:g})}})}else{d.selectBox.show();d.boxToggling=false;if(!d.tree&&!d.grid&&!e.isShowCheckBox&&a("td.l-selected",d.selectBox).length>0){var b=(a("td.l-selected",d.selectBox).offset().top-d.selectBox.offset().top);a(".l-box-select-inner",d.selectBox).animate({scrollTop:b})}}}d.isShowed=d.selectBox.is(":visible");d.trigger("toggle",[c]);d.trigger(c?"hide":"show")},_highLight:function(d,c){if(!d){return d}var b=d.indexOf(c);if(b==-1){return d}return d.substring(0,b)+"<span class='l-highLight'>"+c+"</span>"+d.substring(c.length+b)},_setAutocomplete:function(c){var b=this,d=this.options;if(!c){return}b.inputText.removeAttr("readonly");var e=b.inputText.val();b.inputText.keyup(function(){setTimeout(function(){if(e==b.inputText.val()){return}d.initValue="";b.valueField.val("");if(d.url){b.setParm("key",b.inputText.val());b.set("url",d.url);b.selectBox.show()}else{if(d.grid){b.grid.setParm("key",b.inputText.val());b.grid.reload()}}e=b.inputText.val()},1)})}});a.ligerui.controls.ComboBox.prototype.setValue=a.ligerui.controls.ComboBox.prototype.selectValue;a.ligerui.controls.ComboBox.prototype.setInputValue=a.ligerui.controls.ComboBox.prototype._changeValue})(jQuery);(function($){$.fn.ligerDateEditor=function(){return $.ligerui.run.call(this,"ligerDateEditor",arguments)};$.fn.ligerGetDateEditorManager=function(){return $.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)};$.ligerDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",showTime:false,onChangeDate:false,absolute:true,cancelable:true,readonly:false};$.ligerDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",closeMessage:"关闭"};$.ligerMethos.DateEditor={};$.ligerui.controls.DateEditor=function(element,options){$.ligerui.controls.DateEditor.base.constructor.call(this,element,options)};$.ligerui.controls.DateEditor.ligerExtend($.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return $.ligerMethos.DateEditor},_render:function(){var g=this,p=this.options;if(!p.showTime&&p.format.indexOf(" hh:mm")>-1){p.format=p.format.replace(" hh:mm","")}if(this.element.tagName.toLowerCase()!="input"||this.element.type!="text"){return}g.inputText=$(this.element);if(!g.inputText.hasClass("l-text-field")){g.inputText.addClass("l-text-field")}g.link=$('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');g.text=g.inputText.wrap('<div class="l-text l-text-date"></div>').parent();g.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>');g.text.append(g.link);g.textwrapper=g.text.wrap('<div class="l-text-wrapper"></div>').parent();var dateeditorHTML="";dateeditorHTML+="<div class='l-box-dateeditor' style='display:none'>";dateeditorHTML+="    <div class='l-box-dateeditor-header'>";dateeditorHTML+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>";dateeditorHTML+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>";dateeditorHTML+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>";dateeditorHTML+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>";dateeditorHTML+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>";dateeditorHTML+="    </div>";dateeditorHTML+="    <div class='l-box-dateeditor-body'>";dateeditorHTML+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>";dateeditorHTML+="            <thead>";dateeditorHTML+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";dateeditorHTML+="            </thead>";dateeditorHTML+="            <tbody>";dateeditorHTML+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>";dateeditorHTML+="            </tbody>";dateeditorHTML+="        </table>";dateeditorHTML+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";dateeditorHTML+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";dateeditorHTML+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";dateeditorHTML+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>";dateeditorHTML+="    </div>";dateeditorHTML+="    <div class='l-box-dateeditor-toolbar'>";dateeditorHTML+="        <div class='l-box-dateeditor-time'></div>";dateeditorHTML+="        <div class='l-button l-button-today'></div>";dateeditorHTML+="        <div class='l-button l-button-close'></div>";dateeditorHTML+="        <div class='l-clear'></div>";dateeditorHTML+="    </div>";dateeditorHTML+="</div>";g.dateeditor=$(dateeditorHTML);if(p.absolute){g.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute")}else{g.textwrapper.append(g.dateeditor)}g.header=$(".l-box-dateeditor-header",g.dateeditor);g.body=$(".l-box-dateeditor-body",g.dateeditor);g.toolbar=$(".l-box-dateeditor-toolbar",g.dateeditor);g.body.thead=$("thead",g.body);g.body.tbody=$("tbody",g.body);g.body.monthselector=$(".l-box-dateeditor-monthselector",g.body);g.body.yearselector=$(".l-box-dateeditor-yearselector",g.body);g.body.hourselector=$(".l-box-dateeditor-hourselector",g.body);g.body.minuteselector=$(".l-box-dateeditor-minuteselector",g.body);g.toolbar.time=$(".l-box-dateeditor-time",g.toolbar);g.toolbar.time.hour=$("<a></a>");g.toolbar.time.minute=$("<a></a>");g.buttons={btnPrevYear:$(".l-box-dateeditor-header-prevyear",g.header),btnNextYear:$(".l-box-dateeditor-header-nextyear",g.header),btnPrevMonth:$(".l-box-dateeditor-header-prevmonth",g.header),btnNextMonth:$(".l-box-dateeditor-header-nextmonth",g.header),btnYear:$(".l-box-dateeditor-header-year",g.header),btnMonth:$(".l-box-dateeditor-header-month",g.header),btnToday:$(".l-button-today",g.toolbar),btnClose:$(".l-button-close",g.toolbar)};var nowDate=new Date();g.now={year:nowDate.getFullYear(),month:nowDate.getMonth()+1,day:nowDate.getDay(),date:nowDate.getDate(),hour:nowDate.getHours(),minute:nowDate.getMinutes()};g.currentDate={year:nowDate.getFullYear(),month:nowDate.getMonth()+1,day:nowDate.getDay(),date:nowDate.getDate(),hour:nowDate.getHours(),minute:nowDate.getMinutes()};g.selectedDate=null;g.usedDate=null;$("td",g.body.thead).each(function(i,td){$(td).html(p.dayMessage[i])});$("li",g.body.monthselector).each(function(i,li){$(li).html(p.monthMessage[i])});g.buttons.btnToday.html(p.todayMessage);g.buttons.btnClose.html(p.closeMessage);if(p.showTime){g.toolbar.time.show();g.toolbar.time.append(g.toolbar.time.hour).append(":").append(g.toolbar.time.minute);$("li",g.body.hourselector).each(function(i,item){var str=i;if(i<10){str="0"+i.toString()}$(this).html(str)});$("li",g.body.minuteselector).each(function(i,item){var str=i;if(i<10){str="0"+i.toString()}$(this).html(str)})}g.bulidContent();if(p.initValue){g.inputText.val(p.initValue)}if(g.inputText.val()!=""){g.onTextChange()}g.dateeditor.hover(null,function(e){if(g.dateeditor.is(":visible")&&!g.editorToggling){g.toggleDateEditor(true)}});g.link.hover(function(){if(p.disabled){return}this.className="l-trigger-hover"},function(){if(p.disabled){return}this.className="l-trigger"}).mousedown(function(){if(p.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(p.disabled){return}this.className="l-trigger-hover"}).click(function(){if(p.disabled){return}g.bulidContent();g.toggleDateEditor(g.dateeditor.is(":visible"))});if(p.disabled){g.inputText.attr("readonly","readonly");g.text.addClass("l-text-disabled")}g.buttons.btnClose.click(function(){g.toggleDateEditor(true)});$("td",g.body.tbody).hover(function(){if($(this).hasClass("l-box-dateeditor-today")){return}$(this).addClass("l-box-dateeditor-over")},function(){$(this).removeClass("l-box-dateeditor-over")}).click(function(){$(".l-box-dateeditor-selected",g.body.tbody).removeClass("l-box-dateeditor-selected");if(!$(this).hasClass("l-box-dateeditor-today")){$(this).addClass("l-box-dateeditor-selected")}g.currentDate.date=parseInt($(this).html());g.currentDate.day=new Date(g.currentDate.year,g.currentDate.month-1,1).getDay();if($(this).hasClass("l-box-dateeditor-out")){if($("tr",g.body.tbody).index($(this).parent())==0){if(--g.currentDate.month==0){g.currentDate.month=12;g.currentDate.year--}}else{if(++g.currentDate.month==13){g.currentDate.month=1;g.currentDate.year++}}}g.selectedDate={year:g.currentDate.year,month:g.currentDate.month,date:g.currentDate.date};g.showDate();g.editorToggling=true;g.dateeditor.slideToggle("fast",function(){g.editorToggling=false})});$(".l-box-dateeditor-header-btn",g.header).hover(function(){$(this).addClass("l-box-dateeditor-header-btn-over")},function(){$(this).removeClass("l-box-dateeditor-header-btn-over")});g.buttons.btnYear.click(function(){if(!g.body.yearselector.is(":visible")){$("li",g.body.yearselector).each(function(i,item){var currentYear=g.currentDate.year+(i-4);if(currentYear==g.currentDate.year){$(this).addClass("l-selected")}else{$(this).removeClass("l-selected")}$(this).html(currentYear)})}g.body.yearselector.slideToggle()});g.body.yearselector.hover(function(){},function(){$(this).slideUp()});$("li",g.body.yearselector).click(function(){g.currentDate.year=parseInt($(this).html());g.body.yearselector.slideToggle();g.bulidContent()});g.buttons.btnMonth.click(function(){$("li",g.body.monthselector).each(function(i,item){if(g.currentDate.month==i+1){$(this).addClass("l-selected")}else{$(this).removeClass("l-selected")}});g.body.monthselector.slideToggle()});g.body.monthselector.hover(function(){},function(){$(this).slideUp("fast")});$("li",g.body.monthselector).click(function(){var index=$("li",g.body.monthselector).index(this);g.currentDate.month=index+1;g.body.monthselector.slideToggle();g.bulidContent()});g.toolbar.time.hour.click(function(){$("li",g.body.hourselector).each(function(i,item){if(g.currentDate.hour==i){$(this).addClass("l-selected")}else{$(this).removeClass("l-selected")}});g.body.hourselector.slideToggle()});g.body.hourselector.hover(function(){},function(){$(this).slideUp("fast")});$("li",g.body.hourselector).click(function(){var index=$("li",g.body.hourselector).index(this);g.currentDate.hour=index;g.body.hourselector.slideToggle();g.bulidContent();g.showDate()});g.toolbar.time.minute.click(function(){$("li",g.body.minuteselector).each(function(i,item){if(g.currentDate.minute==i){$(this).addClass("l-selected")}else{$(this).removeClass("l-selected")}});g.body.minuteselector.slideToggle("fast",function(){var index=$("li",this).index($("li.l-selected",this));if(index>29){var offSet=($("li.l-selected",this).offset().top-$(this).offset().top);$(this).animate({scrollTop:offSet})}})});g.body.minuteselector.hover(function(){},function(){$(this).slideUp("fast")});$("li",g.body.minuteselector).click(function(){var index=$("li",g.body.minuteselector).index(this);g.currentDate.minute=index;g.body.minuteselector.slideToggle("fast");g.bulidContent();g.showDate()});g.buttons.btnPrevMonth.click(function(){if(--g.currentDate.month==0){g.currentDate.month=12;g.currentDate.year--}g.bulidContent()});g.buttons.btnNextMonth.click(function(){if(++g.currentDate.month==13){g.currentDate.month=1;g.currentDate.year++}g.bulidContent()});g.buttons.btnPrevYear.click(function(){g.currentDate.year--;g.bulidContent()});g.buttons.btnNextYear.click(function(){g.currentDate.year++;g.bulidContent()});g.buttons.btnToday.click(function(){g.currentDate={year:g.now.year,month:g.now.month,day:g.now.day,date:g.now.date};g.selectedDate={year:g.now.year,month:g.now.month,day:g.now.day,date:g.now.date};g.showDate();g.dateeditor.slideToggle("fast")});g.inputText.change(function(){g.onTextChange()}).blur(function(){g.text.removeClass("l-text-focus")}).focus(function(){g.text.addClass("l-text-focus")});g.text.hover(function(){g.text.addClass("l-text-over")},function(){g.text.removeClass("l-text-over")});if(p.label){g.labelwrapper=g.textwrapper.wrap('<div class="l-labeltext"></div>').parent();g.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+p.label+":&nbsp</div>");g.textwrapper.css("float","left");if(!p.labelWidth){p.labelWidth=$(".l-text-label",g.labelwrapper).outerWidth()}else{$(".l-text-label",g.labelwrapper).outerWidth(p.labelWidth)}$(".l-text-label",g.labelwrapper).width(p.labelWidth);$(".l-text-label",g.labelwrapper).height(g.text.height());g.labelwrapper.append('<br style="clear:both;" />');if(p.labelAlign){$(".l-text-label",g.labelwrapper).css("text-align",p.labelAlign)}g.textwrapper.css({display:"inline"});g.labelwrapper.width(g.text.outerWidth()+p.labelWidth+2)}g.set(p)},destroy:function(){if(this.textwrapper){this.textwrapper.remove()}if(this.dateeditor){this.dateeditor.remove()}this.options=null;$.ligerui.remove(this)},bulidContent:function(){var g=this,p=this.options;var thismonthFirstDay=new Date(g.currentDate.year,g.currentDate.month-1,1).getDay();var nextMonth=g.currentDate.month;var nextYear=g.currentDate.year;if(++nextMonth==13){nextMonth=1;nextYear++}var monthDayNum=new Date(nextYear,nextMonth-1,0).getDate();var prevMonthDayNum=new Date(g.currentDate.year,g.currentDate.month-1,0).getDate();g.buttons.btnMonth.html(p.monthMessage[g.currentDate.month-1]);g.buttons.btnYear.html(g.currentDate.year);g.toolbar.time.hour.html(g.currentDate.hour);g.toolbar.time.minute.html(g.currentDate.minute);if(g.toolbar.time.hour.html().length==1){g.toolbar.time.hour.html("0"+g.toolbar.time.hour.html())}if(g.toolbar.time.minute.html().length==1){g.toolbar.time.minute.html("0"+g.toolbar.time.minute.html())}$("td",this.body.tbody).each(function(){this.className=""});$("tr",this.body.tbody).each(function(i,tr){$("td",tr).each(function(j,td){var id=i*7+(j-thismonthFirstDay);var showDay=id+1;if(g.selectedDate&&g.currentDate.year==g.selectedDate.year&&g.currentDate.month==g.selectedDate.month&&id+1==g.selectedDate.date){if(j==0||j==6){$(td).addClass("l-box-dateeditor-holiday")}$(td).addClass("l-box-dateeditor-selected");$(td).siblings().removeClass("l-box-dateeditor-selected")}else{if(g.currentDate.year==g.now.year&&g.currentDate.month==g.now.month&&id+1==g.now.date){if(j==0||j==6){$(td).addClass("l-box-dateeditor-holiday")}$(td).addClass("l-box-dateeditor-today")}else{if(id<0){showDay=prevMonthDayNum+showDay;$(td).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else{if(id>monthDayNum-1){showDay=showDay-monthDayNum;$(td).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")}else{if(j==0||j==6){$(td).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected")}else{td.className=""}}}}}$(td).html(showDay)})})},updateSelectBoxPosition:function(){var g=this,p=this.options;if(p.absolute){var contentHeight=$(document).height();if(Number(g.text.offset().top+1+g.text.outerHeight()+g.dateeditor.height())>contentHeight&&contentHeight>Number(g.dateeditor.height()+1)){g.dateeditor.css({left:g.text.offset().left,top:g.text.offset().top-1-g.dateeditor.height()})}else{g.dateeditor.css({left:g.text.offset().left,top:g.text.offset().top+1+g.text.outerHeight()})}}else{if(g.text.offset().top+4>g.dateeditor.height()&&g.text.offset().top+g.dateeditor.height()+textHeight+4-$(window).scrollTop()>$(window).height()){g.dateeditor.css("marginTop",-1*(g.dateeditor.height()+textHeight+5));g.showOnTop=true}else{g.showOnTop=false}}},toggleDateEditor:function(isHide){var g=this,p=this.options;var textHeight=g.text.height();g.editorToggling=true;if(isHide){g.dateeditor.hide("fast",function(){g.editorToggling=false})}else{g.updateSelectBoxPosition();g.dateeditor.slideDown("fast",function(){g.editorToggling=false})}},showDate:function(){var g=this,p=this.options;if(!this.currentDate){return}this.currentDate.hour=parseInt(g.toolbar.time.hour.html(),10);this.currentDate.minute=parseInt(g.toolbar.time.minute.html(),10);var dateStr=this.currentDate.year+"/"+this.currentDate.month+"/"+this.currentDate.date+" "+this.currentDate.hour+":"+this.currentDate.minute;var myDate=new Date(dateStr);dateStr=g.getFormatDate(myDate);this.inputText.val(dateStr);this.onTextChange()},isDateTime:function(dateStr){var g=this,p=this.options;var r=dateStr.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(r==null){return false}var d=new Date(r[1],r[3]-1,r[4]);if(d=="NaN"){return false}return(d.getFullYear()==r[1]&&(d.getMonth()+1)==r[3]&&d.getDate()==r[4])},isLongDateTime:function(dateStr){var g=this,p=this.options;var reg=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/;var r=dateStr.match(reg);if(r==null){return false}var d=new Date(r[1],r[3]-1,r[4],r[5],r[6]);if(d=="NaN"){return false}return(d.getFullYear()==r[1]&&(d.getMonth()+1)==r[3]&&d.getDate()==r[4]&&d.getHours()==r[5]&&d.getMinutes()==r[6])},getFormatDate:function(date){var g=this,p=this.options;if(date=="NaN"){return null}var format=p.format;var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format},clear:function(){this.set("value","");this.usedDate=null},_setCancelable:function(value){var g=this,p=this.options;if(!value&&g.unselect){g.unselect.remove();g.unselect=null}if(!value&&!g.unselect){return}g.unselect=$('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();g.text.hover(function(){g.unselect.show()},function(){g.unselect.hide()});if(!p.disabled&&p.cancelable){g.text.append(g.unselect)}g.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){if(p.readonly){return}g.clear()})},_rever:function(){var g=this,p=this.options;if(!g.usedDate){g.inputText.val("")}else{g.inputText.val(g.getFormatDate(g.usedDate))}},_getMatch:function(format){var r=[-1,-1,-1,-1,-1,-1],groupIndex=0,regStr="^",str=format||this.options.format;while(true){var tmp_r=str.match(/^yyyy|MM|dd|mm|hh|HH|ss|-|\/|:|\s/);if(tmp_r){var c=tmp_r[0].charAt(0);var mathLength=tmp_r[0].length;var index="yMdhms".indexOf(c);if(index!=-1){r[index]=groupIndex+1;regStr+="(\\d{1,"+mathLength+"})"}else{var st=c==" "?"\\s":c;regStr+="("+st+")"}groupIndex++;if(mathLength==str.length){regStr+="$";break}str=str.substring(mathLength)}else{return null}}return{reg:new RegExp(regStr),position:r}},_bulidDate:function(dateStr){var g=this,p=this.options;var r=this._getMatch();if(!r){return null}var t=dateStr.match(r.reg);if(!t){return null}var tt={y:r.position[0]==-1?1900:t[r.position[0]],M:r.position[1]==-1?0:parseInt(t[r.position[1]],10)-1,d:r.position[2]==-1?1:parseInt(t[r.position[2]],10),h:r.position[3]==-1?0:parseInt(t[r.position[3]],10),m:r.position[4]==-1?0:parseInt(t[r.position[4]],10),s:r.position[5]==-1?0:parseInt(t[r.position[5]],10)};if(tt.M<0||tt.M>11||tt.d<0||tt.d>31){return null}var d=new Date(tt.y,tt.M,tt.d);if(p.showTime){if(tt.m<0||tt.m>59||tt.h<0||tt.h>23||tt.s<0||tt.s>59){return null}d.setHours(tt.h);d.setMinutes(tt.m);d.setSeconds(tt.s)}return d},updateStyle:function(){this.onTextChange()},onTextChange:function(){var g=this,p=this.options;var val=g.inputText.val();if(!val){g.selectedDate=null;return true}var newDate=g._bulidDate(val);if(!newDate){g._rever();return}else{g.usedDate=newDate}g.selectedDate={year:g.usedDate.getFullYear(),month:g.usedDate.getMonth()+1,day:g.usedDate.getDay(),date:g.usedDate.getDate(),hour:g.usedDate.getHours(),minute:g.usedDate.getMinutes()};g.currentDate={year:g.usedDate.getFullYear(),month:g.usedDate.getMonth()+1,day:g.usedDate.getDay(),date:g.usedDate.getDate(),hour:g.usedDate.getHours(),minute:g.usedDate.getMinutes()};var formatVal=g.getFormatDate(newDate);g.inputText.val(formatVal);g.trigger("changeDate",[formatVal]);if($(g.dateeditor).is(":visible")){g.bulidContent()}},_setHeight:function(value){var g=this;if(value>4){g.text.css({height:value});g.inputText.css({height:value});g.textwrapper.css({height:value})}},_setWidth:function(value){var g=this;if(value>20){g.text.css({width:value});g.inputText.css({width:value-20});g.textwrapper.css({width:value})}},_setValue:function(value){var g=this;if(!value){g.inputText.val("")}if(typeof value=="string"){if(/^\/Date/.test(value)){value=value.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+value)}else{g.inputText.val(value)}}if(typeof value=="object"){if(value instanceof Date){g.inputText.val(g.getFormatDate(value));g.onTextChange()}}},_getValue:function(){return this.usedDate},setEnabled:function(){var g=this,p=this.options;this.inputText.removeAttr("readonly");this.text.removeClass("l-text-disabled");p.disabled=false},setDisabled:function(){var g=this,p=this.options;this.inputText.attr("readonly","readonly");this.text.addClass("l-text-disabled");p.disabled=true}})})(jQuery);(function(b){var a=b.ligerui;b(".l-dialog-btn").live("mouseover",function(){b(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){b(this).removeClass("l-dialog-btn-over")});b(".l-dialog-tc .l-dialog-close").live("mouseover",function(){b(this).addClass("l-dialog-close-over")}).live("mouseout",function(){b(this).removeClass("l-dialog-close-over")});b.ligerDialog=function(){return a.run.call(null,"ligerDialog",arguments,{isStatic:true})};b.ligerui.DialogImagePath="../../lib/ligerUI/skins/Aqua/images/win/";function c(e){for(var d in e){b("<img />").attr("src",a.DialogImagePath+e[d])}}b.ligerDefaults.Dialog={cls:null,id:null,buttons:null,isDrag:true,width:280,height:null,content:"",target:null,url:null,load:false,type:"none",left:null,top:null,modal:true,data:null,name:null,isResize:false,allowClose:true,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:true,show:true,title:"提示",showMax:false,showToggle:false,showMin:false,slide:b.browser.msie?false:true,fixedType:null,showType:null,onLoaded:null,onExtend:null,onExtended:null,onCollapse:null,onCollapseed:null,onContentHeightChange:null,onClose:null,onClosed:null,onStopResize:null};b.ligerDefaults.DialogString={titleMessage:"提示",ok:"确定",yes:"是",no:"否",cancel:"取消",waittingMessage:"正在等待中,请稍候..."};b.ligerMethos.Dialog=b.ligerMethos.Dialog||{};a.controls.Dialog=function(d){a.controls.Dialog.base.constructor.call(this,null,d)};a.controls.Dialog.ligerExtend(a.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return b.ligerMethos.Dialog},_render:function(){var h=this,m=this.options;var n="";h.set(m,true);var e=b('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>');b("body").append(e);h.dialog=e;h.element=e[0];h.dialog.body=b(".l-dialog-body:first",h.dialog);h.dialog.header=b(".l-dialog-tc-inner:first",h.dialog);h.dialog.winbtns=b(".l-dialog-winbtns:first",h.dialog.header);h.dialog.buttons=b(".l-dialog-buttons:first",h.dialog);h.dialog.content=b(".l-dialog-content:first",h.dialog);h.set(m,false);if(m.allowClose==false){b(".l-dialog-close",h.dialog).remove()}if(m.target||m.url||m.type=="none"){m.type=null;h.dialog.addClass("l-dialog-win")}if(m.cls){h.dialog.addClass(m.cls)}if(m.id){h.dialog.attr("id",m.id)}h.mask();if(m.isDrag){h._applyDrag()}if(m.isResize){h._applyResize()}if(m.type){h._setImage()}else{b(".l-dialog-image",h.dialog).remove();h.dialog.content.addClass("l-dialog-content-noimage")}if(!m.show){h.unmask();h.dialog.hide()}if(m.target){h.dialog.content.prepend(m.target);b(m.target).show()}else{if(m.url){if(m.timeParmName){m.url+=m.url.indexOf("?")==-1?"?":"&";m.url+=m.timeParmName+"="+new Date().getTime()}if(m.load){h.dialog.body.load(m.url,function(){h._saveStatus();h.trigger("loaded")})}else{h.jiframe=b("<iframe frameborder='0'></iframe>");var d=m.name?m.name:"ligerwindow"+new Date().getTime();h.jiframe.attr("name",d);h.jiframe.attr("id",d);h.dialog.content.prepend(h.jiframe);h.dialog.content.addClass("l-dialog-content-nopadding l-dialog-content-frame");setTimeout(function(){if(h.dialog.body.find(".l-dialog-loading:first").length==0){h.dialog.body.append("<div class='l-dialog-loading' style='display:block;'></div>")}var g=b(".l-dialog-loading:first",h.dialog.body);h.jiframe[0].dialog=h;h.jiframe.attr("src",m.url).bind("load.dialog",function(){g.hide();h.trigger("loaded")});h.frame=window.frames[h.jiframe.attr("name")]},0);n="jquery_ligerui_"+new Date().getTime();h.tmpInput=b("<input></input>");h.tmpInput.attr("id",n);h.dialog.content.prepend(h.tmpInput)}}}if(m.opener){h.dialog.opener=m.opener}if(m.buttons){b(m.buttons).each(function(o,q){var g=b('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');b(".l-dialog-btn-inner",g).html(q.text);b(".l-dialog-buttons-inner",h.dialog.buttons).prepend(g);q.width&&g.width(q.width);q.onclick&&g.click(function(){q.onclick(q,h,o)});q.cls&&g.addClass(q.cls)})}else{h.dialog.buttons.remove()}b(".l-dialog-buttons-inner",h.dialog.buttons).append("<div class='l-clear'></div>");b(".l-dialog-title",h.dialog).bind("selectstart",function(){return false});h.dialog.click(function(){a.win.setFront(h)});b(".l-dialog-tc .l-dialog-close",h.dialog).click(function(){if(m.isHidden){h.hide()}else{h.close()}});if(!m.fixedType){var k=0;var j=0;var f=m.width||h.dialog.width();if(m.slide==true){m.slide="fast"}if(m.left!=null){k=m.left}else{m.left=k=0.5*(b(window).width()-f)}if(m.top!=null){j=m.top}else{m.top=j=0.5*(b(window).height()-h.dialog.height())+b(window).scrollTop()-10}if(k<0){m.left=k=0}if(j<0){m.top=j=0}h.dialog.css({left:k,top:j})}h.show();b("body").bind("keydown.dialog",function(o){var g=o.which;if(g==13){h.enter()}else{if(g==27){h.esc()}}});h._updateBtnsWidth();h._saveStatus();h._onReisze();if(n!=""){b("#"+n).focus();b("#"+n).remove()}},_borderX:12,_borderY:32,doMax:function(e){var h=this,m=this.options;var f=b(window).width(),d=b(window).height(),k=0,j=0;if(a.win.taskbar){d-=a.win.taskbar.outerHeight();if(a.win.top){j+=a.win.taskbar.outerHeight()}}if(e){h.dialog.body.animate({width:f-h._borderX},m.slide);h.dialog.animate({left:k,top:j},m.slide);h.dialog.content.animate({height:d-h._borderY-h.dialog.buttons.outerHeight()},m.slide,function(){h._onReisze()})}else{h.set({width:f,height:d,left:k,top:j});h._onReisze()}},max:function(){var d=this,e=this.options;if(d.winmax){d.winmax.addClass("l-dialog-recover");d.doMax(e.slide);if(d.wintoggle){if(d.wintoggle.hasClass("l-dialog-extend")){d.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled")}else{d.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")}}if(d.resizable){d.resizable.set({disabled:true})}if(d.draggable){d.draggable.set({disabled:true})}d.maximum=true;b(window).bind("resize.dialogmax",function(){d.doMax(false)})}},recover:function(){var d=this,e=this.options;if(d.winmax){d.winmax.removeClass("l-dialog-recover");if(e.slide){d.dialog.body.animate({width:d._width-d._borderX},e.slide);d.dialog.animate({left:d._left,top:d._top},e.slide);d.dialog.content.animate({height:d._height-d._borderY-d.dialog.buttons.outerHeight()},e.slide,function(){d._onReisze()})}else{d.set({width:d._width,height:d._height,left:d._left,top:d._top});d._onReisze()}if(d.wintoggle){d.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled")}b(window).unbind("resize.dialogmax")}if(this.resizable){this.resizable.set({disabled:false})}if(d.draggable){d.draggable.set({disabled:false})}d.maximum=false},min:function(){var e=this,f=this.options;var d=a.win.getTask(this);if(f.slide){e.dialog.body.animate({width:1},f.slide);d.y=d.offset().top+d.height();d.x=d.offset().left+d.width()/2;e.dialog.animate({left:d.x,top:d.y},f.slide,function(){e.dialog.hide()})}else{e.dialog.hide()}e.unmask();e.minimize=true;e.actived=false},active:function(){var f=this,k=this.options;if(f.minimize){var e=f._width,d=f._height,j=f._left,h=f._top;if(f.maximum){e=b(window).width();d=b(window).height();j=h=0;if(a.win.taskbar){d-=a.win.taskbar.outerHeight();if(a.win.top){h+=a.win.taskbar.outerHeight()}}}if(k.slide){f.dialog.body.animate({width:e-f._borderX},k.slide);f.dialog.animate({left:j,top:h},k.slide)}else{f.set({width:e,height:d,left:j,top:h})}}f.actived=true;f.minimize=false;a.win.setFront(f);f.show()},toggle:function(){var d=this,e=this.options;if(!d.wintoggle){return}if(d.wintoggle.hasClass("l-dialog-extend")){d.extend()}else{d.collapse()}},collapse:function(){var d=this,e=this.options;if(!d.wintoggle){return}if(e.slide){d.dialog.content.animate({height:1},e.slide)}else{d.dialog.content.height(1)}if(this.resizable){this.resizable.set({disabled:true})}},extend:function(){var e=this,f=this.options;if(!e.wintoggle){return}var d=e._height-e._borderY-e.dialog.buttons.outerHeight();if(f.slide){e.dialog.content.animate({height:d},f.slide)}else{e.dialog.content.height(d)}if(this.resizable){this.resizable.set({disabled:false})}},_updateBtnsWidth:function(){var e=this;var d=b(">div",e.dialog.winbtns).length;e.dialog.winbtns.width(22*d)},_setLeft:function(d){if(!this.dialog){return}if(d!=null){this.dialog.css({left:d})}},_setTop:function(d){if(!this.dialog){return}if(d!=null){this.dialog.css({top:d})}},_setWidth:function(d){if(!this.dialog){return}if(d>=this._borderX){this.dialog.body.width(d-this._borderX)}},_setHeight:function(f){var e=this,h=this.options;if(!this.dialog){return}if(f=="auto"){e.dialog.content.height("auto")}else{if(f>=this._borderY){var d=f-this._borderY-e.dialog.buttons.outerHeight();if(e.trigger("ContentHeightChange",[d])==false){return}e.dialog.content.height(d);e.trigger("ContentHeightChanged",[d])}}},_setShowMax:function(e){var d=this,f=this.options;if(e){if(!d.winmax){d.winmax=b('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(d.dialog.winbtns).hover(function(){if(b(this).hasClass("l-dialog-recover")){b(this).addClass("l-dialog-recover-over")}else{b(this).addClass("l-dialog-max-over")}},function(){b(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){if(b(this).hasClass("l-dialog-recover")){d.recover()}else{d.max()}})}}else{if(d.winmax){d.winmax.remove();d.winmax=null}}d._updateBtnsWidth()},_setShowMin:function(e){var d=this,f=this.options;if(e){if(!d.winmin){d.winmin=b('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(d.dialog.winbtns).hover(function(){b(this).addClass("l-dialog-min-over")},function(){b(this).removeClass("l-dialog-min-over")}).click(function(){d.min()});a.win.addTask(d)}}else{if(d.winmin){d.winmin.remove();d.winmin=null}}d._updateBtnsWidth()},_setShowToggle:function(e){var d=this,f=this.options;if(e){if(!d.wintoggle){d.wintoggle=b('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(d.dialog.winbtns).hover(function(){if(b(this).hasClass("l-dialog-toggle-disabled")){return}if(b(this).hasClass("l-dialog-extend")){b(this).addClass("l-dialog-extend-over")}else{b(this).addClass("l-dialog-collapse-over")}},function(){b(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(b(this).hasClass("l-dialog-toggle-disabled")){return}if(d.wintoggle.hasClass("l-dialog-extend")){if(d.trigger("extend")==false){return}d.wintoggle.removeClass("l-dialog-extend");d.extend();d.trigger("extended")}else{if(d.trigger("collapse")==false){return}d.wintoggle.addClass("l-dialog-extend");d.collapse();d.trigger("collapseed")}})}}else{if(d.wintoggle){d.wintoggle.remove();d.wintoggle=null}}},enter:function(){var e=this,f=this.options;var d;if(f.closeWhenEnter!=undefined){d=f.closeWhenEnter}else{if(f.type=="warn"||f.type=="error"||f.type=="success"||f.type=="question"){d=true}}if(d){e.close()}},esc:function(){},_removeDialog:function(){var e=this,f=this.options;if(f.showType&&f.fixedType){e.dialog.animate({bottom:-1*f.height},function(){d()})}else{d()}function d(){var g=b("iframe",e.dialog);if(g.length){var h=g[0];h.src="about:blank";if(h.contentWindow&&h.contentWindow.document){h.contentWindow.document.write("")}b.browser.msie&&CollectGarbage();g.remove()}e.dialog.remove()}},close:function(){var d=this,e=this.options;if(d.trigger("Close")==false){return}d.doClose();if(d.trigger("Closed")==false){return}},doClose:function(){var d=this;a.win.removeTask(this);b.ligerui.remove(this);d.unmask();d._removeDialog();b("body").unbind("keydown.dialog")},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(d){var e=this,f=this.options;f.url=d;if(f.load){e.dialog.body.html("").load(f.url,function(){e.trigger("loaded")})}else{if(e.jiframe){e.jiframe.attr("src",f.url)}}},_setContent:function(d){this.dialog.content.html(d)},_setTitle:function(e){var d=this;var f=this.options;if(e){b(".l-dialog-title",d.dialog).html(e)}},_hideDialog:function(){var d=this,e=this.options;if(e.showType&&e.fixedType){d.dialog.animate({bottom:-1*e.height},function(){d.dialog.hide()})}else{d.dialog.hide()}},hidden:function(){var d=this;a.win.removeTask(d);d.dialog.hide();d.unmask()},show:function(){var d=this,e=this.options;d.mask();if(e.fixedType){if(e.showType){d.dialog.css({bottom:-1*e.height}).addClass("l-dialog-fixed");d.dialog.show().animate({bottom:0})}else{d.dialog.show().css({bottom:0})}}else{d.dialog.show()}b.ligerui.win.setFront.ligerDefer(b.ligerui.win,100,[d])},setUrl:function(d){this._setUrl(d)},_saveStatus:function(){var d=this;d._width=d.dialog.body.width();d._height=d.dialog.body.height();var f=0;var e=0;if(!isNaN(parseInt(d.dialog.css("top")))){f=parseInt(d.dialog.css("top"))}if(!isNaN(parseInt(d.dialog.css("left")))){e=parseInt(d.dialog.css("left"))}d._top=f;d._left=e},_applyDrag:function(){var d=this,e=this.options;if(b.fn.ligerDrag){d.draggable=d.dialog.ligerDrag({handler:".l-dialog-title",animate:false,onStartDrag:function(){a.win.setFront(d);var f=b("<div class='l-dragging-mask' style='display:block'></div>").height(d.dialog.height());d.dialog.append(f);d.dialog.content.addClass("l-dialog-content-dragging")},onDrag:function(h,g){var f=g.pageY||g.screenY;if(f<0){return false}},onStopDrag:function(){d.dialog.find("div.l-dragging-mask:first").remove();d.dialog.content.removeClass("l-dialog-content-dragging");if(e.target){var g=a.find(b.ligerui.controls.DateEditor);var f=a.find(b.ligerui.controls.ComboBox);b(b.merge(g,f)).each(function(){if(this.updateSelectBoxPosition){this.updateSelectBoxPosition()}})}d._saveStatus()}})}},_onReisze:function(){var h=this,j=this.options;if(j.target){var e=b(j.target).liger();if(!e){e=b(j.target).find(":first").liger()}if(!e){return}var f=h.dialog.content.height();var d=h.dialog.content.width();e.trigger("resize",[{width:d,height:f}])}},_applyResize:function(){var d=this,e=this.options;if(b.fn.ligerResizable){d.resizable=d.dialog.ligerResizable({onStopResize:function(j,h){var g=0;var f=0;if(!isNaN(parseInt(d.dialog.css("top")))){g=parseInt(d.dialog.css("top"))}if(!isNaN(parseInt(d.dialog.css("left")))){f=parseInt(d.dialog.css("left"))}if(j.diffLeft){d.set({left:f+j.diffLeft})}if(j.diffTop){d.set({top:g+j.diffTop})}if(j.newWidth){d.set({width:j.newWidth});d.dialog.body.css({width:j.newWidth-d._borderX})}if(j.newHeight){d.set({height:j.newHeight})}d._onReisze();d._saveStatus();d.trigger("stopResize");return false},animate:false})}},_setImage:function(){var d=this,e=this.options;if(e.type){if(e.type=="success"||e.type=="donne"||e.type=="ok"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-donne").show();d.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(e.type=="error"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-error").show();d.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(e.type=="warn"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-warn").show();d.dialog.content.css({paddingLeft:64,paddingBottom:30})}else{if(e.type=="question"){b(".l-dialog-image",d.dialog).addClass("l-dialog-image-question").show();d.dialog.content.css({paddingLeft:64,paddingBottom:40})}}}}}}});a.controls.Dialog.prototype.hide=a.controls.Dialog.prototype.hidden;b.ligerDialog.open=function(d){return b.ligerDialog(d)};b.ligerDialog.close=function(){var f=a.find(a.controls.Dialog.prototype.__getType());for(var e in f){var g=f[e];g.destroy.ligerDefer(g,5)}a.win.unmask()};b.ligerDialog.show=function(f){var e=a.find(a.controls.Dialog.prototype.__getType());if(e.length){for(var d in e){e[d].show();return}}return b.ligerDialog(f)};b.ligerDialog.hide=function(){var f=a.find(a.controls.Dialog.prototype.__getType());for(var e in f){var g=f[e];g.hide()}};b.ligerDialog.tip=function(d){d=b.extend({showType:"slide",width:240,modal:false,height:100},d||{});b.extend(d,{fixedType:"se",type:"none",isDrag:false,isResize:false,showMax:false,showToggle:false,showMin:false});return b.ligerDialog.open(d)};b.ligerDialog.alert=function(f,g,e,h){f=f||"";if(typeof(g)=="function"){h=g;e=null}else{if(typeof(e)=="function"){h=e}}var d=function(m,j,k){j.close();if(h){h(m,j,k)}};p={content:f,buttons:[{text:b.ligerDefaults.DialogString.ok,onclick:d}]};if(typeof(g)=="string"&&g!=""){p.title=g}if(typeof(e)=="string"&&e!=""){p.type=e}b.extend(p,{showMax:false,showToggle:false,showMin:false});return b.ligerDialog(p)};b.ligerDialog.confirm=function(e,f,g){if(typeof(f)=="function"){g=f;type=null}var d=function(j,h){h.close();if(g){g(j.type=="ok")}};p={type:"question",content:e,buttons:[{text:b.ligerDefaults.DialogString.yes,onclick:d,type:"ok"},{text:b.ligerDefaults.DialogString.no,onclick:d,type:"no"}]};if(typeof(f)=="string"&&f!=""){p.title=f}b.extend(p,{showMax:false,showToggle:false,showMin:false});return b.ligerDialog(p)};b.ligerDialog.warning=function(e,f,g){if(typeof(f)=="function"){g=f;type=null}var d=function(j,h){h.close();if(g){g(j.type)}};p={type:"question",content:e,buttons:[{text:b.ligerDefaults.DialogString.yes,onclick:d,type:"yes"},{text:b.ligerDefaults.DialogString.no,onclick:d,type:"no"},{text:b.ligerDefaults.DialogString.cancel,onclick:d,type:"cancel"}]};if(typeof(f)=="string"&&f!=""){p.title=f}b.extend(p,{showMax:false,showToggle:false,showMin:false});return b.ligerDialog(p)};b.ligerDialog.waitting=function(d){d=d||b.ligerDefaults.Dialog.waittingMessage;return b.ligerDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:4px">'+d+"</div>",allowClose:false})};b.ligerDialog.closeWaitting=function(){var f=a.find(a.controls.Dialog);for(var e in f){var g=f[e];if(g.dialog.hasClass("l-dialog-waittingdialog")){g.close()}}};b.ligerDialog.success=function(e,f,d){return b.ligerDialog.alert(e,f,"success",d)};b.ligerDialog.error=function(e,f,d){return b.ligerDialog.alert(e,f,"error",d)};b.ligerDialog.warn=function(e,f,d){return b.ligerDialog.alert(e,f,"warn",d)};b.ligerDialog.question=function(d,e){return b.ligerDialog.alert(d,e,"question")};b.ligerDialog.prompt=function(h,e,g,j){var f=b('<input type="text" class="l-dialog-inputtext"/>');if(typeof(g)=="function"){j=g}if(typeof(e)=="function"){j=e}else{if(typeof(e)=="boolean"){g=e}}if(typeof(g)=="boolean"&&g){f=b('<textarea class="l-dialog-textarea"></textarea>')}if(typeof(e)=="string"||typeof(e)=="int"){f.val(e)}var d=function(n,k,m){k.close();if(j){j(n.type=="yes",f.val())}};p={title:h,target:f,width:320,buttons:[{text:b.ligerDefaults.DialogString.ok,onclick:d,type:"yes"},{text:b.ligerDefaults.DialogString.cancel,onclick:d,type:"cancel"}]};return b.ligerDialog(p)}})(jQuery);(function(b){var a=b.ligerui;b.fn.ligerDrag=function(c){return a.run.call(this,"ligerDrag",arguments,{idAttrName:"ligeruidragid",hasElement:false,propertyToElemnt:"target"})};b.fn.ligerGetDragManager=function(){return a.run.call(this,"ligerGetDragManager",arguments,{idAttrName:"ligeruidragid",hasElement:false,propertyToElemnt:"target"})};b.ligerDefaults.Drag={onStartDrag:false,onDrag:false,onStopDrag:false,handler:null,proxy:true,revert:false,animate:true,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:false,proxyX:null,proxyY:null};a.controls.Drag=function(c){a.controls.Drag.base.constructor.call(this,null,c)};a.controls.Drag.ligerExtend(a.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var c=this,d=this.options;this.set(d);c.cursor="move";c.handler.css("cursor",c.cursor);c.handler.bind("mousedown.drag",function(f){if(d.disabled){return}if(f.button==2){return}c._start.call(c,f)}).bind("mousemove.drag",function(){if(d.disabled){return}c.handler.css("cursor",c.cursor)})},_rendered:function(){this.options.target.ligeruidragid=this.id},_start:function(f){var c=this,d=this.options;if(c.reverting){return}if(d.disabled){return}c.current={target:c.target,left:c.target.offset().left,top:c.target.offset().top,startX:f.pageX||f.screenX,startY:f.pageY||f.clientY};if(c.trigger("startDrag",[c.current,f])==false){return false}c.cursor="move";c._createProxy(d.proxy,f);if(d.proxy&&!c.proxy){return false}(c.proxy||c.handler).css("cursor",c.cursor);b(document).bind("selectstart.drag",function(){return false});b(document).bind("mousemove.drag",function(){c._drag.apply(c,arguments)});a.draggable.dragging=true;b(document).bind("mouseup.drag",function(){a.draggable.dragging=false;c._stop.apply(c,arguments)})},_drag:function(j){var f=this,h=this.options;if(!f.current){return}var d=j.pageX||j.screenX;var c=j.pageY||j.screenY;f.current.diffX=d-f.current.startX;f.current.diffY=c-f.current.startY;(f.proxy||f.handler).css("cursor",f.cursor);if(f.receive){f.receive.each(function(e,m){var k=b(m);var g=k.offset();if(d>g.left&&d<g.left+k.width()&&c>g.top&&c<g.top+k.height()){if(!f.receiveEntered[e]){f.receiveEntered[e]=true;f.trigger("dragEnter",[m,f.proxy||f.target,j])}else{f.trigger("dragOver",[m,f.proxy||f.target,j])}}else{if(f.receiveEntered[e]){f.receiveEntered[e]=false;f.trigger("dragLeave",[m,f.proxy||f.target,j])}}})}if(f.hasBind("drag")){if(f.trigger("drag",[f.current,j])!=false){f._applyDrag()}else{if(f.proxy){f._removeProxy()}else{f._stop()}}}else{f._applyDrag()}},_stop:function(f){var c=this,d=this.options;b(document).unbind("mousemove.drag");b(document).unbind("mouseup.drag");b(document).unbind("selectstart.drag");if(c.receive){c.receive.each(function(e,g){if(c.receiveEntered[e]){c.trigger("drop",[g,c.proxy||c.target,f])}})}if(c.proxy){if(d.revert){if(c.hasBind("revert")){if(c.trigger("revert",[c.current,f])!=false){c._revert(f)}else{c._removeProxy()}}else{c._revert(f)}}else{c._applyDrag(c.target);c._removeProxy()}}c.cursor="move";c.trigger("stopDrag",[c.current,f]);c.current=null;c.handler.css("cursor",c.cursor)},_revert:function(d){var c=this;c.reverting=true;c.proxy.animate({left:c.current.left,top:c.current.top},function(){c.reverting=false;c._removeProxy();c.trigger("endRevert",[c.current,d]);c.current=null})},_applyDrag:function(c){var d=this,f=this.options;c=c||d.proxy||d.target;var j={},h=false;var e=c==d.target;if(d.current.diffX){if(e||f.proxyX==null){j.left=d.current.left+d.current.diffX}else{j.left=d.current.startX+f.proxyX+d.current.diffX}h=true}if(d.current.diffY){if(e||f.proxyY==null){j.top=d.current.top+d.current.diffY}else{j.top=d.current.startY+f.proxyY+d.current.diffY}h=true}if(c==d.target&&d.proxy&&f.animate){d.reverting=true;c.animate(j,function(){d.reverting=false})}else{c.css(j)}},_setReceive:function(c){this.receiveEntered={};if(!c){return}if(typeof c=="string"){this.receive=b(c)}else{this.receive=c}},_setHandler:function(c){var d=this,e=this.options;if(!c){d.handler=b(e.target)}else{d.handler=(typeof c=="string"?b(c,e.target):c)}},_setTarget:function(c){this.target=b(c)},_setCursor:function(c){this.cursor=c;(this.proxy||this.handler).css("cursor",c)},_createProxy:function(c,h){if(!c){return}var d=this,f=this.options;if(typeof c=="function"){d.proxy=c.call(this.options.target,d,h)}else{if(c=="clone"){d.proxy=d.target.clone().css("position","absolute");d.proxy.appendTo("body")}else{d.proxy=b("<div class='l-draggable'></div>");d.proxy.width(d.target.width()).height(d.target.height());d.proxy.attr("dragid",d.id).appendTo("body")}}d.proxy.css({left:f.proxyX==null?d.current.left:d.current.startX+f.proxyX,top:f.proxyY==null?d.current.top:d.current.startY+f.proxyY}).show()},_removeProxy:function(){var c=this;if(c.proxy){c.proxy.remove();c.proxy=null}}})})(jQuery);(function(a){a.fn.ligerEasyTab=function(){return a.ligerui.run.call(this,"ligerEasyTab",arguments)};a.fn.ligerGetEasyTabManager=function(){return a.ligerui.run.call(this,"ligerGetEasyTabManager",arguments)};a.ligerDefaults.EasyTab={};a.ligerMethos.EasyTab={};a.ligerui.controls.EasyTab=function(c,b){a.ligerui.controls.EasyTab.base.constructor.call(this,c,b)};a.ligerui.controls.EasyTab.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return a.ligerMethos.EasyTab},_render:function(){var c=this,d=this.options;c.tabs=a(this.element);c.tabs.addClass("l-easytab");var b=0;if(a("> div[lselected=true]",c.tabs).length>0){b=a("> div",c.tabs).index(a("> div[lselected=true]",c.tabs))}c.tabs.ul=a('<ul class="l-easytab-header"></ul>');a("> div",c.tabs).each(function(f,g){var e=a("<li><span></span></li>");if(f==b){a("span",e).addClass("l-selected")}if(a(g).attr("title")){a("span",e).html(a(g).attr("title"))}c.tabs.ul.append(e);if(!a(g).hasClass("l-easytab-panelbox")){a(g).addClass("l-easytab-panelbox")}});c.tabs.ul.prependTo(c.tabs);a(".l-easytab-panelbox:eq("+b+")",c.tabs).show().siblings(".l-easytab-panelbox").hide();a("> ul:first span",c.tabs).click(function(){if(a(this).hasClass("l-selected")){return}var e=a("> ul:first span",c.tabs).index(this);a(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected");a(".l-easytab-panelbox:eq("+e+")",c.tabs).show().siblings(".l-easytab-panelbox").hide()}).not("l-selected").hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});c.set(d)}})})(jQuery);(function(a){a.fn.ligerFilter=function(){return a.ligerui.run.call(this,"ligerFilter",arguments)};a.fn.ligerGetFilterManager=function(){return a.ligerui.run.call(this,"ligerGetFilterManager",arguments)};a.ligerDefaults.Filter={fields:[],operators:{},editors:{}};a.ligerDefaults.FilterString={strings:{and:"并且",or:"或者",equal:"相等",notequal:"不相等",startwith:"以..开始",endwith:"以..结束",like:"相似",greater:"大于",greaterorequal:"大于或等于",less:"小于",lessorequal:"小于或等于","in":"包括在...",notin:"不包括...",addgroup:"增加分组",addrule:"增加条件",deletegroup:"删除分组"}};a.ligerDefaults.Filter.operators.string=a.ligerDefaults.Filter.operators.text=["equal","notequal","startwith","endwith","like","greater","greaterorequal","less","lessorequal","in","notin"];a.ligerDefaults.Filter.operators.number=a.ligerDefaults.Filter.operators["int"]=a.ligerDefaults.Filter.operators["float"]=a.ligerDefaults.Filter.operators.date=["equal","notequal","greater","greaterorequal","less","lessorequal","in","notin"];a.ligerDefaults.Filter.editors.string={create:function(b,d){var c=a("<input type='text'/>");b.append(c);c.ligerTextBox(d.editor.options||{});return c},setValue:function(b,c){b.val(c)},getValue:function(b){return b.liger("option","value")},destroy:function(b){b.liger("destroy")}};a.ligerDefaults.Filter.editors.date={create:function(b,d){var c=a("<input type='text'/>");b.append(c);c.ligerDateEditor(d.editor.options||{});return c},setValue:function(b,c){b.liger("option","value",c)},getValue:function(b,c){return b.liger("option","value")},destroy:function(b){b.liger("destroy")}};a.ligerDefaults.Filter.editors.number={create:function(b,e){var c=a("<input type='text'/>");b.append(c);var d={minValue:e.editor.minValue,maxValue:e.editor.maxValue};c.ligerSpinner(a.extend(d,e.editor.options||{}));return c},setValue:function(b,c){b.val(c)},getValue:function(b,d){var c=d.editor.type=="int";if(c){return parseInt(b.val(),10)}else{return parseFloat(b.val())}},destroy:function(b){b.liger("destroy")}};a.ligerDefaults.Filter.editors.combobox={create:function(b,e){var c=a("<input type='text'/>");b.append(c);var d={data:e.data,slide:false,valueField:e.editor.valueField||e.editor.valueColumnName,textField:e.editor.textField||e.editor.displayColumnName};a.extend(d,e.editor.options||{});c.ligerComboBox(d);return c},setValue:function(b,c){b.liger("option","value",c)},getValue:function(b){return b.liger("option","value")},destroy:function(b){b.liger("destroy")}};a.ligerui.controls.Filter=function(c,b){a.ligerui.controls.Filter.base.constructor.call(this,c,b)};a.ligerui.controls.Filter.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){a.ligerui.controls.Filter.base._init.call(this)},_render:function(){var b=this,c=this.options;b.set(c);a("#"+b.id+" .addgroup").live("click",function(){var d=a(this).parent().parent().parent().parent();b.addGroup(d)});a("#"+b.id+" .deletegroup").live("click",function(){var d=a(this).parent().parent().parent().parent();b.deleteGroup(d)});a("#"+b.id+" .addrule").live("click",function(){var d=a(this).parent().parent().parent().parent();b.addRule(d)});a("#"+b.id+" .deleterole").live("click",function(){var d=a(this).parent().parent();b.deleteRule(d)})},_setFields:function(b){var c=this,d=this.options;if(c.group){c.group.remove()}c.group=a(c._bulidGroupTableHtml()).appendTo(c.element)},editors:{},editorCounter:0,addGroup:function(c){var e=this,f=this.options;c=a(c||e.group);var j=a(">tbody:first > tr:last",c);var b=[];b.push('<tr class="l-filter-rowgroup"><td class="l-filter-cellgroup" colSpan="4">');var d=!c.hasClass("l-filter-group-alt");b.push(e._bulidGroupTableHtml(d,true));b.push("</td></tr>");var h=a(b.join(""));j.before(h);return h.find("table:first")},deleteGroup:function(d){var b=this,c=this.options;a("td.l-filter-value",d).each(function(){var e=a(this).parent();a("select.fieldsel",e).unbind();b.removeEditor(e)});a(d).parent().parent().remove()},removeEditor:function(b){var e=this,f=this.options;var d=a(b).attr("editortype");var h=a(b).attr("editorid");var c=e.editors[h];if(c){f.editors[d].destroy(c)}a("td.l-filter-value:first",b).html("")},setData:function(e,b){var c=this,d=this.options;b=b||c.group;var f=a(">tbody:first > tr:last",b);b.find(">tbody:first > tr").not(f).remove();a("select:first",f).val(e.op);if(e.rules){a(e.rules).each(function(){var g=c.addRule(b);g.attr("fieldtype",this.type||"string");a("select.opsel",g).val(this.op);a("select.fieldsel",g).val(this.field).trigger("change");var h=g.attr("editorid");if(h&&c.editors[h]){var j=c.getField(this.field);if(j&&j.editor){d.editors[j.editor.type].setValue(c.editors[h],this.value,j)}}else{a(":text",g).val(this.value)}})}if(e.groups){a(e.groups).each(function(){var g=c.addGroup(b);c.setData(this,g)})}},addRule:function(c){var d=this,e=this.options;c=c||d.group;var f=a(">tbody:first > tr:last",c);var b=a(d._bulidRuleRowHtml());f.before(b);if(e.fields.length){d.appendEditor(b,e.fields[0])}a("select.fieldsel",b).bind("change",function(){var m=a(this).parent().next().find("select:first");var o=a(this).val();if(!o){return}var n=d.getField(o);var k=n.type||"string";var h=b.attr("fieldtype");if(k!=h){m.html(d._bulidOpSelectOptionsHtml(k));b.attr("fieldtype",k)}var g=null;var j=b.attr("editortype");if(d.enabledEditor(n)){g=n.editor.type}if(j){d.removeEditor(b)}if(g){d.appendEditor(b,n)}else{b.removeAttr("editortype").removeAttr("editorid");a("td.l-filter-value:first",b).html('<input type="text" class="valtxt" />')}});return b},deleteRule:function(b){a("select.fieldsel",b).unbind();this.removeEditor(b);a(b).remove()},appendEditor:function(c,h){var e=this,f=this.options;if(e.enabledEditor(h)){var b=a("td.l-filter-value:first",c).html("");var d=f.editors[h.editor.type];e.editors[++e.editorCounter]=d.create(b,h);c.attr("editortype",h.editor.type).attr("editorid",e.editorCounter)}},getData:function(e){var c=this,d=this.options;e=e||c.group;var b={};a("> tbody > tr",e).each(function(j,r){var h=a(r).hasClass("l-filter-rowlast");var g=a(r).hasClass("l-filter-rowgroup");if(g){var f=a("> td:first > table:first",r);if(f.length){if(!b.groups){b.groups=[]}b.groups.push(c.getData(f))}}else{if(h){b.op=a(".groupopsel:first",r).val()}else{var q=a("select.fieldsel:first",r).val();var n=c.getField(q);var k=a(".opsel:first",r).val();var o=c._getRuleValue(r,n);var m=a(r).attr("fieldtype")||"string";if(!b.rules){b.rules=[]}b.rules.push({field:q,op:k,value:o,type:m})}}});return b},_getRuleValue:function(b,j){var f=this,h=this.options;var d=a(b).attr("editorid");var c=a(b).attr("editortype");var e=f.editors[d];if(e){return h.editors[c].getValue(e,j)}return a(".valtxt:first",b).val()},enabledEditor:function(d){var b=this,c=this.options;if(!d.editor||!d.editor.type){return false}return(d.editor.type in c.editors)},getField:function(c){var e=this,h=this.options;for(var d=0,b=h.fields.length;d<b;d++){var f=h.fields[d];if(f.name==c){return f}}return null},_bulidGroupTableHtml:function(c,b){var d=this,f=this.options;var e=[];e.push('<table cellpadding="0" cellspacing="0" border="0" class="l-filter-group');if(c){e.push(" l-filter-group-alt")}e.push('"><tbody>');e.push('<tr class="l-filter-rowlast"><td class="l-filter-rowlastcell" align="right" colSpan="4">');e.push('<select class="groupopsel">');e.push('<option value="and">'+f.strings.and+"</option>");e.push('<option value="or">'+f.strings.or+"</option>");e.push("</select>");e.push('<input type="button" value="'+f.strings.addgroup+'" class="addgroup">');e.push('<input type="button" value="'+f.strings.addrule+'" class="addrule">');if(b){e.push('<input type="button" value="'+f.strings.deletegroup+'" class="deletegroup">')}e.push("</td></tr>");e.push("</tbody></table>");return e.join("")},_bulidRuleRowHtml:function(b){var h=this,k=this.options;b=b||k.fields;var f=[];var d=b[0].type||"string";f.push('<tr fieldtype="'+d+'"><td class="l-filter-column">');f.push('<select class="fieldsel">');for(var e=0,c=b.length;e<c;e++){var j=b[e];f.push('<option value="'+j.name+'"');if(e==0){f.push(" selected ")}f.push(">");f.push(j.display);f.push("</option>")}f.push("</select>");f.push("</td>");f.push('<td class="l-filter-op">');f.push('<select class="opsel">');f.push(h._bulidOpSelectOptionsHtml(d));f.push("</select>");f.push("</td>");f.push('<td class="l-filter-value">');f.push('<input type="text" class="valtxt" />');f.push("</td>");f.push("<td>");f.push('<div class="l-icon-cross deleterole"></div>');f.push("</td>");f.push("</tr>");return f.join("")},_bulidOpSelectOptionsHtml:function(d){var h=this,j=this.options;var f=j.operators[d];var b=[];for(var e=0,c=f.length;e<c;e++){var k=f[e];b[b.length]='<option value="'+k+'">';b[b.length]=j.strings[k];b[b.length]="</option>"}return b.join("")}})})(jQuery);(function(a){a.fn.ligerForm=function(){return a.ligerui.run.call(this,"ligerForm",arguments)};a.ligerui.getConditions=function(d,c){if(!d){return null}d=liger.get(a(d));if(d&&d.toConditions){return d.toConditions()}};a.ligerDefaults=a.ligerDefaults||{};a.ligerDefaults.Form={width:null,inputWidth:180,labelWidth:90,space:40,rightToken:"：",labelAlign:"left",align:"left",fields:[],appendID:true,prefixID:null,toJSON:a.ligerui.toJSON,labelCss:null,fieldCss:null,spaceCss:null,onAfterSetFields:null,buttons:null,readonly:false,editors:{},validate:null,unSetValidateAttr:false};a.ligerDefaults.FormString={invalidMessage:"存在{errorCount}个字段验证不通过，请检查!",detailMessage:"详细",okMessage:"确定"};a.ligerDefaults.Form.editors.textarea={create:function(c,f,e){var d=a('<textarea class="l-textarea" />');var g=(e.prefixID||"")+f.field.name;if(a("#"+g).length){d=a("#"+g)}d.attr({id:g,name:g});if(e.readonly){d.attr("readonly",true)}c.append(d);return d},getValue:function(c,d){return c.val()},setValue:function(c,d,e){c.val(d)},resize:function(e,d,c,f){e.css({width:d-2}).parent().css("width","auto")}};a.ligerDefaults.Form.editors.hidden={create:function(c,f,e){var d=a('<input type = "hidden"  />');var g=(e.prefixID||"")+f.field.name;if(a("#"+g).length){d=a("#"+g)}d.attr({id:g,name:g});c.append(d);return d},getValue:function(c,d){return c.val()},setValue:function(c,d,e){c.val(d)}};a.ligerDefaults.Form_fields={name:null,textField:null,type:null,editor:null,label:null,newline:true,op:null,vt:null,attr:null,validate:null};a.ligerDefaults.Form_editor={};a.ligerDefaults.Form.editorBulider=function(j){var e=this,h=this.options;var c={},d=j.attr("ltype"),f={};if(h.readonly){c.readonly=true}c=a.extend({width:(f.width||h.inputWidth)-2},f.options,f.editor,c);if(d=="autocomplete"){c.autocomplete=true}if(j.is("select")){j.ligerComboBox(c)}else{if(j.is(":password")){j.ligerTextBox(c)}else{if(j.is(":text")){switch(d){case"select":case"combobox":case"autocomplete":j.ligerComboBox(c);break;case"spinner":j.ligerSpinner(c);break;case"date":j.ligerDateEditor(c);break;case"popup":j.ligerPopupEdit(c);break;case"currency":c.currency=true;case"float":case"number":c.number=true;j.ligerTextBox(c);break;case"int":case"digits":c.digits=true;default:j.ligerTextBox(c);break}}else{if(j.is(":radio")){j.ligerRadio(c)}else{if(j.is(":checkbox")){j.ligerCheckBox(c)}else{if(j.is("textarea")){j.addClass("l-textarea")}}}}}}};a.ligerui.controls.Form=function(d,c){a.ligerui.controls.Form.base.constructor.call(this,d,c)};a.ligerui.controls.Form.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){var e=this,f=this.options;a.ligerui.controls.Form.base._init.call(this);for(var d in liger.editors){var c=liger.editors[d];if(!c||d in f.editors){continue}f.editors[d]=liger.getEditor(a.extend({type:d,master:e},c))}},_render:function(){var d=this,e=this.options;var c=a(this.element);d.form=c.is("form")?c:c.parents("form:first");a("input,select,textarea",c).each(function(){e.editorBulider.call(d,a(this))});d.set(e);if(e.buttons){var f=a('<ul class="l-form-buttons"></ul>').appendTo(c);a(e.buttons).each(function(){var g=a("<li><div></div></li>").appendTo(f);a("div:first",g).ligerButton(this)})}if(!d.element.id){d.element.id=d.id}a("#"+d.element.id+" .togglebtn").live("click",function(){if(a(this).hasClass("togglebtn-down")){a(this).removeClass("togglebtn-down")}else{a(this).addClass("togglebtn-down")}var g=a(this).parent().nextAll("ul,div");for(var h=0;h<g.length;h++){var j=a(g[h]);if(j.hasClass("l-group")){break}if(a(this).hasClass("togglebtn-down")){j.hide()}else{j.show()}}})},_setWidth:function(d){var c=this,e=this.options;if(d){c.form.width(d)}},getEditor:function(d){var f=this,j=this.options;if(!f.editors){return}for(var e=0,c=j.fields.length;e<c;e++){var h=j.fields[e];if(h.name==d&&f.editors[e]){return f.editors[e].control}}},getField:function(c){var d=this,e=this.options;if(!e.fields){return null}return e.fields[c]},toConditions:function(){var c=this,e=this.options;var d=[];a(e.fields).each(function(h,m){var g=m.name,f=m.textField,j=c.editors[h];if(!j||!g){return}var k=j.editor.getValue(j.control);if(k!=null&&k!==""){d.push({op:m.operator||"like",field:g,value:k,type:m.type||"string"})}});return d},_preSetFields:function(c){var e=this,h=this.options,d=null,f=null;a(h.fields).each(function(g,j){if(h.readonly||j.readonly||(j.editor&&j.editor.readonly)){delete j.validate}if(j.type=="hidden"){return}j.type=j.type||"text";if(j.newline==null){j.newline=true}if(d&&!j.group){j.group=d;j.groupicon=f}if(j.group){j.group=j.group.toString().replace(/^\s\s*/,"").replace(/\s\s*$/,"");d=j.group;f=j.groupicon}})},_setReadonly:function(c){var e=this,h=this.options;if(c&&e.editors){for(var d in e.editors){var f=e.editors[d].control;if(f&&f._setReadonly){f._setReadonly(true)}}}},_setFields:function(h){var f=this,c=this.options;if(a.isFunction(c.prefixID)){c.prefixID=c.prefixID(f)}f.validate={};var n=a(this.element);a(".l-form-container",n).remove();var j=0,m=0;if(h&&h.length){f._preSetFields(h);if(!n.hasClass("l-form")){n.addClass("l-form")}var e=['<div class="l-form-container">'];var k=false,o=null;var d=[];a(h).each(function(r,t){var q=t.name,g=(t.readonly||(t.editor&&t.editor.readonly))?true:false,s=(c.prefixID||"")+(t.textField||t.id||t.name);if(t.validate&&!g){f.validate.rules=f.validate.rules||{};f.validate.rules[s]=t.validate;if(t.validateMessage){f.validate.messages=f.validate.messages||{};f.validate.messages[s]=t.validateMessage}}if(a.inArray(t.group,d)==-1){d.push(t.group)}});a(d).each(function(g,q){a(h).each(function(v,w){if(w.group!=q){return}var u=a.inArray(w,h);var t=w.id||w.name,r=w.newline;var s=(c.prefixID||"")+(w.id||w.name);if(!t){return}if(w.type=="hidden"){if(!a("#"+s).length){e.push('<div style="display:none" id="'+(f.id+"|"+v)+'"></div>')}return}var x=w.group&&w.group!=o;if(u==0||x){r=true}if(r){j=0;if(k){e.push("</ul>");k=false}if(x){e.push('<div class="l-group');if(w.groupicon){e.push(" l-group-hasicon")}e.push('">');if(w.groupicon){e.push('<img src="'+w.groupicon+'" />')}e.push("<span>"+w.group+"</span></div>");o=w.group}e.push("<ul>");k=true}e.push('<li class="l-fieldcontainer');if(r){e.push(" l-fieldcontainer-first")}e.push('"');e.push(" fieldindex="+u);e.push("><ul>");e.push(f._buliderLabelContainer(w,u));e.push(f._buliderControlContainer(w,u));e.push(f._buliderSpaceContainer(w,u));e.push("</ul></li>");j+=(w.width||c.inputWidth||0);j+=(w.space||c.space||0);j+=(w.labelWidth||c.labelWidth||0);if(j>m){m=j}})});if(k){e.push("</ul>");k=false}e.push("</div>");n.append(e.join(""));if(!c.width||m>c.width){n.width(m+10)}a(".l-group .togglebtn",n).remove();a(".l-group",n).width(n.width()*0.95).append("<div class='togglebtn'></div>")}(function(){f.editors=f.editors||{};a(h).each(function(q,t){var g=document.getElementById(f.id+"|"+q),s=c.editors[t.type];if(!g){return}g=a(g);var r=f._createEditor(s,g,{field:t},g.width(),g.height());if(f.editors[q]&&f.editors[q].control&&f.editors[q].control.destroy){f.editors[q].control.destroy()}f.editors[q]={control:r,editor:s}});f.initValidate();f.trigger("afterSetFields")})()},getData:function(){var c=this,d=this.options;c.data={};a(d.fields).each(function(g,k){var f=k.name,e=k.textField,h=c.editors[g];if(!h){return}if(f){var j=h.editor.getValue(h.control);c._setValueByName(c.data,f,j)}if(e){var j=h.editor.getText(h.control);c._setValueByName(c.data,e,j)}});return c.data},setData:function(e){var d=this,f=this.options;var c=d.get("fields");d.data=e||{};(function(){a(c).each(function(j,n){var h=n.name,g=n.textField,k=d.editors[j];if(!k){return}if(h&&(h in d.data)){var m=d._getValueByName(d.data,h);k.editor.setValue(k.control,m)}if(g&&(g in d.data)){var o=d._getValueByName(d.data,g);k.editor.setText(k.control,o)}})})()},_setValueByName:function(f,c,d){if(!f||!c){return null}if(c.indexOf(".")==-1){f[c]=d}else{try{new Function("data,value","data."+c+"=value;")(f,d)}catch(g){}}},_getValueByName:function(d,c){if(!d||!c){return null}if(c.indexOf(".")==-1){return d[c]}else{try{return new Function("data","return data."+c+";")(d)}catch(f){return null}}},valid:function(){var c=this,d=this.options;if(!c.form||!c.validator){return}return c.form.valid()},initValidate:function(){var d=this,e=this.options;if(!d.form||!e.validate||!d.form.validate){d.validator=null;return}var f=e.validate==true?{}:e.validate;var c=a.extend({errorPlacement:function(g,h){if(!h.attr("id")){h.attr("id",new Date().getTime())}if(h.hasClass("l-textarea")){h.addClass("l-textarea-invalid")}else{if(h.hasClass("l-text-field")){h.parent().addClass("l-text-invalid")}}a(h).removeAttr("title").ligerHideTip();a(h).attr("title",g.html()).ligerTip({distanceX:5,distanceY:-3,auto:true})},success:function(g){if(!g.attr("for")){return}var h=a("#"+g.attr("for"));if(h.hasClass("l-textarea")){h.removeClass("l-textarea-invalid")}else{if(h.hasClass("l-text-field")){h.parent().removeClass("l-text-invalid")}}a(h).removeAttr("title").ligerHideTip()}},f,{rules:d.validate.rules,messages:d.validate.messages});d.validator=d.form.validate(c)},showInvalid:function(c){var d=this,e=this.options;if(!d.validator){return}var f=a('<div><div class="invalid">'+e.invalidMessage.replace("{errorCount}",d.validator.errorList.length)+'<a class="viewInvalidDetail" href="javascript:void(0)">'+e.detailMessage+'</a></div><div class="invalidDetail" style="display:none;">'+b(d.validator.errorList)+"</div></div>");f.find("a.viewInvalidDetail:first").bind("click",function(){a(this).parent().next("div.invalidDetail").toggle()});a.ligerDialog.open({type:"error",width:350,showMax:false,showToggle:false,showMin:false,target:f,buttons:[{text:e.okMessage,onclick:function(g,h){h.close()}}]})},_createEditor:function(j,d,m,f,c){var h=this,k=this.options;var e=j.create.call(this,d,m,k);if(e&&j.resize){j.resize.call(this,e,f,c,m)}return e},_buliderLabelContainer:function(k){var h=this,j=this.options;var e=k.label||k.display;var c=k.labelWidth||k.labelwidth||j.labelWidth;var f=k.labelAlign||j.labelAlign;if(e){e+=j.rightToken}var d=[];d.push("<li");if(j.labelCss){d.push(' class="'+j.labelCss+'"')}d.push(' style="');if(/px$/i.test(c)||/auto/i.test(c)||/%$/i.test(c)){d.push("width:"+c+";")}else{if(c){d.push("width:"+c+"px;")}}if(f){d.push("text-align:"+f+";")}d.push('">');if(e){d.push(e)}d.push("</li>");return d.join("")},_buliderControlContainer:function(j,d){var f=this,h=this.options;var e=j.width||h.inputWidth;var k=j.align||j.textAlign||j.textalign||h.align;var c=[];c.push("<li");c.push(' id="'+(f.id+"|"+d)+'"');if(h.fieldCss){c.push(' class="'+h.fieldCss+'"')}c.push(' style="');if(e){c.push("width:"+e+"px;")}if(k){c.push("text-align:"+k+";")}c.push('">');c.push("</li>");return c.join("")},_buliderSpaceContainer:function(h){var d=this,f=this.options;var e=h.space||h.spaceWidth||f.space;if(h.space===0||h.spaceWidth===0){e=0}var c=[];c.push("<li");if(f.spaceCss){c.push(' class="'+f.spaceCss+'"')}c.push(' style="');if(/px$/i.test(e)||/auto/i.test(e)||/%$/i.test(e)){c.push("width:"+e+";")}if(e){c.push("width:"+e+"px;")}c.push('">');if(h.validate&&h.validate.required){c.push("<span class='l-star'>*</span>")}c.push("</li>");return c.join("")},_buliderControl:function(m,n){var j=this,d=this.options;var e=m.width||d.inputWidth,c=m.name||m.id,k=(m.type||"text").toLowerCase(),h=(m.readonly||(m.editor&&m.editor.readonly))?true:false;var f=[];if(k=="textarea"||k=="htmleditor"){f.push("<textarea ")}else{if(a.inArray(k,["checkbox","radio","password","file"])!=-1){f.push('<input type="'+k+'" ')}else{if(a.inArray(k,["select","combobox","autocomplete","popup","radiolist","checkboxlist","listbox"])!=-1){f.push('<input type="hidden" ')}else{f.push('<input type="text" ')}}}f.push('name="'+c+'" ');f.push('fieldindex="'+n+'" ');m.cssClass&&f.push('class="'+m.cssClass+'" ');d.appendID&&f.push(' id="'+c+'" ');f.push(j._getInputAttrHtml(m));if(m.validate&&!h){f.push(" validate='"+d.toJSON(m.validate)+"' ");j.validate=j.validate||{};j.validate.rules=j.validate.rules||{};j.validate.rules[c]=m.validate;if(m.validateMessage){j.validate.messages=j.validate.messages||{};j.validate.messages[c]=m.validateMessage}}f.push(" />");return f.join("")},_getInputAttrHtml:function(f){var c=[],d=(f.type||"text").toLowerCase();if(d=="textarea"){f.cols&&c.push('cols="'+f.cols+'" ');f.rows&&c.push('rows="'+f.rows+'" ')}c.push('ltype="'+d+'" ');f.op&&c.push('op="'+f.op+'" ');f.vt&&c.push('vt="'+f.vt+'" ');if(f.attr){for(var e in f.attr){c.push(e+'="'+f.attr[e]+'" ')}}return c.join("")}});function b(d){var c=[];a(d).each(function(g,f){var e=a(f.element).parents("li:first").prev("li:first").html();var h=f.message;c.push("<div>"+e+" "+h+"</div>")});return c.join("")}})(jQuery);(function($){var l=$.ligerui;$.fn.ligerGrid=function(options){return $.ligerui.run.call(this,"ligerGrid",arguments)};$.fn.ligerGetGridManager=function(){return $.ligerui.run.call(this,"ligerGetGridManager",arguments)};$.ligerDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:null,resizable:true,url:false,data:null,usePager:true,page:1,pageSize:10,pageSizeOptions:[10,20,30,40,50],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:false,switchPageSizeApplyComboBox:false,allowAdjustColWidth:true,checkbox:false,allowHideColumn:true,enabledEdit:false,isScroll:true,dateFormat:"yyyy-MM-dd",inWindow:true,statusName:"__status",method:"post",async:true,fixedCellHeight:true,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",allowUnSelectRow:false,alternatingRow:true,mouseoverRowCssClass:"l-grid-row-over",enabledSort:true,rowAttrRender:null,groupColumnName:null,groupColumnDisplay:"分组",groupRender:null,totalRender:null,delayLoad:false,where:null,selectRowButtonOnly:false,whenRClickToSelect:false,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:true,detailToEdit:false,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,isSelected:null,frozen:true,frozenDetail:false,frozenCheckbox:true,detail:null,detailHeight:260,isShowDetailToggle:null,rownumbers:false,frozenRownumbers:true,rownumbersColWidth:26,colDraggable:false,rowDraggable:false,rowDraggingRender:null,autoCheckChildren:true,onRowDragDrop:null,rowHeight:28,headerRowHeight:28,toolbar:null,toolbarShowInLeft:true,headerImg:null,unSetValidateAttr:true,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,onBeforeCancelEdit:null,onAfterSubmitEdit:null,onRowDragDrop:null,onGroupExtend:null,onGroupCollapse:null,onTreeExpand:null,onTreeCollapse:null,onTreeExpanded:null,onTreeCollapsed:null,onLoadData:null};$.ligerDefaults.GridString={errorMessage:"发生错误",pageStatMessage:"显示从{from}到{to}，总 {total} 条 。每页显示：{pagesize}",pageTextMessage:"Page",loadingMessage:"加载中...",findTextMessage:"查找",noRecordMessage:"没有符合条件的记录存在",isContinueByDataChanged:"数据已经改变,如果继续将丢失数据,是否继续?",cancelMessage:"取消",saveMessage:"保存",applyMessage:"应用",draggingMessage:"{count}行"};$.ligerDefaults.Grid_columns={id:null,name:null,totalSummary:null,display:null,headerRender:null,isAllowHide:true,isSort:false,type:null,columns:null,width:120,minWidth:80,format:null,align:"left",hide:false,editor:null,render:null,textField:null};$.ligerDefaults.Grid_editor={type:null,ext:null,onChange:null,onChanged:null};$.ligerMethos.Grid=$.ligerMethos.Grid||{};$.ligerDefaults.Grid.sorters=$.ligerDefaults.Grid.sorters||{};$.ligerDefaults.Grid.formatters=$.ligerDefaults.Grid.formatters||{};$.ligerDefaults.Grid.editors=$.ligerDefaults.Grid.editors||{};$.ligerDefaults.Grid.sorters.date=function(val1,val2){return val1<val2?-1:val1>val2?1:0};$.ligerDefaults.Grid.sorters["int"]=function(val1,val2){return parseInt(val1)<parseInt(val2)?-1:parseInt(val1)>parseInt(val2)?1:0};$.ligerDefaults.Grid.sorters["float"]=function(val1,val2){return parseFloat(val1)<parseFloat(val2)?-1:parseFloat(val1)>parseFloat(val2)?1:0};$.ligerDefaults.Grid.sorters.string=function(val1,val2){if(!val1){return false}return val1.localeCompare(val2)};$.ligerDefaults.Grid.formatters.date=function(value,column){function getFormatDate(date,dateformat){var g=this,p=this.options;if(isNaN(date)){return null}var format=dateformat;var o={"M+":date.getMonth()+1,"d+":date.getDate(),"h+":date.getHours(),"m+":date.getMinutes(),"s+":date.getSeconds(),"q+":Math.floor((date.getMonth()+3)/3),S:date.getMilliseconds()};if(/(y+)/.test(format)){format=format.replace(RegExp.$1,(date.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(format)){format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return format}if(!value){return""}if(typeof(value)=="string"&&/^\/Date/.test(value)){value=value.replace(/^\//,"new ").replace(/\/$/,"");eval("value = "+value)}if(value instanceof Date){var format=column.format||this.options.dateFormat||"yyyy-MM-dd";return getFormatDate(value,format)}else{return value.toString()}};$.ligerui.controls.Grid=function(element,options){$.ligerui.controls.Grid.base.constructor.call(this,element,options)};$.ligerui.controls.Grid.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return $.ligerMethos.Grid},_init:function(){$.ligerui.controls.Grid.base._init.call(this);var g=this,p=this.options;p.dataType=p.url?"server":"local";if(p.dataType=="local"){p.data=p.data||[];p.dataAction="local"}if(p.isScroll==false){p.height="auto"}if(!p.frozen){p.frozenCheckbox=false;p.frozenDetail=false;p.frozenRownumbers=false}if(p.detailToEdit){p.enabledEdit=true;p.clickToEdit=false;p.detail={height:"auto",onShowDetail:function(record,container,callback){$(container).addClass("l-grid-detailpanel-edit");g.beginEdit(record,function(rowdata,column){var editContainer=$("<div class='l-editbox'></div>");editContainer.width(120).height(p.rowHeight+1);editContainer.appendTo(container);return editContainer});function removeRow(){$(container).parent().parent().remove();g.collapseDetail(record)}$("<div class='l-clear'></div>").appendTo(container);$("<div class='l-button'>"+p.saveMessage+"</div>").appendTo(container).click(function(){g.endEdit(record);removeRow()});$("<div class='l-button'>"+p.applyMessage+"</div>").appendTo(container).click(function(){g.submitEdit(record)});$("<div class='l-button'>"+p.cancelMessage+"</div>").appendTo(container).click(function(){g.cancelEdit(record);removeRow()})}}}if(p.tree){p.tree.childrenName=p.tree.childrenName||"children";p.tree.isParent=p.tree.isParent||function(rowData){var exist=p.tree.childrenName in rowData;return exist};p.tree.isExtend=p.tree.isExtend||function(rowData){if("isextend" in rowData&&rowData.isextend==false){return false}return true}}for(var type in liger.editors){var editor=liger.editors[type];if(!editor||type in p.editors){continue}p.editors[type]=liger.getEditor($.extend({type:type,master:g},editor))}},_render:function(){var g=this,p=this.options;g.grid=$(g.element);g.grid.addClass("l-panel");var gridhtmlarr=[];gridhtmlarr.push("        <div class='l-panel-header'><span class='l-panel-header-text'></span></div>");gridhtmlarr.push("                    <div class='l-grid-loading'></div>");gridhtmlarr.push("        <div class='l-panel-topbar' style='display:none'><div class='l-panel-topbarinner'></div></div><div class='l-clear'></div>");gridhtmlarr.push("        <div class='l-panel-bwarp'>");gridhtmlarr.push("            <div class='l-panel-body'>");gridhtmlarr.push("                <div class='l-grid'>");gridhtmlarr.push("                    <div class='l-grid-dragging-line'></div>");gridhtmlarr.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                  <div class='l-grid1'>");gridhtmlarr.push("                      <div class='l-grid-header l-grid-header1'>");gridhtmlarr.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                      <div class='l-grid-body l-grid-body1'>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                  </div>");gridhtmlarr.push("                  <div class='l-grid2'>");gridhtmlarr.push("                      <div class='l-grid-header l-grid-header2'>");gridhtmlarr.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>");gridhtmlarr.push("                      </div>");gridhtmlarr.push("                  </div>");gridhtmlarr.push("                 </div>");gridhtmlarr.push("              </div>");gridhtmlarr.push("         </div>");gridhtmlarr.push("         <div class='l-panel-bar'>");gridhtmlarr.push("            <div class='l-panel-bbar-inner'>");gridhtmlarr.push("                <div class='l-bar-group  l-bar-message'><span class='l-bar-text'></span></div>");gridhtmlarr.push("            <div class='l-bar-group l-bar-selectpagesize'></div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='3' /> / <span></span></span></div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>");gridhtmlarr.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-bar-group'>");gridhtmlarr.push("                     <div class='l-bar-button l-bar-btnload'><span></span></div>");gridhtmlarr.push("                </div>");gridhtmlarr.push("                <div class='l-bar-separator'></div>");gridhtmlarr.push("                <div class='l-clear'></div>");gridhtmlarr.push("            </div>");gridhtmlarr.push("         </div>");g.grid.html(gridhtmlarr.join(""));g.header=$(".l-panel-header:first",g.grid);g.body=$(".l-panel-body:first",g.grid);g.toolbar=$(".l-panel-bar:first",g.grid);g.popup=$(".l-grid-popup:first",g.grid);g.gridloading=$(".l-grid-loading:first",g.grid);g.draggingline=$(".l-grid-dragging-line",g.grid);g.topbar=$(".l-panel-topbarinner:first",g.grid);g.gridview=$(".l-grid:first",g.grid);g.gridview.attr("id",g.id+"grid");g.gridview1=$(".l-grid1:first",g.gridview);g.gridview2=$(".l-grid2:first",g.gridview);g.gridheader=$(".l-grid-header:first",g.gridview2);g.gridbody=$(".l-grid-body:first",g.gridview2);g.f={};g.f.gridheader=$(".l-grid-header:first",g.gridview1);g.f.gridbody=$(".l-grid-body:first",g.gridview1);g.currentData=null;g.changedCells={};g.editors={};g.editor={editing:false};g.cacheData={};if(p.height=="auto"){g.bind("SysGridHeightChanged",function(){if(g.enabledFrozen()){g.gridview.height(Math.max(g.gridview1.height(),g.gridview2.height()))}})}var pc=$.extend({},p);this._bulid();this._setColumns(p.columns);delete pc.columns;delete pc.data;delete pc.url;g.set(pc);if(!p.delayLoad){if(p.url){g.set({url:p.url})}else{if(p.data){g.set({data:p.data})}}}},_setFrozen:function(frozen){if(frozen){this.grid.addClass("l-frozen")}else{this.grid.removeClass("l-frozen")}},_setCssClass:function(value){this.grid.addClass(value)},_setLoadingMessage:function(value){this.gridloading.html(value)},_setToolbar:function(value){var g=this,p=this.options;if(value&&$.fn.ligerToolBar){g.topbar.parent().show();g.toolbarManager=g.topbar.ligerToolBar(value);if(value.title){var jtitle=$("<div class='l-panel-topbartitle'><span>"+value.title+"</span></div>");if(value.icon){jtitle.append("<img class='l-panel-topbaricon' src='"+value.icon+"'></img>");jtitle.addClass("l-panel-topbartitle-hasicon")}g.topbar.parent().append(jtitle)}if(p.toolbarShowInLeft){g.topbar.addClass("l-panel-topbarinner-left")}}else{g.topbar.parent().remove()}},isHorizontalScrollShowed:function(){var g=this;var inner=g.gridbody.find(".l-grid-body-inner:first");if(!inner.length){return false}return g.gridbody.width()-20<inner.width()},_setHeight:function(h){var g=this,p=this.options;g.unbind("SysGridHeightChanged");if(h=="auto"){g.bind("SysGridHeightChanged",function(){if(g.enabledFrozen()){g.gridview.height(Math.max(g.gridview1.height(),g.gridview2.height()))}});return}h=g._calculateGridBodyHeight(h);if(h>0){g.gridbody.height(h);g.f.gridbody.height(h);var gridHeaderHeight=p.headerRowHeight*(g._columnMaxLevel-1)+p.headerRowHeight-1;g.gridview.height(h+gridHeaderHeight)}g._updateHorizontalScrollStatus.ligerDefer(g,10)},_calculateGridBodyHeight:function(h){var g=this,p=this.options;if(typeof h=="string"&&h.indexOf("%")>0){if(p.inWindow){h=$(window).height()*parseInt(h)*0.01}else{h=g.grid.parent().height()*parseInt(h)*0.01}}if(p.title){h-=24}if(p.usePager){h-=32}if(p.totalRender){h-=25}if(p.toolbar){h-=g.topbar.outerHeight()}var gridHeaderHeight=p.headerRowHeight*(g._columnMaxLevel-1)+p.headerRowHeight-1;h-=gridHeaderHeight;return h},_updateHorizontalScrollStatus:function(){var g=this,p=this.options;if(g.isHorizontalScrollShowed()){g.gridview.addClass("l-grid-hashorizontal")}else{g.gridview.removeClass("l-grid-hashorizontal")}},_updateFrozenWidth:function(){var g=this,p=this.options;if(g.enabledFrozen()){g.gridview1.width(g.f.gridtablewidth);var view2width=g.gridview.width()-g.f.gridtablewidth;g.gridview2.css({left:g.f.gridtablewidth});if(view2width>0){g.gridview2.css({width:view2width})}}},_setWidth:function(value){var g=this,p=this.options;if(g.enabledFrozen()){g._onResize()}},_setUrl:function(value){this.options.url=value;if(value){this.options.dataType="server";this.loadData(true)}else{this.options.dataType="local"}},removeParm:function(name){var g=this;var parms=g.get("parms");if(!parms){parms={}}if(parms instanceof Array){removeArrItem(parms,function(p){return p.name==name})}else{delete parms[name]}g.set("parms",parms)},setParm:function(name,value){var g=this;var parms=g.get("parms");if(!parms){parms={}}if(parms instanceof Array){removeArrItem(parms,function(p){return p.name==name});parms.push({name:name,value:value})}else{parms[name]=value}g.set("parms",parms)},_setData:function(value){this.loadData(this.options.data)},loadData:function(loadDataParm){var g=this,p=this.options;g.loading=true;g.trigger("loadData");var clause=null;var loadServer=true;if(typeof(loadDataParm)=="function"){clause=loadDataParm;if(g.lastData){g.data=g.lastData}else{g.data=g.currentData;if(!g.data){g.data={}}if(!g.data[p.root]){g.data[p.root]=[]}g.lastData=g.data}loadServer=false}else{if(typeof(loadDataParm)=="boolean"){loadServer=loadDataParm}else{if(typeof(loadDataParm)=="object"&&loadDataParm){loadServer=false;p.dataType="local";p.data=loadDataParm}}}if(!p.newPage){p.newPage=1}if(p.dataAction=="server"){if(!p.sortOrder){p.sortOrder="asc"}}var param=[];if(p.parms){var parms=$.isFunction(p.parms)?p.parms():p.parms;if(parms.length){$(parms).each(function(){param.push({name:this.name,value:this.value})})}else{if(typeof parms=="object"){for(var name in parms){param.push({name:name,value:parms[name]})}}}}if(p.dataAction=="server"){if(p.usePager){param.push({name:p.pageParmName,value:p.newPage});param.push({name:p.pagesizeParmName,value:p.pageSize})}if(p.sortName){param.push({name:p.sortnameParmName,value:p.sortName});param.push({name:p.sortorderParmName,value:p.sortOrder})}}$(".l-bar-btnload span",g.toolbar).addClass("l-disabled");if(p.dataType=="local"){g.filteredData=p.data||g.currentData;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}if(p.usePager){g.currentData=g._getCurrentPageData(g.filteredData)}else{g.currentData=g.filteredData}g._convertTreeData();g._showData()}else{if(p.dataAction=="local"&&!loadServer){if(g.data&&g.data[p.root]){g.filteredData=g.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}g.currentData=g._getCurrentPageData(g.filteredData);g._convertTreeData();g._showData()}}else{g.loadServerData(param,clause)}}g.loading=false},_convertTreeData:function(){var g=this,p=this.options;if(p.tree&&p.tree.idField&&p.tree.parentIDField){g.currentData[p.root]=g.arrayToTree(g.currentData[p.root],p.tree.idField,p.tree.parentIDField);g.currentData[p.record]=g.currentData[p.root].length}},loadServerData:function(param,clause){var g=this,p=this.options;var ajaxOptions={type:p.method,url:p.url,data:param,async:p.async,dataType:"json",beforeSend:function(){if(g.hasBind("loading")){g.trigger("loading")}else{g.toggleLoading(true)}},success:function(data){g.trigger("success",[data,g]);if(!data||!data[p.root]||!data[p.root].length){g.currentData=g.data={};g.currentData[p.root]=g.data[p.root]=[];if(data&&data[p.record]){g.currentData[p.record]=g.data[p.record]=data[p.record]}else{g.currentData[p.record]=g.data[p.record]=0}g._convertTreeData();g._showData();return}g.data=data;if(g.data[p.record]!=null&&g.cacheData.records){g.cacheData.records=g.data[p.record]}if(p.dataAction=="server"){g.currentData=g.data;if(g.currentData[p.record]==null&&g.cacheData.records){g.currentData[p.record]=g.cacheData.records}}else{g.filteredData=g.data;if(clause){g.filteredData[p.root]=g._searchData(g.filteredData[p.root],clause)}if(p.usePager){g.currentData=g._getCurrentPageData(g.filteredData)}else{g.currentData=g.filteredData}}g._convertTreeData();g._showData.ligerDefer(g,10,[g.currentData])},complete:function(){g.trigger("complete",[g]);if(g.hasBind("loaded")){g.trigger("loaded",[g])}else{g.toggleLoading.ligerDefer(g,10,[false])}},error:function(XMLHttpRequest,textStatus,errorThrown){g.currentData=g.data={};g.currentData[p.root]=g.data[p.root]=[];g.currentData[p.record]=g.data[p.record]=0;g.toggleLoading.ligerDefer(g,10,[false]);$(".l-bar-btnload span",g.toolbar).removeClass("l-disabled");g.trigger("error",[XMLHttpRequest,textStatus,errorThrown])}};if(p.contentType){ajaxOptions.contentType=p.contentType}$.ajax(ajaxOptions)},toggleLoading:function(show){this.gridloading[show?"show":"hide"]()},_createEditor:function(editorBuilder,container,editParm,width,height){var editor=editorBuilder.create.call(this,container,editParm);if(editorBuilder.setValue){editorBuilder.setValue.call(this,editor,editParm.value,editParm)}if(editorBuilder.setText&&editParm.column.textField){editorBuilder.setText.call(this,editor,editParm.text,editParm)}if(editorBuilder.resize){editorBuilder.resize.call(this,editor,width,height,editParm)}return editor},beginEdit:function(rowParm,containerBulider){var g=this,p=this.options;if(!p.enabledEdit||p.clickToEdit){return}var rowdata=g.getRow(rowParm);if(rowdata._editing){return}if(g.trigger("beginEdit",{record:rowdata,rowindex:rowdata.__index})==false){return}g.editors[rowdata.__id]={};rowdata._editing=true;g.reRender({rowdata:rowdata});containerBulider=containerBulider||function(rowdata,column){var cellobj=g.getCellObj(rowdata,column);var container=$(cellobj).html("");g.setCellEditing(rowdata,column,true);return container};for(var i=0,l=g.columns.length;i<l;i++){var column=g.columns[i];if(!column.name||!column.editor||!column.editor.type||!p.editors[column.editor.type]){continue}var editor=p.editors[column.editor.type];var editParm={record:rowdata,value:g._getValueByName(rowdata,column.name),column:column,rowindex:rowdata.__index,grid:g};var container=containerBulider(rowdata,column);var width=container.width(),height=container.height();var editorControl=g._createEditor(editor,container,editParm,width,height);g.editors[rowdata.__id][column.__id]={editor:editor,input:editorControl,editParm:editParm,container:container}}g.trigger("afterBeginEdit",{record:rowdata,rowindex:rowdata.__index})},cancelEdit:function(rowParm){var g=this;if(rowParm==undefined){for(var rowid in g.editors){g.cancelEdit(rowid)}}else{var rowdata=g.getRow(rowParm);if(!g.editors[rowdata.__id]){return}if(g.trigger("beforeCancelEdit",{record:rowdata,rowindex:rowdata.__index})==false){return}for(var columnid in g.editors[rowdata.__id]){var o=g.editors[rowdata.__id][columnid];if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}}delete g.editors[rowdata.__id];delete rowdata._editing;g.reRender({rowdata:rowdata})}},addEditRow:function(rowdata,containerBulider){this.submitEdit();rowdata=this.add(rowdata);this.beginEdit(rowdata,containerBulider)},submitEdit:function(rowParm){var g=this,p=this.options;if(rowParm==undefined){for(var rowid in g.editors){g.submitEdit(rowid)}}else{var rowdata=g.getRow(rowParm);var newdata={};if(!g.editors[rowdata.__id]){return}for(var columnid in g.editors[rowdata.__id]){var o=g.editors[rowdata.__id][columnid];var column=o.editParm.column;if(column.name){newdata[column.name]=o.editor.getValue(o.input,o.editParm)}if(column.textField&&o.editor.getText){newdata[column.textField]=o.editor.getText(o.input,o.editParm)}}if(g.trigger("beforeSubmitEdit",{record:rowdata,rowindex:rowdata.__index,newdata:newdata})==false){return false}g.updateRow(rowdata,newdata);g.trigger("afterSubmitEdit",{record:rowdata,rowindex:rowdata.__index,newdata:newdata})}},endEdit:function(rowParm){var g=this,p=this.options;if(g.editor.editing){var o=g.editor;g.trigger("sysEndEdit",[g.editor.editParm]);g.trigger("endEdit",[g.editor.editParm]);if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}g.editor.container.remove();g.reRender({rowdata:g.editor.editParm.record,column:g.editor.editParm.column});g.trigger("afterEdit",[g.editor.editParm]);g.editor={editing:false}}else{if(rowParm!=undefined){var rowdata=g.getRow(rowParm);if(!g.editors[rowdata.__id]){return}if(g.submitEdit(rowParm)==false){return false}for(var columnid in g.editors[rowdata.__id]){var o=g.editors[rowdata.__id][columnid];if(o.editor.destroy){o.editor.destroy(o.input,o.editParm)}}delete g.editors[rowdata.__id];delete rowdata._editing;g.trigger("afterEdit",{record:rowdata,rowindex:rowdata.__index})}else{for(var rowid in g.editors){g.endEdit(rowid)}}}g._fixHeight.ligerDefer(g,10)},setWidth:function(w){return this._setWidth(w)},setHeight:function(h){return this._setHeight(h)},enabledCheckbox:function(){return this.options.checkbox?true:false},enabledFrozen:function(){var g=this,p=this.options;if(!p.frozen){return false}var cols=g.columns||[];if(g.enabledDetail()&&p.frozenDetail||g.enabledCheckbox()&&p.frozenCheckbox||p.frozenRownumbers&&p.rownumbers){return true}for(var i=0,l=cols.length;i<l;i++){if(cols[i].frozen){return true}}this._setFrozen(false);return false},enabledDetailEdit:function(){if(!this.enabledDetail()){return false}return this.options.detailToEdit?true:false},enabledDetail:function(){if(this.options.detail&&this.options.detail.onShowDetail){return true}return false},enabledGroup:function(){return this.options.groupColumnName?true:false},deleteSelectedRow:function(){if(!this.selected){return}for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){this._deleteData.ligerDefer(this,10,[o])}}this.reRender.ligerDefer(this,20)},removeRange:function(rowArr){var g=this,p=this.options;$.each(rowArr,function(){g._removeData(this)});g.reRender()},remove:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);g._removeData(rowParm);g.reRender()},deleteRange:function(rowArr){var g=this,p=this.options;$.each(rowArr,function(){g._deleteData(this)});g.reRender()},deleteRow:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}g._deleteData(rowdata);g.reRender();g.isDataChanged=true},_deleteData:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);rowdata[p.statusName]="delete";if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){children[i][p.statusName]="delete"}}}g.deletedRows=g.deletedRows||[];g.deletedRows.push(rowdata);g._removeSelected(rowdata)},updateCell:function(arg,value,rowParm){var g=this,p=this.options;var column,cellObj,rowdata;if(typeof(arg)=="string"){for(var i=0,l=g.columns.length;i<l;i++){if(g.columns[i].name==arg){g.updateCell(i,value,rowParm)}}return}if(typeof(arg)=="number"){column=g.columns[arg];rowdata=g.getRow(rowParm);cellObj=g.getCellObj(rowdata,column)}else{if(typeof(arg)=="object"&&arg.__id){column=arg;rowdata=g.getRow(rowParm);cellObj=g.getCellObj(rowdata,column)}else{cellObj=arg;var ids=cellObj.id.split("|");var columnid=ids[ids.length-1];column=g._columns[columnid];var row=$(cellObj).parent();rowdata=rowdata||g.getRow(row[0])}}if(value!=null&&column.name){g._setValueByName(rowdata,column.name,value);if(rowdata[p.statusName]!="add"){rowdata[p.statusName]="update"}g.isDataChanged=true}g.reRender({rowdata:rowdata,column:column})},addRows:function(rowdataArr,neardata,isBefore,parentRowData){var g=this,p=this.options;$(rowdataArr).each(function(){g.addRow(this,neardata,isBefore,parentRowData)})},_createRowid:function(){return"r"+(1000+this.recordNumber)},_isRowId:function(str){return(str in this.records)},_addNewRecord:function(o,previd,pid){var g=this,p=this.options;g.recordNumber++;o.__id=g._createRowid();o.__previd=previd;if(previd&&previd!=-1){var prev=g.records[previd];if(prev.__nextid&&prev.__nextid!=-1){var prevOldNext=g.records[prev.__nextid];if(prevOldNext){prevOldNext.__previd=o.__id}}prev.__nextid=o.__id;o.__index=prev.__index+1}else{o.__index=0}if(p.tree){if(pid&&pid!=-1){var parent=g.records[pid];o.__pid=pid;o.__level=parent.__level+1}else{o.__pid=-1;o.__level=1}o.__hasChildren=o[p.tree.childrenName]?true:false}o[p.statusName]=o[p.statusName]||"nochanged";g.rows[o.__index]=o;g.records[o.__id]=o;return o},_getRows:function(data){var g=this,p=this.options;var targetData=[];function load(data){if(!data||!data.length){return}for(var i=0,l=data.length;i<l;i++){var o=data[i];targetData.push(o);if(o[p.tree.childrenName]){load(o[p.tree.childrenName])}}}load(data);return targetData},_updateGridData:function(){var g=this,p=this.options;g.recordNumber=0;g.rows=[];g.records={};var previd=-1;function load(data,pid){if(!data||!data.length){return}for(var i=0,l=data.length;i<l;i++){var o=data[i];g.formatRecord(o);if(o[p.statusName]=="delete"){continue}g._addNewRecord(o,previd,pid);previd=o.__id;if(o.__hasChildren){load(o[p.tree.childrenName],o.__id)}}}load(g.currentData[p.root],-1);return g.rows},_moveData:function(from,to,isAfter){var g=this,p=this.options;var fromRow=g.getRow(from);var toRow=g.getRow(to);var fromIndex,toIndex;var listdata=g._getParentChildren(fromRow);fromIndex=$.inArray(fromRow,listdata);listdata.splice(fromIndex,1);listdata=g._getParentChildren(toRow);toIndex=$.inArray(toRow,listdata);listdata.splice(toIndex+(isAfter?1:0),0,fromRow)},move:function(from,to,isAfter){this._moveData(from,to,isAfter);this.reRender()},moveRange:function(rows,to,isAfter){for(var i in rows){this._moveData(rows[i],to,isAfter)}this.reRender()},up:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index==-1||index==0){return}var selected=g.getSelected();g.move(rowdata,listdata[index-1],false);g.select(selected)},down:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index==-1||index==listdata.length-1){return}var selected=g.getSelected();g.move(rowdata,listdata[index+1],true);g.select(selected)},addRow:function(rowdata,neardata,isBefore,parentRowData){var g=this,p=this.options;rowdata=rowdata||{};g._addData(rowdata,parentRowData,neardata,isBefore);g.reRender();rowdata[p.statusName]="add";if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){children[i][p.statusName]="add"}}}g.isDataChanged=true;p.total=p.total?(p.total+1):1;p.pageCount=Math.ceil(p.total/p.pageSize);g._buildPager();g.trigger("SysGridHeightChanged");g.trigger("afterAddRow",[rowdata]);return rowdata},updateRow:function(rowDom,newRowData){var g=this,p=this.options;var rowdata=g.getRow(rowDom);g.isDataChanged=true;$.extend(rowdata,newRowData||{});if(rowdata[p.statusName]!="add"){rowdata[p.statusName]="update"}g.reRender.ligerDefer(g,10,[{rowdata:rowdata}]);return rowdata},setCellEditing:function(rowdata,column,editing){var g=this,p=this.options;var cell=g.getCellObj(rowdata,column);var methodName=editing?"addClass":"removeClass";$(cell)[methodName]("l-grid-row-cell-editing");if(rowdata.__id!=0){var prevrowobj=$(g.getRowObj(rowdata.__id)).prev();if(!prevrowobj.length){return}var prevrow=g.getRow(prevrowobj[0]);var cellprev=g.getCellObj(prevrow,column);if(!cellprev){return}$(cellprev)[methodName]("l-grid-row-cell-editing-topcell")}if(column.__previd!=-1&&column.__previd!=null){var cellprev=$(g.getCellObj(rowdata,column)).prev();$(cellprev)[methodName]("l-grid-row-cell-editing-leftcell")}},reRender:function(e){var g=this,p=this.options;e=e||{};var rowdata=e.rowdata,column=e.column;if(column&&(column.isdetail||column.ischeckbox)){return}if(rowdata&&rowdata[p.statusName]=="delete"){return}if(rowdata&&column){var cell=g.getCellObj(rowdata,column);$(cell).html(g._getCellHtml(rowdata,column));if(!column.issystem){g.setCellEditing(rowdata,column,false)}}else{if(rowdata){$(g.columns).each(function(){g.reRender({rowdata:rowdata,column:this})})}else{if(column){for(var rowid in g.records){g.reRender({rowdata:g.records[rowid],column:column})}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column.__id);$("div:first",tobj).html(g._getTotalCellContent(column,g.groups&&g.groups[i]?g.groups[i]:g.currentData[p.root]))}}else{g._showData()}}}},getData:function(status,removeStatus){var g=this,p=this.options;var data=[];if(removeStatus==undefined){removeStatus=true}for(var rowid in g.records){var o=$.extend(true,{},g.records[rowid]);if(o[p.statusName]==status||status==undefined){data.push(g.formatRecord(o,removeStatus))}}return data},formatRecord:function(o,removeStatus){delete o.__id;delete o.__previd;delete o.__nextid;delete o.__index;if(this.options.tree){delete o.__pid;delete o.__level;delete o.__hasChildren}if(removeStatus){delete o[this.options.statusName]}return o},getUpdated:function(){return this.getData("update",true)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",true)},getChanges:function(){var g=this,p=this.options;var data=[];if(this.deletedRows){$(this.deletedRows).each(function(){var o=$.extend(true,{},this);data.push(g.formatRecord(o,true))})}$.merge(data,g.getUpdated());$.merge(data,g.getAdded());return data},getColumn:function(columnParm){var g=this,p=this.options;if(typeof columnParm=="string"){if(g._isColumnId(columnParm)){return g._columns[columnParm]}else{return g.columns[parseInt(columnParm)]}}else{if(typeof(columnParm)=="number"){return g.columns[columnParm]}else{if(typeof columnParm=="object"&&columnParm.nodeType==1){var ids=columnParm.id.split("|");var columnid=ids[ids.length-1];return g._columns[columnid]}}}return columnParm},getColumnType:function(columnname){var g=this,p=this.options;for(i=0;i<g.columns.length;i++){if(g.columns[i].name==columnname){if(g.columns[i].type){return g.columns[i].type}return"string"}}return null},isTotalSummary:function(){var g=this,p=this.options;for(var i=0;i<g.columns.length;i++){if(g.columns[i].totalSummary){return true}}return false},getColumns:function(columnLevel){var g=this,p=this.options;var columns=[];for(var id in g._columns){var col=g._columns[id];if(columnLevel!=undefined){if(col.__level==columnLevel){columns.push(col)}}else{if(col.__leaf){columns.push(col)}}}return columns},changeSort:function(columnName,sortOrder){var g=this,p=this.options;if(g.loading){return true}if(p.dataAction=="local"){var columnType=g.getColumnType(columnName);if(!g.sortedData){g.sortedData=g.filteredData}if(!g.sortedData||!g.sortedData[p.root]){return}if(p.sortName==columnName){g.sortedData[p.root].reverse()}else{g.sortedData[p.root].sort(function(data1,data2){return g._compareData(data1,data2,columnName,columnType)})}if(p.usePager){g.currentData=g._getCurrentPageData(g.sortedData)}else{g.currentData=g.sortedData}g._showData()}p.sortName=columnName;p.sortOrder=sortOrder;if(p.dataAction=="server"){g.loadData(p.where)}},changePage:function(ctype){var g=this,p=this.options;if(g.loading){return true}if(p.dataAction!="local"&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}p.pageCount=parseInt($(".pcontrol span",g.toolbar).html());switch(ctype){case"first":if(p.page==1){return}p.newPage=1;break;case"prev":if(p.page==1){return}if(p.page>1){p.newPage=parseInt(p.page)-1}break;case"next":if(p.page>=p.pageCount){return}p.newPage=parseInt(p.page)+1;break;case"last":if(p.page>=p.pageCount){return}p.newPage=p.pageCount;break;case"input":var nv=parseInt($(".pcontrol input",g.toolbar).val());if(isNaN(nv)){nv=1}if(nv<1){nv=1}else{if(nv>p.pageCount){nv=p.pageCount}}$(".pcontrol input",g.toolbar).val(nv);p.newPage=nv;break}if(p.newPage==p.page){return false}if(p.newPage==1){$(".l-bar-btnfirst span",g.toolbar).addClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).addClass("l-disabled")}else{$(".l-bar-btnfirst span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).removeClass("l-disabled")}if(p.newPage==p.pageCount){$(".l-bar-btnlast span",g.toolbar).addClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).addClass("l-disabled")}else{$(".l-bar-btnlast span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).removeClass("l-disabled")}g.trigger("changePage",[p.newPage]);if(p.dataAction=="server"){g.loadData(p.where)}else{g.currentData=g._getCurrentPageData(g.filteredData);g._showData()}},getSelectedRow:function(){for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){return o}}return null},getSelectedRows:function(){var arr=[];for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){arr.push(o)}}return arr},getSelectedRowObj:function(){for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){return this.getRowObj(o)}}return null},getSelectedRowObjs:function(){var arr=[];for(var i in this.selected){var o=this.selected[i];if(o.__id in this.records){arr.push(this.getRowObj(o))}}return arr},getCellObj:function(rowParm,column){var rowdata=this.getRow(rowParm);column=this.getColumn(column);return document.getElementById(this._getCellDomId(rowdata,column))},getRowObj:function(rowParm,frozen){var g=this,p=this.options;if(rowParm==null){return null}if(typeof(rowParm)=="string"){if(g._isRowId(rowParm)){return document.getElementById(g.id+(frozen?"|1|":"|2|")+rowParm)}else{return document.getElementById(g.id+(frozen?"|1|":"|2|")+g.rows[parseInt(rowParm)]["__id"])}}else{if(typeof(rowParm)=="number"){return document.getElementById(g.id+(frozen?"|1|":"|2|")+g.rows[rowParm]["__id"])}else{if(typeof(rowParm)=="object"&&rowParm.__id){return g.getRowObj(rowParm.__id,frozen)}}}return rowParm},getRow:function(rowParm){var g=this,p=this.options;if(rowParm==null){return null}if(typeof(rowParm)=="string"){if(g._isRowId(rowParm)){return g.records[rowParm]}else{return g.rows[parseInt(rowParm)]}}else{if(typeof(rowParm)=="number"){return g.rows[parseInt(rowParm)]}else{if(typeof(rowParm)=="object"&&rowParm.nodeType==1&&!rowParm.__id){return g._getRowByDomId(rowParm.id)}}}return rowParm},_setColumnVisible:function(column,hide){var g=this,p=this.options;if(!hide){column._hide=false;document.getElementById(column.__domid).style.display="";if(column.__pid!=-1){var pcol=g._columns[column.__pid];if(pcol._hide){document.getElementById(pcol.__domid).style.display="";this._setColumnVisible(pcol,hide)}}}else{column._hide=true;document.getElementById(column.__domid).style.display="none";if(column.__pid!=-1){var hideall=true;var pcol=this._columns[column.__pid];for(var i=0;pcol&&i<pcol.columns.length;i++){if(!pcol.columns[i]._hide){hideall=false;break}}if(hideall){pcol._hide=true;document.getElementById(pcol.__domid).style.display="none";this._setColumnVisible(pcol,hide)}}}},toggleCol:function(columnparm,visible,toggleByPopup){var g=this,p=this.options;var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm.__id){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.toggleCol(this,visible,toggleByPopup)}});return}}}}if(!column){return}var columnindex=column.__leafindex;var headercell=document.getElementById(column.__domid);if(!headercell){return}headercell=$(headercell);var cells=[];for(var i in g.rows){var obj=g.getCellObj(g.rows[i],column);if(obj){cells.push(obj)}}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column.__id);if(tobj){cells.push(tobj)}}var colwidth=column._width;if(visible&&column._hide){if(column.frozen){g.f.gridtablewidth+=(parseInt(colwidth)+1)}else{g.gridtablewidth+=(parseInt(colwidth)+1)}g._setColumnVisible(column,false);$(cells).show()}else{if(!visible&&!column._hide){if(column.frozen){g.f.gridtablewidth-=(parseInt(colwidth)+1)}else{g.gridtablewidth-=(parseInt(colwidth)+1)}g._setColumnVisible(column,true);$(cells).hide()}}if(column.frozen){$("div:first",g.f.gridheader).width(g.f.gridtablewidth);$("div:first",g.f.gridbody).width(g.f.gridtablewidth)}else{$("div:first",g.gridheader).width(g.gridtablewidth+40);$("div:first",g.gridbody).width(g.gridtablewidth)}g._updateFrozenWidth();if(!toggleByPopup){$(":checkbox[columnindex="+columnindex+"]",g.popup).each(function(){this.checked=visible;if($.fn.ligerCheckBox){var checkboxmanager=$(this).ligerGetCheckBoxManager();if(checkboxmanager){checkboxmanager.updateStyle()}}})}},setColumnWidth:function(columnparm,newwidth){var g=this,p=this.options;if(!newwidth){return}newwidth=parseInt(newwidth,10);var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm.__id){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.setColumnWidth(this,newwidth)}});return}}}}if(!column){return}var mincolumnwidth=p.minColumnWidth;if(column.minWidth){mincolumnwidth=column.minWidth}newwidth=newwidth<mincolumnwidth?mincolumnwidth:newwidth;var diff=newwidth-column._width;if(g.trigger("beforeChangeColumnWidth",[column,newwidth])==false){return}column._width=newwidth;if(column.frozen){g.f.gridtablewidth+=diff;$("div:first",g.f.gridheader).width(g.f.gridtablewidth);$("div:first",g.f.gridbody).width(g.f.gridtablewidth)}else{g.gridtablewidth+=diff;$("div:first",g.gridheader).width(g.gridtablewidth+40);$("div:first",g.gridbody).width(g.gridtablewidth)}$(document.getElementById(column.__domid)).css("width",newwidth);var cells=[];for(var rowid in g.records){var obj=g.getCellObj(g.records[rowid],column);if(obj){cells.push(obj)}if(!g.enabledDetailEdit()&&g.editors[rowid]&&g.editors[rowid][column.__id]){var o=g.editors[rowid][column.__id];if(o.editor.resize){o.editor.resize(o.input,newwidth,o.container.height(),o.editParm)}}}for(var i=0;i<g.totalNumber;i++){var tobj=document.getElementById(g.id+"|total"+i+"|"+column.__id);if(tobj){cells.push(tobj)}}$(cells).css("width",newwidth).find("> div.l-grid-row-cell-inner:first").css("width",newwidth-8);g._updateFrozenWidth();g._updateHorizontalScrollStatus.ligerDefer(g,10);g.trigger("afterChangeColumnWidth",[column,newwidth])},changeHeaderText:function(columnparm,headerText){var g=this,p=this.options;var column;if(typeof(columnparm)=="number"){column=g.columns[columnparm]}else{if(typeof(columnparm)=="object"&&columnparm.__id){column=columnparm}else{if(typeof(columnparm)=="string"){if(g._isColumnId(columnparm)){column=g._columns[columnparm]}else{$(g.columns).each(function(){if(this.name==columnparm){g.changeHeaderText(this,headerText)}});return}}}}if(!column){return}var columnindex=column.__leafindex;var headercell=document.getElementById(column.__domid);$(".l-grid-hd-cell-text",headercell).html(headerText);if(p.allowHideColumn){$(":checkbox[columnindex="+columnindex+"]",g.popup).parent().next().html(headerText)}},changeCol:function(from,to,isAfter){var g=this,p=this.options;if(!from||!to){return}var fromCol=g.getColumn(from);var toCol=g.getColumn(to);fromCol.frozen=toCol.frozen;var fromColIndex,toColIndex;var fromColumns=fromCol.__pid==-1?p.columns:g._columns[fromCol.__pid].columns;var toColumns=toCol.__pid==-1?p.columns:g._columns[toCol.__pid].columns;fromColIndex=$.inArray(fromCol,fromColumns);toColIndex=$.inArray(toCol,toColumns);var sameParent=fromColumns==toColumns;var sameLevel=fromCol.__level==toCol.__level;toColumns.splice(toColIndex+(isAfter?1:0),0,fromCol);if(!sameParent){fromColumns.splice(fromColIndex,1)}else{if(isAfter){fromColumns.splice(fromColIndex,1)}else{fromColumns.splice(fromColIndex+1,1)}}g._setColumns(p.columns);g.reRender()},collapseDetail:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}for(var i=0,l=g.columns.length;i<l;i++){if(g.columns[i].isdetail){var row=g.getRowObj(rowdata);var cell=g.getCellObj(rowdata,g.columns[i]);$(row).next("tr.l-grid-detailpanel").hide();$(".l-grid-row-cell-detailbtn:first",cell).removeClass("l-open");g.trigger("SysGridHeightChanged");return}}},extendDetail:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}for(var i=0,l=g.columns;i<l;i++){if(g.columns[i].isdetail){var row=g.getRowObj(rowdata);var cell=g.getCellObj(rowdata,g.columns[i]);$(row).next("tr.l-grid-detailpanel").show();$(".l-grid-row-cell-detailbtn:first",cell).addClass("l-open");g.trigger("SysGridHeightChanged");return}}},getParent:function(rowParm){var g=this,p=this.options;if(!p.tree){return null}var rowdata=g.getRow(rowParm);if(!rowdata){return null}if(rowdata.__pid in g.records){return g.records[rowdata.__pid]}else{return null}},getChildren:function(rowParm,deep){var g=this,p=this.options;if(!p.tree){return null}var rowData=g.getRow(rowParm);if(!rowData){return null}var arr=[];function loadChildren(data){if(data[p.tree.childrenName]){for(var i=0,l=data[p.tree.childrenName].length;i<l;i++){var o=data[p.tree.childrenName][i];if(o.__status=="delete"){continue}arr.push(o);if(deep){loadChildren(o)}}}}loadChildren(rowData);return arr},isLeaf:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata){return}return rowdata.__hasChildren?false:true},hasChildren:function(rowParm){var g=this,p=this.options;var rowdata=this.getRow(rowParm);if(!rowdata){return}return(rowdata[p.tree.childrenName]&&rowdata[p.tree.childrenName].length)?true:false},existRecord:function(record){for(var rowid in this.records){if(this.records[rowid]==record){return true}}return false},_removeSelected:function(rowdata){var g=this,p=this.options;if(p.tree){var children=g.getChildren(rowdata,true);if(children){for(var i=0,l=children.length;i<l;i++){var index2=$.inArray(children[i],g.selected);if(index2!=-1){g.selected.splice(index2,1)}}}}var index=$.inArray(rowdata,g.selected);if(index!=-1){g.selected.splice(index,1)}},_getParentChildren:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var listdata;if(p.tree&&g.existRecord(rowdata)&&rowdata.__pid in g.records){listdata=g.records[rowdata.__pid][p.tree.childrenName]}else{listdata=g.currentData[p.root]}return listdata},_removeData:function(rowdata){var g=this,p=this.options;var listdata=g._getParentChildren(rowdata);var index=$.inArray(rowdata,listdata);if(index!=-1){listdata.splice(index,1)}g._removeSelected(rowdata)},_addData:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;if(!g.currentData){g.currentData={}}if(!g.currentData[p.root]){g.currentData[p.root]=[]}var listdata=g.currentData[p.root];if(neardata){if(p.tree){if(parentdata){listdata=parentdata[p.tree.childrenName]}else{if(neardata.__pid in g.records){listdata=g.records[neardata.__pid][p.tree.childrenName]}}}var index=$.inArray(neardata,listdata);listdata.splice(index==-1?-1:index+(isBefore?0:1),0,rowdata)}else{if(p.tree&&parentdata){listdata=parentdata[p.tree.childrenName]}listdata.push(rowdata)}},_appendData:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;rowdata[p.statusName]="update";g._removeData(rowdata);g._addData(rowdata,parentdata,neardata,isBefore)},appendRange:function(rows,parentdata,neardata,isBefore){var g=this,p=this.options;var toRender=false;$.each(rows,function(i,item){if(item.__id&&g.existRecord(item)){if(g.isLeaf(parentdata)){g.upgrade(parentdata)}g._appendData(item,parentdata,neardata,isBefore);toRender=true}else{g.appendRow(item,parentdata,neardata,isBefore)}});if(toRender){g.reRender()}},appendRow:function(rowdata,parentdata,neardata,isBefore){var g=this,p=this.options;if($.isArray(rowdata)){g.appendRange(rowdata,parentdata,neardata,isBefore);return}if(rowdata.__id&&g.existRecord(rowdata)){g._appendData(rowdata,parentdata,neardata,isBefore);g.reRender();return}if(parentdata&&g.isLeaf(parentdata)){g.upgrade(parentdata)}g.addRow(rowdata,neardata,isBefore?true:false,parentdata)},upgrade:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata||!p.tree){return}rowdata[p.tree.childrenName]=rowdata[p.tree.childrenName]||[];rowdata.__hasChildren=true;var rowobjs=[g.getRowObj(rowdata)];if(g.enabledFrozen()){rowobjs.push(g.getRowObj(rowdata,true))}$("> td > div > .l-grid-tree-space:last",rowobjs).addClass("l-grid-tree-link l-grid-tree-link-open")},demotion:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);if(!rowdata||!p.tree){return}var rowobjs=[g.getRowObj(rowdata)];if(g.enabledFrozen()){rowobjs.push(g.getRowObj(rowdata,true))}$("> td > div > .l-grid-tree-space:last",rowobjs).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close");if(g.hasChildren(rowdata)){var children=g.getChildren(rowdata);for(var i=0,l=children.length;i<l;i++){g.deleteRow(children[i])}}rowdata.__hasChildren=false},collapseAll:function(){var g=this,p=this.options;$(g.rows).each(function(rowIndex,rowParm){var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-close")){return}g.toggle(rowParm)})},expandAll:function(){var g=this,p=this.options;$(g.rows).each(function(rowIndex,rowParm){var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-open")){return}g.toggle(rowParm)})},collapse:function(rowParm){var g=this,p=this.options;var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-close")){return}g.toggle(rowParm)},expand:function(rowParm){var g=this,p=this.options;var targetRowObj=g.getRowObj(rowParm);var linkbtn=$(".l-grid-tree-link",targetRowObj);if(linkbtn.hasClass("l-grid-tree-link-open")){return}g.toggle(rowParm)},toggle:function(rowParm){if(!rowParm){return}var g=this,p=this.options;var rowdata=g.getRow(rowParm);var targetRowObj=[g.getRowObj(rowdata)];if(g.enabledFrozen()){targetRowObj.push(g.getRowObj(rowdata,true))}var level=rowdata.__level,indexInCollapsedRows;var linkbtn=$(".l-grid-tree-link:first",targetRowObj);var opening=true;g.collapsedRows=g.collapsedRows||[];if(linkbtn.hasClass("l-grid-tree-link-close")){if(g.hasBind("treeExpand")&&g.trigger("treeExpand",[rowdata])==false){return false}linkbtn.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows);if(indexInCollapsedRows!=-1){g.collapsedRows.splice(indexInCollapsedRows,1)}}else{if(g.hasBind("treeCollapse")&&g.trigger("treeCollapse",[rowdata])==false){return false}opening=false;linkbtn.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open");indexInCollapsedRows=$.inArray(rowdata,g.collapsedRows);if(indexInCollapsedRows==-1){g.collapsedRows.push(rowdata)}}var children=g.getChildren(rowdata,true);for(var i=0,l=children.length;i<l;i++){var o=children[i];var currentRow=$([g.getRowObj(o.__id)]);if(g.enabledFrozen()){currentRow=currentRow.add(g.getRowObj(o.__id,true))}if(opening){$(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open");currentRow.show()}else{$(".l-grid-tree-link",currentRow).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close");currentRow.hide()}}g.trigger(opening?"treeExpanded":"treeCollapsed",[rowdata])},_bulid:function(){var g=this;g._clearGrid();g._initBuildHeader();g._initHeight();g._initFootbar();g._buildPager();g._setEvent()},_setColumns:function(columns){var g=this;g._initColumns();g._initBuildGridHeader();g._initBuildPopup()},_initBuildHeader:function(){var g=this,p=this.options;if(p.title){$(".l-panel-header-text",g.header).html(p.title);if(p.headerImg){g.header.append("<img src='"+p.headerImg+"' />").addClass("l-panel-header-hasicon")}}else{g.header.hide()}if(p.toolbar){if($.fn.ligerToolBar){g.toolbarManager=g.topbar.ligerToolBar(p.toolbar)}}else{g.topbar.parent().remove()}},_createColumnId:function(column){if(column.id!=null&&column.id!=""){return column.id.toString()}return"c"+(100+this._columnCount)},_isColumnId:function(str){return(str in this._columns)},_initColumns:function(){var g=this,p=this.options;g._columns={};g._columnCount=0;g._columnLeafCount=0;g._columnMaxLevel=1;if(!p.columns){return}function removeProp(column,props){for(var i in props){if(props[i] in column){delete column[props[i]]}}}function setColumn(column,level,pid,previd){removeProp(column,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]);if(level>g._columnMaxLevel){g._columnMaxLevel=level}g._columnCount++;column.__id=g._createColumnId(column);column.__domid=g.id+"|hcell|"+column.__id;g._columns[column.__id]=column;if(!column.columns||!column.columns.length){column.__leafindex=g._columnLeafCount++}column.__level=level;column.__pid=pid;column.__previd=previd;if(!column.columns||!column.columns.length){column.__leaf=true;return 1}var leafcount=0;var newid=-1;for(var i=0,l=column.columns.length;i<l;i++){var col=column.columns[i];leafcount+=setColumn(col,level+1,column.__id,newid);newid=col.__id}column.__leafcount=leafcount;return leafcount}var lastid=-1;if(p.rownumbers){var frozenRownumbers=g.enabledGroup()?false:p.frozen&&p.frozenRownumbers;var col={isrownumber:true,issystem:true,width:p.rownumbersColWidth,frozen:frozenRownumbers};setColumn(col,1,-1,lastid);lastid=col.__id}if(g.enabledDetail()){var frozenDetail=g.enabledGroup()?false:p.frozen&&p.frozenDetail;var col={isdetail:true,issystem:true,width:p.detailColWidth,frozen:frozenDetail};setColumn(col,1,-1,lastid);lastid=col.__id}if(g.enabledCheckbox()){var frozenCheckbox=g.enabledGroup()?false:p.frozen&&p.frozenCheckbox;var col={ischeckbox:true,issystem:true,width:p.detailColWidth,frozen:frozenCheckbox};setColumn(col,1,-1,lastid);lastid=col.__id}for(var i=0,l=p.columns.length;i<l;i++){var col=p.columns[i];setColumn(col,1,-1,lastid);lastid=col.__id}for(var id in g._columns){var col=g._columns[id];if(col.__leafcount>1){col.__colSpan=col.__leafcount}if(col.__leaf&&col.__level!=g._columnMaxLevel){col.__rowSpan=g._columnMaxLevel-col.__level+1}}g.columns=g.getColumns();$(g.columns).each(function(i,column){column.columnname=column.name;column.columnindex=i;column.type=column.type||"string";column.islast=i==g.columns.length-1;column.isSort=column.isSort==false?false:true;column.frozen=column.frozen?true:false;column._width=g._getColumnWidth(column);column._hide=column.hide?true:false})},_getColumnWidth:function(column){var g=this,p=this.options;if(column._width){return column._width}var colwidth=column.width||p.columnWidth;if(!colwidth||colwidth=="auto"){var autoColumnNumber=0,noAutoColumnWidth=0;$(g.columns).each(function(i,col){var colwidth=col.width||p.columnWidth;var isAuto=(!colwidth||colwidth=="auto")?true:false;if(isAuto){autoColumnNumber++}else{noAutoColumnWidth+=(parseInt(g._getColumnWidth(col))+1)}});colwidth=parseInt((g.grid.width()-noAutoColumnWidth)/autoColumnNumber)-1}if(typeof(colwidth)=="string"&&colwidth.indexOf("%")>0){column._width=colwidth=parseInt(parseInt(colwidth)*0.01*(g.grid.width()-g.columns.length))}if(column.minWidth&&colwidth<column.minWidth){colwidth=column.minWidth}if(column.maxWidth&&colwidth>column.maxWidth){colwidth=column.maxWidth}return colwidth},_createHeaderCell:function(column){var g=this,p=this.options;var jcell=$("<td class='l-grid-hd-cell'><div class='l-grid-hd-cell-inner'><span class='l-grid-hd-cell-text'></span></div></td>");jcell.attr("id",column.__domid);if(!column.__leaf){jcell.addClass("l-grid-hd-cell-mul")}if(column.columnindex==g.columns.length-1){jcell.addClass("l-grid-hd-cell-last")}if(column.isrownumber){jcell.addClass("l-grid-hd-cell-rownumbers");jcell.html("<div class='l-grid-hd-cell-inner'></div>")}if(column.ischeckbox){jcell.addClass("l-grid-hd-cell-checkbox");jcell.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")}if(column.isdetail){jcell.addClass("l-grid-hd-cell-detail");jcell.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")}if(column.heightAlign){$(".l-grid-hd-cell-inner:first",jcell).css("textAlign",column.heightAlign)}if(column.__colSpan){jcell.attr("colSpan",column.__colSpan)}if(column.__rowSpan){jcell.attr("rowSpan",column.__rowSpan);jcell.height(p.headerRowHeight*column.__rowSpan);var paddingTop=(p.headerRowHeight*column.__rowSpan-p.headerRowHeight)/2-5;$(".l-grid-hd-cell-inner:first",jcell).css("paddingTop",paddingTop)}else{jcell.height(p.headerRowHeight)}if(column.__leaf){jcell.width(column._width);jcell.attr("columnindex",column.__leafindex)}var cellHeight=jcell.height();if(!column.__rowSpan&&cellHeight>10){$(">div:first",jcell).height(cellHeight)}if(column._hide){jcell.hide()}if(column.name){jcell.attr({columnname:column.name})}var headerText="";if(column.display&&column.display!=""){headerText=column.display}else{if(column.headerRender){headerText=column.headerRender(column)}else{headerText="&nbsp;"}}$(".l-grid-hd-cell-text:first",jcell).html(headerText);if(!column.issystem&&column.__leaf&&column.resizable!==false&&$.fn.ligerResizable&&p.allowAdjustColWidth){g.colResizable[column.__id]=jcell.ligerResizable({handles:"e",onStartResize:function(e,ev){this.proxy.hide();g.draggingline.css({height:g.body.height(),top:0,left:ev.pageX-g.grid.offset().left+parseInt(g.body[0].scrollLeft)}).show()},onResize:function(e,ev){g.colresizing=true;g.draggingline.css({left:ev.pageX-g.grid.offset().left+parseInt(g.body[0].scrollLeft)});$("body").add(jcell).css("cursor","e-resize")},onStopResize:function(e){g.colresizing=false;$("body").add(jcell).css("cursor","default");g.draggingline.hide();g.setColumnWidth(column,parseInt(column._width)+e.diffX);return false}})}return jcell},_initBuildGridHeader:function(){var g=this,p=this.options;g.gridtablewidth=0;g.f.gridtablewidth=0;if(g.colResizable){for(var i in g.colResizable){g.colResizable[i].destroy()}g.colResizable=null}g.colResizable={};$("tbody:first",g.gridheader).html("");$("tbody:first",g.f.gridheader).html("");for(var level=1;level<=g._columnMaxLevel;level++){var columns=g.getColumns(level);var islast=level==g._columnMaxLevel;var tr=$("<tr class='l-grid-hd-row'></tr>");var trf=$("<tr class='l-grid-hd-row'></tr>");if(!islast){tr.add(trf).addClass("l-grid-hd-mul")}$("tbody:first",g.gridheader).append(tr);$("tbody:first",g.f.gridheader).append(trf);$(columns).each(function(i,column){(column.frozen?trf:tr).append(g._createHeaderCell(column));if(column.__leaf){var colwidth=column._width;if(!column.frozen){g.gridtablewidth+=(parseInt(colwidth)?parseInt(colwidth):0)+1}else{g.f.gridtablewidth+=(parseInt(colwidth)?parseInt(colwidth):0)+1}}})}if(g._columnMaxLevel>0){var h=p.headerRowHeight*g._columnMaxLevel;g.gridheader.add(g.f.gridheader).height(h);if(p.rownumbers&&p.frozenRownumbers){g.f.gridheader.find("td:first").height(h)}}g._updateFrozenWidth();$("div:first",g.gridheader).width(g.gridtablewidth+40)},_initBuildPopup:function(){var g=this,p=this.options;$(":checkbox",g.popup).unbind();$("tbody tr",g.popup).remove();$(g.columns).each(function(i,column){if(column.issystem){return}if(column.isAllowHide==false){return}var chk='checked="checked"';if(column._hide){chk=""}var header=column.display;$("tbody",g.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+chk+' class="l-checkbox" columnindex="'+i+'"/></td><td class="l-column-right">'+header+"</td></tr>")});if($.fn.ligerCheckBox){$("input:checkbox",g.popup).ligerCheckBox({onBeforeClick:function(obj){if(!obj.checked){return true}if($("input:checked",g.popup).length<=p.minColToggle){return false}return true}})}if(p.allowHideColumn){$("tr",g.popup).hover(function(){$(this).addClass("l-popup-row-over")},function(){$(this).removeClass("l-popup-row-over")});var onPopupCheckboxChange=function(){if($("input:checked",g.popup).length+1<=p.minColToggle){return false}g.toggleCol(parseInt($(this).attr("columnindex")),this.checked,true)};if($.fn.ligerCheckBox){$(":checkbox",g.popup).bind("change",onPopupCheckboxChange)}else{$(":checkbox",g.popup).bind("click",onPopupCheckboxChange)}}},_initHeight:function(){var g=this,p=this.options;if(p.height=="auto"){g.gridbody.height("auto");g.f.gridbody.height("auto")}if(p.width){g.grid.width(p.width)}g._onResize.call(g)},_initFootbar:function(){var g=this,p=this.options;if(p.usePager){var optStr="";var selectedIndex=-1;$(p.pageSizeOptions).each(function(i,item){var selectedStr="";if(p.pageSize==item){selectedIndex=i}optStr+="<option value='"+item+"' "+selectedStr+" >"+item+"</option>"});$(".l-bar-selectpagesize",g.toolbar).append("<select name='rp'>"+optStr+"</select>");if(selectedIndex!=-1){$(".l-bar-selectpagesize select",g.toolbar)[0].selectedIndex=selectedIndex}if(p.switchPageSizeApplyComboBox&&$.fn.ligerComboBox){$(".l-bar-selectpagesize select",g.toolbar).ligerComboBox({onBeforeSelect:function(){if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}return true},width:45})}}else{g.toolbar.hide()}},_searchData:function(data,clause){var g=this,p=this.options;var newData=new Array();for(var i=0;i<data.length;i++){if(clause(data[i],i)){newData[newData.length]=data[i]}}return newData},_clearGrid:function(){var g=this,p=this.options;for(var i in g.rows){var rowobj=$(g.getRowObj(g.rows[i]));if(g.enabledFrozen()){rowobj=rowobj.add(g.getRowObj(g.rows[i],true))}rowobj.unbind()}g.gridbody.html("");g.f.gridbody.html("");g.recordNumber=0;g.records={};g.rows=[];g.selected=[];g.totalNumber=0;g.editorcounter=0},_fillGridBody:function(data,frozen){var g=this,p=this.options;var gridhtmlarr=['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];if(g.enabledGroup()){var groups=[];var groupsdata=[];g.groups=groupsdata;for(var rowparm in data){var item=data[rowparm];var groupColumnValue=item[p.groupColumnName];var valueIndex=$.inArray(groupColumnValue,groups);if(valueIndex==-1){groups.push(groupColumnValue);valueIndex=groups.length-1;groupsdata.push([])}groupsdata[valueIndex].push(item)}$(groupsdata).each(function(i,item){if(groupsdata.length==1){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"')}if(i==groupsdata.length-1){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-last"')}else{if(i==0){gridhtmlarr.push('<tr class="l-grid-grouprow l-grid-grouprow-first"')}else{gridhtmlarr.push('<tr class="l-grid-grouprow"')}}gridhtmlarr.push(' groupindex"='+i+'" >');gridhtmlarr.push('<td colSpan="'+g.columns.length+'" class="l-grid-grouprow-cell">');gridhtmlarr.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>');if(p.groupRender){gridhtmlarr.push(p.groupRender(groups[i],item,p.groupColumnDisplay))}else{gridhtmlarr.push(p.groupColumnDisplay+":"+groups[i])}gridhtmlarr.push("</td>");gridhtmlarr.push("</tr>");gridhtmlarr.push(g._getHtmlFromData(item,frozen));if(g.isTotalSummary()){gridhtmlarr.push(g._getTotalSummaryHtml(item,"l-grid-totalsummary-group",frozen))}})}else{gridhtmlarr.push(g._getHtmlFromData(data,frozen))}gridhtmlarr.push("</tbody></table></div>");(frozen?g.f.gridbody:g.gridbody).html(gridhtmlarr.join(""));if(!g.enabledGroup()){g._bulidTotalSummary(frozen)}$("> div:first",g.gridbody).width(g.gridtablewidth);g._onResize()},_showData:function(){var g=this,p=this.options;g.changedCells={};var data=g.currentData[p.root];if(p.usePager){if(p.dataAction=="server"&&g.data&&g.data[p.record]){p.total=g.data[p.record]}else{if(g.filteredData&&g.filteredData[p.root]){p.total=g.filteredData[p.root].length}else{if(g.data&&g.data[p.root]){p.total=g.data[p.root].length}else{if(data){p.total=data.length}}}}p.page=p.newPage;if(!p.total){p.total=0}if(!p.page){p.page=1}p.pageCount=Math.ceil(p.total/p.pageSize);if(!p.pageCount){p.pageCount=1}g._buildPager()}$(".l-bar-btnloading:first",g.toolbar).removeClass("l-bar-btnloading");if(g.trigger("beforeShowData",[g.currentData])==false){return}g._clearGrid();g.isDataChanged=false;if(!data||!data.length){g.gridview.addClass("l-grid-empty");$("<div></div>").addClass("l-grid-body-inner").appendTo(g.gridbody).css({width:g.gridheader.find(">div:first").width(),height:g.gridbody.height()});g._onResize.ligerDefer(g,50);return}else{g.gridview.removeClass("l-grid-empty")}$(".l-bar-btnload:first span",g.toolbar).removeClass("l-disabled");g._updateGridData();if(g.enabledFrozen()){g._fillGridBody(g.rows,true)}g._fillGridBody(g.rows,false);g.trigger("SysGridHeightChanged");if(p.totalRender){$(".l-panel-bar-total",g.element).remove();$(".l-panel-bar",g.element).before('<div class="l-panel-bar-total">'+p.totalRender(g.data,g.filteredData)+"</div>")}if(p.mouseoverRowCssClass){for(var i in g.rows){var rowobj=$(g.getRowObj(g.rows[i]));if(g.enabledFrozen()){rowobj=rowobj.add(g.getRowObj(g.rows[i],true))}rowobj.bind("mouseover.gridrow",function(){g._onRowOver(this,true)}).bind("mouseout.gridrow",function(){g._onRowOver(this,false)})}}g._fixHeight();g.gridbody.trigger("scroll.grid");g.trigger("afterShowData",[g.currentData])},_fixHeight:function(){var g=this,p=this.options;if(p.fixedCellHeight||!p.frozen){return}var column1,column2;for(var i in g.columns){var column=g.columns[i];if(column1&&column2){break}if(column.frozen&&!column1){column1=column;continue}if(!column.frozen&&!column2){column2=column;continue}}if(!column1||!column2){return}for(var rowid in g.records){var cell1=g.getCellObj(rowid,column1),cell2=g.getCellObj(rowid,column2);var height=Math.max($(cell1).height(),($(cell2).height()));$(cell1).add(cell2).height(height)}},_getRowDomId:function(rowdata,frozen){return this.id+"|"+(frozen?"1":"2")+"|"+rowdata.__id},_getCellDomId:function(rowdata,column){return this._getRowDomId(rowdata,column.frozen)+"|"+column.__id},_getHtmlFromData:function(data,frozen){if(!data){return""}var g=this,p=this.options;var gridhtmlarr=[];for(var i=0,l=data.length;i<l;i++){var item=data[i];var rowid=item.__id;if(!item){continue}gridhtmlarr.push("<tr");gridhtmlarr.push(' id="'+g._getRowDomId(item,frozen)+'"');gridhtmlarr.push(' class="l-grid-row');if(!frozen&&g.enabledCheckbox()&&p.isChecked&&p.isChecked(item)){g.select(item);gridhtmlarr.push(" l-selected")}else{if(g.isSelected(item)){gridhtmlarr.push(" l-selected")}else{if(p.isSelected&&p.isSelected(item)){g.select(item);gridhtmlarr.push(" l-selected")}}}if(item.__index%2==1&&p.alternatingRow){gridhtmlarr.push(" l-grid-row-alt")}gridhtmlarr.push('" ');if(p.rowAttrRender){gridhtmlarr.push(p.rowAttrRender(item,rowid))}if(p.tree&&g.collapsedRows&&g.collapsedRows.length){var isHide=function(){var pitem=g.getParent(item);while(pitem){if($.inArray(pitem,g.collapsedRows)!=-1){return true}pitem=g.getParent(pitem)}return false};if(isHide()){gridhtmlarr.push(' style="display:none;" ')}}gridhtmlarr.push(">");$(g.columns).each(function(columnindex,column){if(frozen!=column.frozen){return}gridhtmlarr.push("<td");gridhtmlarr.push(' id="'+g._getCellDomId(item,this)+'"');if(this.isrownumber){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}else{gridhtmlarr.push(' style = "min-height:'+p.rowHeight+'px;" ')}gridhtmlarr.push(">"+(parseInt(item.__index)+1)+"</div></td>");return}if(this.ischeckbox){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}else{gridhtmlarr.push(' style = "min-height:'+p.rowHeight+'px;" ')}gridhtmlarr.push(">");gridhtmlarr.push('<span class="l-grid-row-cell-btn-checkbox"></span>');gridhtmlarr.push("</div></td>");return}else{if(this.isdetail){gridhtmlarr.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"');if(p.fixedCellHeight){gridhtmlarr.push(' style = "height:'+p.rowHeight+'px;" ')}else{gridhtmlarr.push(' style = "min-height:'+p.rowHeight+'px;" ')}gridhtmlarr.push(">");if(!p.isShowDetailToggle||p.isShowDetailToggle(item)){gridhtmlarr.push('<span class="l-grid-row-cell-detailbtn"></span>')}gridhtmlarr.push("</div></td>");return}}var colwidth=this._width;gridhtmlarr.push(' class="l-grid-row-cell ');if(g.changedCells[rowid+"_"+this["__id"]]){gridhtmlarr.push("l-grid-row-cell-edited ")}if(this.islast){gridhtmlarr.push("l-grid-row-cell-last ")}gridhtmlarr.push('"');gridhtmlarr.push(' style = "');gridhtmlarr.push("width:"+colwidth+"px; ");if(column._hide){gridhtmlarr.push("display:none;")}gridhtmlarr.push(' ">');gridhtmlarr.push(g._getCellHtml(item,column));gridhtmlarr.push("</td>")});gridhtmlarr.push("</tr>")}return gridhtmlarr.join("")},_getCellHtml:function(rowdata,column){var g=this,p=this.options;if(column.isrownumber){return'<div class="l-grid-row-cell-inner">'+(parseInt(rowdata.__index)+1)+"</div>"}var htmlarr=[];htmlarr.push('<div class="l-grid-row-cell-inner"');htmlarr.push(' style = "width:'+parseInt(column._width-8)+"px;");if(p.fixedCellHeight){htmlarr.push("height:"+p.rowHeight+"px;")}htmlarr.push("min-height:"+p.rowHeight+"px; ");if(column.align){htmlarr.push("text-align:"+column.align+";")}var content=g._getCellContent(rowdata,column);htmlarr.push('">'+content+"</div>");return htmlarr.join("")},_setValueByName:function(data,name,value){if(!data||!name){return null}if(name.indexOf(".")==-1){data[name]=value}else{try{new Function("data,value","data."+name+"=value;")(data,value)}catch(e){}}},_getValueByName:function(data,name){if(!data||!name){return null}if(name.indexOf(".")==-1){return data[name]}else{try{return new Function("data","return data."+name+";")(data)}catch(e){return null}}},_getCellContent:function(rowdata,column){var g=this,p=this.options;if(!rowdata||!column){return""}if(column.isrownumber){return parseInt(rowdata.__index)+1}var rowid=rowdata.__id;var rowindex=rowdata.__index;var value=g._getValueByName(rowdata,column.name);var text=g._getValueByName(rowdata,column.textField);var content="";if(column.render){content=column.render.call(g,rowdata,rowindex,value,column)}else{if(p.formatters[column.type]){content=p.formatters[column.type].call(g,value,column)}else{if(text!=null){content=text.toString()}else{if(value!=null){content=value.toString()}}}}if(p.tree&&(p.tree.columnName!=null&&p.tree.columnName==column.name||p.tree.columnId!=null&&p.tree.columnId==column.id)){content=g._getTreeCellHtml(content,rowdata)}return content||""},_getTreeCellHtml:function(oldContent,rowdata){var level=rowdata.__level;var g=this,p=this.options;var isExtend=$.inArray(rowdata,g.collapsedRows||[])==-1;var isParent=p.tree.isParent(rowdata);var content="";level=parseInt(level)||1;for(var i=1;i<level;i++){content+="<div class='l-grid-tree-space'></div>"}if(isExtend&&isParent){content+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>"}else{if(isParent){content+="<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>"}else{content+="<div class='l-grid-tree-space'></div>"}}content+="<span class='l-grid-tree-content'>"+oldContent+"</span>";return content},_applyEditor:function(obj){var g=this,p=this.options;var rowcell=obj,ids=rowcell.id.split("|");var columnid=ids[ids.length-1],column=g._columns[columnid];var row=$(rowcell).parent(),rowdata=g.getRow(row[0]),rowid=rowdata.__id,rowindex=rowdata.__index;if(!column||!column.editor){return}var columnname=column.name,columnindex=column.columnindex;if(column.editor.type&&p.editors[column.editor.type]){var currentdata=g._getValueByName(rowdata,columnname);var editParm={record:rowdata,value:currentdata,column:column,rowindex:rowindex};if(column.textField){editParm.text=g._getValueByName(rowdata,column.textField)}if(g.trigger("beforeEdit",[editParm])==false){return false}g.lastEditRow=rowdata;var editor=p.editors[column.editor.type],jcell=$(rowcell),offset=$(rowcell).offset(),width=$(rowcell).width(),height=$(rowcell).height(),container=$("<div class='l-grid-editor'></div>").appendTo(g.grid),left=0,top=0,pc=jcell.position(),pb=g.gridbody.position(),pv=g.gridview2.position(),topbarHeight=p.toolbar?g.topbar.parent().outerHeight():0+p.title?g.header.outerHeight():0,left=pc.left+pb.left+pv.left,top=pc.top+pb.top+pv.top+topbarHeight;jcell.html("");g.setCellEditing(rowdata,column,true);container.css({left:left,top:$.browser.safari?top+2:top+1}).show();if(column.textField){editParm.text=g._getValueByName(rowdata,column.textField)}var editorInput=g._createEditor(editor,container,editParm,width,height-1);g.editor={editing:true,editor:editor,input:editorInput,editParm:editParm,container:container};g.unbind("sysEndEdit");g.bind("sysEndEdit",function(){var newValue=editor.getValue(editorInput,editParm);if(newValue!=currentdata){$(rowcell).addClass("l-grid-row-cell-edited");g.changedCells[rowid+"_"+column.__id]=true;editParm.value=newValue;if(column.textField&&editor.getText){editParm.text=editor.getText(editorInput,editParm)}if(editor.getSelected){editParm.selected=editor.getSelected(editorInput,editParm)}if(column.editor.onChange){column.editor.onChange(editParm)}if(g._checkEditAndUpdateCell(editParm)){if(column.editor.onChanged){column.editor.onChanged(editParm)}}}})}},_checkEditAndUpdateCell:function(editParm){var g=this,p=this.options;if(g.trigger("beforeSubmitEdit",[editParm])==false){return false}var column=editParm.column;if(editParm.text&&column.textField){g._setValueByName(editParm.record,column.textField,editParm.text)}g.updateCell(column,editParm.value,editParm.record);if(column.render||g.enabledTotal()){g.reRender({column:column})}g.reRender({rowdata:editParm.record});return true},_getCurrentPageData:function(source){var g=this,p=this.options;var data={};data[p.root]=[];if(!source||!source[p.root]||!source[p.root].length){data[p.record]=0;return data}data[p.record]=source[p.root].length;if(!p.newPage){p.newPage=1}for(i=(p.newPage-1)*p.pageSize;i<source[p.root].length&&i<p.newPage*p.pageSize;i++){data[p.root].push(source[p.root][i])}return data},_compareData:function(data1,data2,columnName,columnType){var g=this,p=this.options;var val1=data1[columnName],val2=data2[columnName];if(val1==null&&val2!=null){return 1}else{if(val1==null&&val2==null){return 0}else{if(val1!=null&&val2==null){return -1}}}if(p.sorters[columnType]){return p.sorters[columnType].call(g,val1,val2)}else{return val1<val2?-1:val1>val2?1:0}},_getTotalCellContent:function(column,data){var g=this,p=this.options;var totalsummaryArr=[];if(column.totalSummary){var isExist=function(type){for(var i=0;i<types.length;i++){if(types[i].toLowerCase()==type.toLowerCase()){return true}}return false};var sum=0,count=0,avg=0;var max=parseFloat(data[0][column.name]);var min=parseFloat(data[0][column.name]);for(var i=0;i<data.length;i++){count+=1;var value=data[i][column.name];if(typeof(value)=="string"){value=value.replace(/\$|\,/g,"")}value=parseFloat(value);if(!value){continue}sum+=value;if(value>max){max=value}if(value<min){min=value}}avg=sum*1/data.length;if(column.totalSummary.render){var renderhtml=column.totalSummary.render({sum:sum,count:count,avg:avg,min:min,max:max},column,g.data);totalsummaryArr.push(renderhtml)}else{if(column.totalSummary.type){var types=column.totalSummary.type.split(",");if(isExist("sum")){totalsummaryArr.push("<div>Sum="+sum.toFixed(2)+"</div>")}if(isExist("count")){totalsummaryArr.push("<div>Count="+count+"</div>")}if(isExist("max")){totalsummaryArr.push("<div>Max="+max.toFixed(2)+"</div>")}if(isExist("min")){totalsummaryArr.push("<div>Min="+min.toFixed(2)+"</div>")}if(isExist("avg")){totalsummaryArr.push("<div>Avg="+avg.toFixed(2)+"</div>")}}}}return totalsummaryArr.join("")},_getTotalSummaryHtml:function(data,classCssName,frozen){var g=this,p=this.options;var totalsummaryArr=[];if(classCssName){totalsummaryArr.push('<tr class="l-grid-totalsummary '+classCssName+'">')}else{totalsummaryArr.push('<tr class="l-grid-totalsummary">')}$(g.columns).each(function(columnindex,column){if(this.frozen!=frozen){return}if(this.isrownumber){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}if(this.ischeckbox){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}else{if(this.isdetail){totalsummaryArr.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>');return}}totalsummaryArr.push('<td class="l-grid-totalsummary-cell');if(this.islast){totalsummaryArr.push(" l-grid-totalsummary-cell-last")}totalsummaryArr.push('" ');totalsummaryArr.push('id="'+g.id+"|total"+g.totalNumber+"|"+column.__id+'" ');totalsummaryArr.push('width="'+this._width+'" ');columnname=this.columnname;if(columnname){totalsummaryArr.push('columnname="'+columnname+'" ')}totalsummaryArr.push('columnindex="'+columnindex+'" ');totalsummaryArr.push('><div class="l-grid-totalsummary-cell-inner"');if(column.align){totalsummaryArr.push(' style="text-Align:'+column.align+';"')}totalsummaryArr.push(">");totalsummaryArr.push(g._getTotalCellContent(column,data));totalsummaryArr.push("</div></td>")});totalsummaryArr.push("</tr>");if(!frozen){g.totalNumber++}return totalsummaryArr.join("")},_bulidTotalSummary:function(frozen){var g=this,p=this.options;if(!g.isTotalSummary()){return false}if(!g.currentData||g.currentData[p.root].length==0){return false}var totalRow=$(g._getTotalSummaryHtml(g.currentData[p.root],null,frozen));$("tbody:first",frozen?g.f.gridbody:g.gridbody).append(totalRow);if(frozen){g.totalRow1=totalRow}else{g.totalRow2=totalRow}},updateTotalSummary:function(){var g=this,p=this.options;if(!g.isTotalSummary()){return}if(!g.currentData||g.currentData[p.root].length==0){return}var totalRow2=$(g._getTotalSummaryHtml(g.currentData[p.root],null,false));if(g.totalRow2){g.totalRow2.html(totalRow2.html())}},_buildPager:function(){var g=this,p=this.options;$(".pcontrol input",g.toolbar).val(p.page);if(!p.pageCount){p.pageCount=1}$(".pcontrol span",g.toolbar).html(p.pageCount);var r1=parseInt((p.page-1)*p.pageSize)+1;var r2=parseInt(r1)+parseInt(p.pageSize)-1;if(!p.total){p.total=0}if(p.total<r2){r2=p.total}if(!p.total){r1=r2=0}if(r1<0){r1=0}if(r2<0){r2=0}var stat=p.pageStatMessage;stat=stat.replace(/{from}/,r1);stat=stat.replace(/{to}/,r2);stat=stat.replace(/{total}/,p.total);stat=stat.replace(/{pagesize}/,p.pageSize);$(".l-bar-text",g.toolbar).html(stat);if(!p.total){$(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",g.toolbar).addClass("l-disabled")}if(p.page==1){$(".l-bar-btnfirst span",g.toolbar).addClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).addClass("l-disabled")}else{if(p.page>p.pageCount&&p.pageCount>0){$(".l-bar-btnfirst span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnprev span",g.toolbar).removeClass("l-disabled")}}if(p.page==p.pageCount){$(".l-bar-btnlast span",g.toolbar).addClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).addClass("l-disabled")}else{if(p.page<p.pageCount&&p.pageCount>0){$(".l-bar-btnlast span",g.toolbar).removeClass("l-disabled");$(".l-bar-btnnext span",g.toolbar).removeClass("l-disabled")}}},_getRowIdByDomId:function(domid){var ids=domid.split("|");var rowid=ids[2];return rowid},_getRowByDomId:function(domid){return this.records[this._getRowIdByDomId(domid)]},_isEditing:function(jobjs){return jobjs.hasClass("l-box-dateeditor")||jobjs.hasClass("l-box-select")},_getSrcElementByEvent:function(e){var g=this;var obj=(e.target||e.srcElement);var jobjs=$(obj).parents().add(obj);var fn=function(parm){for(var i=0,l=jobjs.length;i<l;i++){if(typeof parm=="string"){if($(jobjs[i]).hasClass(parm)){return jobjs[i]}}else{if(typeof parm=="object"){if(jobjs[i]==parm){return jobjs[i]}}}}return null};if(fn("l-grid-editor")){return{editing:true,editor:fn("l-grid-editor")}}if(jobjs.index(this.element)==-1){if(g._isEditing(jobjs)){return{editing:true}}else{return{out:true}}}var indetail=false;if(jobjs.hasClass("l-grid-detailpanel")&&g.detailrows){for(var i=0,l=g.detailrows.length;i<l;i++){if(jobjs.index(g.detailrows[i])!=-1){indetail=true;break}}}var r={grid:fn("l-panel"),indetail:indetail,frozen:fn(g.gridview1[0])?true:false,header:fn("l-panel-header"),gridheader:fn("l-grid-header"),gridbody:fn("l-grid-body"),total:fn("l-panel-bar-total"),popup:fn("l-grid-popup"),toolbar:fn("l-panel-bar")};if(r.gridheader){r.hrow=fn("l-grid-hd-row");r.hcell=fn("l-grid-hd-cell");r.hcelltext=fn("l-grid-hd-cell-text");r.checkboxall=fn("l-grid-hd-cell-checkbox");if(r.hcell){var columnid=r.hcell.id.split("|")[2];r.column=g._columns[columnid]}}if(r.gridbody){r.row=fn("l-grid-row");r.cell=fn("l-grid-row-cell");r.checkbox=fn("l-grid-row-cell-btn-checkbox");r.groupbtn=fn("l-grid-group-togglebtn");r.grouprow=fn("l-grid-grouprow");r.detailbtn=fn("l-grid-row-cell-detailbtn");r.detailrow=fn("l-grid-detailpanel");r.totalrow=fn("l-grid-totalsummary");r.totalcell=fn("l-grid-totalsummary-cell");r.rownumberscell=$(r.cell).hasClass("l-grid-row-cell-rownumbers")?r.cell:null;r.detailcell=$(r.cell).hasClass("l-grid-row-cell-detail")?r.cell:null;r.checkboxcell=$(r.cell).hasClass("l-grid-row-cell-checkbox")?r.cell:null;r.treelink=fn("l-grid-tree-link");r.editor=fn("l-grid-editor");if(r.row){r.data=this._getRowByDomId(r.row.id)}if(r.cell){r.editing=$(r.cell).hasClass("l-grid-row-cell-editing")}if(r.editor){r.editing=true}if(r.editing){r.out=false}}if(r.toolbar){r.first=fn("l-bar-btnfirst");r.last=fn("l-bar-btnlast");r.next=fn("l-bar-btnnext");r.prev=fn("l-bar-btnprev");r.load=fn("l-bar-btnload");r.button=fn("l-bar-button")}return r},_setEvent:function(){var g=this,p=this.options;g.grid.bind("mousedown.grid",function(e){g._onMouseDown.call(g,e)});g.grid.bind("dblclick.grid",function(e){g._onDblClick.call(g,e)});g.grid.bind("contextmenu.grid",function(e){return g._onContextmenu.call(g,e)});$(document).bind("mouseup.grid",function(e){g._onMouseUp.call(g,e)});$(document).bind("click.grid",function(e){g._onClick.call(g,e)});$(window).bind("resize.grid",function(e){g._onResize.call(g)});$(document).bind("keydown.grid",function(e){if(e.ctrlKey){g.ctrlKey=true}});$(document).bind("keyup.grid",function(e){delete g.ctrlKey});g.gridbody.bind("scroll.grid",function(){var scrollLeft=g.gridbody.scrollLeft();var scrollTop=g.gridbody.scrollTop();if(scrollLeft!=null){g.gridheader[0].scrollLeft=scrollLeft}if(scrollTop!=null){g.f.gridbody[0].scrollTop=scrollTop}g.trigger("SysGridHeightChanged")});$("select",g.toolbar).change(function(){if(g.isDataChanged&&p.dataAction!="local"&&!confirm(p.isContinueByDataChanged)){return false}p.newPage=1;p.pageSize=this.value;g.loadData(p.dataAction!="local"?p.where:false)});$("span.pcontrol :text",g.toolbar).blur(function(e){g.changePage("input")});$("div.l-bar-button",g.toolbar).hover(function(){$(this).addClass("l-bar-button-over")},function(){$(this).removeClass("l-bar-button-over")});if($.fn.ligerDrag&&p.colDraggable){g.colDroptip=$("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");g.gridheader.add(g.f.gridheader).ligerDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(draggable,e){var src=g._getSrcElementByEvent(e);if(src.hcell&&src.column){var content=$(".l-grid-hd-cell-text:first",src.hcell).html();var proxy=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");proxy.append(content);return proxy}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");g.children[this.id]=this},onStartDrag:function(current,e){if(e.button==2){return false}if(g.colresizing){return false}this.set("cursor","default");var src=g._getSrcElementByEvent(e);if(!src.hcell||!src.column||src.column.issystem||src.hcelltext){return false}if($(src.hcell).css("cursor").indexOf("resize")!=-1){return false}this.draggingColumn=src.column;g.coldragging=true;var gridOffset=g.grid.offset();this.validRange={top:gridOffset.top,bottom:gridOffset.top+g.gridheader.height(),left:gridOffset.left-10,right:gridOffset.left+g.grid.width()+10}},onDrag:function(current,e){this.set("cursor","default");var column=this.draggingColumn;if(!column){return false}if(g.colresizing){return false}if(g.colDropIn==null){g.colDropIn=-1}var pageX=e.pageX;var pageY=e.pageY;var visit=false;var gridOffset=g.grid.offset();var validRange=this.validRange;if(pageX<validRange.left||pageX>validRange.right||pageY>validRange.bottom||pageY<validRange.top){g.colDropIn=-1;g.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no");return}for(var colid in g._columns){var col=g._columns[colid];if(column==col){visit=true;continue}if(col.issystem){continue}var sameLevel=col.__level==column.__level;var isAfter=!sameLevel?false:visit?true:false;if(column.frozen!=col.frozen){isAfter=col.frozen?false:true}if(g.colDropIn!=-1&&g.colDropIn!=colid){continue}var cell=document.getElementById(col.__domid);var offset=$(cell).offset();var range={top:offset.top,bottom:offset.top+$(cell).height(),left:offset.left-10,right:offset.left+10};if(isAfter){var cellwidth=$(cell).width();range.left+=cellwidth;range.right+=cellwidth}if(pageX>range.left&&pageX<range.right&&pageY>range.top&&pageY<range.bottom){var height=p.headerRowHeight;if(col.__rowSpan){height*=col.__rowSpan}g.colDroptip.css({left:range.left+5,top:range.top-9,height:height+9*2}).show();g.colDropIn=colid;g.colDropDir=isAfter?"right":"left";this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}else{if(g.colDropIn!=-1){g.colDropIn=-1;g.colDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no")}}}},onStopDrag:function(current,e){var column=this.draggingColumn;g.coldragging=false;if(g.colDropIn!=-1){g.changeCol.ligerDefer(g,0,[column,g.colDropIn,g.colDropDir=="right"]);g.colDropIn=-1}g.colDroptip.hide();this.set("cursor","default")}})}if($.fn.ligerDrag&&p.rowDraggable){g.rowDroptip=$("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body");g.gridbody.add(g.f.gridbody).ligerDrag({revert:true,animate:false,proxyX:0,proxyY:0,proxy:function(draggable,e){var src=g._getSrcElementByEvent(e);if(src.row){var content=p.draggingMessage.replace(/{count}/,draggable.draggingRows?draggable.draggingRows.length:1);if(p.rowDraggingRender){content=p.rowDraggingRender(draggable.draggingRows,draggable,g)}var proxy=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+content+"</div>").appendTo("body");return proxy}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");g.children[this.id]=this},onStartDrag:function(current,e){if(e.button==2){return false}if(g.colresizing){return false}if(!g.columns.length){return false}this.set("cursor","default");var src=g._getSrcElementByEvent(e);if(!src.cell||!src.data||src.checkbox){return false}var ids=src.cell.id.split("|");var column=g._columns[ids[ids.length-1]];if(src.rownumberscell||src.detailcell||src.checkboxcell||column==g.columns[0]){if(g.enabledCheckbox()){this.draggingRows=g.getSelecteds();if(!this.draggingRows||!this.draggingRows.length){return false}}else{this.draggingRows=[src.data]}this.draggingRow=src.data;this.set("cursor","move");g.rowdragging=true;this.validRange={top:g.gridbody.offset().top,bottom:g.gridbody.offset().top+g.gridbody.height(),left:g.grid.offset().left-10,right:g.grid.offset().left+g.grid.width()+10}}else{return false}},onDrag:function(current,e){var rowdata=this.draggingRow;if(!rowdata){return false}var rows=this.draggingRows?this.draggingRows:[rowdata];if(g.colresizing){return false}if(g.rowDropIn==null){g.rowDropIn=-1}var pageX=e.pageX;var pageY=e.pageY;var visit=false;var validRange=this.validRange;if(pageX<validRange.left||pageX>validRange.right||pageY>validRange.bottom||pageY<validRange.top){g.rowDropIn=-1;g.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var i in g.rows){var rd=g.rows[i];var rowid=rd.__id;if(rowdata==rd){visit=true}if($.inArray(rd,rows)!=-1){continue}var isAfter=visit?true:false;if(g.rowDropIn!=-1&&g.rowDropIn!=rowid){continue}var rowobj=g.getRowObj(rowid);var offset=$(rowobj).offset();var range={top:offset.top-4,bottom:offset.top+$(rowobj).height()+4,left:g.grid.offset().left,right:g.grid.offset().left+g.grid.width()};if(pageX>range.left&&pageX<range.right&&pageY>range.top&&pageY<range.bottom){var lineTop=offset.top;if(isAfter){lineTop+=$(rowobj).height()}g.rowDroptip.css({left:range.left,top:lineTop,width:range.right-range.left}).show();g.rowDropIn=rowid;g.rowDropDir=isAfter?"bottom":"top";if(p.tree&&pageY>range.top+5&&pageY<range.bottom-5){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");g.rowDroptip.hide();g.rowDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");g.rowDroptip.show();g.rowDropInParent=false}break}else{if(g.rowDropIn!=-1){g.rowDropIn=-1;g.rowDropInParent=false;g.rowDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}}},onStopDrag:function(current,e){var rows=this.draggingRows;g.rowdragging=false;for(var i=0;i<rows.length;i++){var children=rows[i].children;if(children){rows=$.grep(rows,function(node,i){var isIn=$.inArray(node,children)==-1;return isIn})}}if(g.rowDropIn!=-1){if(p.tree){var neardata,prow;if(g.rowDropInParent){prow=g.getRow(g.rowDropIn)}else{neardata=g.getRow(g.rowDropIn);prow=g.getParent(neardata)}g.appendRange(rows,prow,neardata,g.rowDropDir!="bottom");g.trigger("rowDragDrop",{rows:rows,parent:prow,near:neardata,after:g.rowDropDir=="bottom"})}else{g.moveRange(rows,g.rowDropIn,g.rowDropDir=="bottom");g.trigger("rowDragDrop",{rows:rows,parent:prow,near:g.getRow(g.rowDropIn),after:g.rowDropDir=="bottom"})}g.rowDropIn=-1}g.rowDroptip.hide();this.set("cursor","default")}})}},_onRowOver:function(rowParm,over){if(l.draggable.dragging){return}var g=this,p=this.options;var rowdata=g.getRow(rowParm);var methodName=over?"addClass":"removeClass";if(g.enabledFrozen()){$(g.getRowObj(rowdata,true))[methodName](p.mouseoverRowCssClass)}$(g.getRowObj(rowdata,false))[methodName](p.mouseoverRowCssClass)},_onMouseUp:function(e){var g=this,p=this.options;if(l.draggable.dragging){var src=g._getSrcElementByEvent(e);if(src.hcell&&src.column){g.trigger("dragdrop",[{type:"header",column:src.column,cell:src.hcell},e])}else{if(src.row){g.trigger("dragdrop",[{type:"row",record:src.data,row:src.row},e])}}}},_onMouseDown:function(e){var g=this,p=this.options},_onContextmenu:function(e){var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.row){if(p.whenRClickToSelect){g.select(src.data)}if(g.hasBind("contextmenu")){return g.trigger("contextmenu",[{data:src.data,rowindex:src.data.__index,row:src.row},e])}}else{if(src.hcell){if(!p.allowHideColumn){return true}var columnindex=$(src.hcell).attr("columnindex");if(columnindex==undefined){return true}var left=(e.pageX-g.body.offset().left+parseInt(g.body[0].scrollLeft));if(columnindex==g.columns.length-1){left-=50}g.popup.css({left:left,top:g.gridheader.height()+1});g.popup.toggle();return false}}},_onDblClick:function(e){var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.row){g.trigger("dblClickRow",[src.data,src.data.__id,src.row])}},_onClick:function(e){var obj=(e.target||e.srcElement);var g=this,p=this.options;var src=g._getSrcElementByEvent(e);if(src.out){if(g.editor.editing&&!$.ligerui.win.masking){g.endEdit()}if(p.allowHideColumn){g.popup.hide()}return}if(src.indetail||src.editing){return}if(g.editor.editing){g.endEdit()}if(p.allowHideColumn){if(!src.popup){g.popup.hide()}}if(src.checkboxall){var row=$(src.hrow);var uncheck=row.hasClass("l-checked");if(g.trigger("beforeCheckAllRow",[!uncheck,g.element])==false){return false}if(uncheck){row.removeClass("l-checked")}else{row.addClass("l-checked")}g.selected=[];for(var rowid in g.records){if(uncheck){g.unselect(g.records[rowid])}else{g.select(g.records[rowid])}}g.trigger("checkAllRow",[!uncheck,g.element])}else{if(src.hcelltext){var hcell=$(src.hcelltext).parent().parent();if(!p.enabledSort||!src.column){return}if(src.column.isSort==false){return}if(p.url&&p.dataAction!="local"&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return}var sort=$(".l-grid-hd-cell-sort:first",hcell);var columnName=src.column.name;if(!columnName){return}if(sort.length>0){if(sort.hasClass("l-grid-hd-cell-sort-asc")){sort.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc");hcell.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc");g.trigger("ChangeSort",[columnName,"desc"]);g.changeSort(columnName,"desc")}else{if(sort.hasClass("l-grid-hd-cell-sort-desc")){sort.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc");hcell.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");g.trigger("ChangeSort",[columnName,"asc"]);g.changeSort(columnName,"asc")}}}else{hcell.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc");$(src.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>");g.trigger("ChangeSort",[columnName,"asc"]);g.changeSort(columnName,"asc")}$(".l-grid-hd-cell-sort",g.gridheader).add($(".l-grid-hd-cell-sort",g.f.gridheader)).not($(".l-grid-hd-cell-sort:first",hcell)).remove()}else{if(src.detailbtn&&p.detail){var item=src.data;var row=$([g.getRowObj(item,false)]);if(g.enabledFrozen()){row=row.add(g.getRowObj(item,true))}var rowid=item.__id;if($(src.detailbtn).hasClass("l-open")){if(p.detail.onCollapse){p.detail.onCollapse(item,$(".l-grid-detailpanel-inner:first",nextrow)[0])}row.next("tr.l-grid-detailpanel").hide();$(src.detailbtn).removeClass("l-open")}else{var nextrow=row.next("tr.l-grid-detailpanel");if(nextrow.length>0){nextrow.show();if(p.detail.onExtend){p.detail.onExtend(item,$(".l-grid-detailpanel-inner:first",nextrow)[0])}$(src.detailbtn).addClass("l-open");g.trigger("SysGridHeightChanged");return}$(src.detailbtn).addClass("l-open");var frozenColNum=0;for(var i=0;i<g.columns.length;i++){if(g.columns[i].frozen){frozenColNum++}}var detailRow=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");var detailFrozenRow=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>");detailRow.find("div:first").width(g.gridheader.find("div:first").width()-50);detailRow.attr("id",g.id+"|detail|"+rowid);g.detailrows=g.detailrows||[];g.detailrows.push(detailRow[0]);g.detailrows.push(detailFrozenRow[0]);var detailRowInner=$("div:first",detailRow);detailRowInner.parent().attr("colSpan",g.columns.length-frozenColNum);row.eq(0).after(detailRow);if(frozenColNum>0){detailFrozenRow.find("td:first").attr("colSpan",frozenColNum);row.eq(1).after(detailFrozenRow)}if(p.detail.onShowDetail){p.detail.onShowDetail(item,detailRowInner[0],function(){g.trigger("SysGridHeightChanged")});$("div:first",detailFrozenRow).add(detailRowInner).show().height(p.detail.height||p.detailHeight)}else{if(p.detail.render){detailRowInner.append(p.detail.render());detailRowInner.show()}}g.trigger("SysGridHeightChanged")}}else{if(src.groupbtn){var grouprow=$(src.grouprow);var opening=true;if($(src.groupbtn).hasClass("l-grid-group-togglebtn-close")){$(src.groupbtn).removeClass("l-grid-group-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width("auto")}}else{opening=false;$(src.groupbtn).addClass("l-grid-group-togglebtn-close");if(grouprow.hasClass("l-grid-grouprow-last")){$("td:first",grouprow).width(g.gridtablewidth)}}var currentRow=grouprow.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");while(true){if(currentRow.length==0){break}if(opening){currentRow.show();if(currentRow.hasClass("l-grid-detailpanel")&&!currentRow.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")){currentRow.hide()}}else{currentRow.hide()}currentRow=currentRow.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel")}g.trigger(opening?"groupExtend":"groupCollapse");g.trigger("SysGridHeightChanged")}else{if(src.treelink){g.toggle(src.data)}else{if(src.row&&g.enabledCheckbox()){var selectRowButtonOnly=p.selectRowButtonOnly?true:false;if(p.enabledEdit){selectRowButtonOnly=true}if(src.checkbox||!selectRowButtonOnly){var row=$(src.row);var uncheck=row.hasClass("l-selected");if(g.trigger("beforeCheckRow",[!uncheck,src.data,src.data.__id,src.row])==false){return false}var met=uncheck?"unselect":"select";g[met](src.data);if(p.tree&&p.autoCheckChildren){var children=g.getChildren(src.data,true);for(var i=0,l=children.length;i<l;i++){g[met](children[i])}}g.trigger("checkRow",[!uncheck,src.data,src.data.__id,src.row])}if(!src.checkbox&&src.cell&&p.enabledEdit&&p.clickToEdit){g._applyEditor(src.cell)}}else{if(src.row&&!g.enabledCheckbox()){if(src.cell&&p.enabledEdit&&p.clickToEdit){g._applyEditor(src.cell)}if($(src.row).hasClass("l-selected")){if(!p.allowUnSelectRow){$(src.row).addClass("l-selected-again");return}g.unselect(src.data)}else{g.select(src.data)}}else{if(src.toolbar){if(src.first){if(g.trigger("toFirst",[g.element])==false){return false}g.changePage("first")}else{if(src.prev){if(g.trigger("toPrev",[g.element])==false){return false}g.changePage("prev")}else{if(src.next){if(g.trigger("toNext",[g.element])==false){return false}g.changePage("next")}else{if(src.last){if(g.trigger("toLast",[g.element])==false){return false}g.changePage("last")}else{if(src.load){if($("span",src.load).hasClass("l-disabled")){return false}if(g.trigger("reload",[g.element])==false){return false}if(p.url&&g.isDataChanged&&!confirm(p.isContinueByDataChanged)){return false}g.loadData(p.where)}}}}}}}}}}}}}},select:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var rowid=rowdata.__id;var rowobj=g.getRowObj(rowid);var rowobj1=g.getRowObj(rowid,true);if(!g.enabledCheckbox()&&!g.ctrlKey){for(var i in g.selected){var o=g.selected[i];if(o.__id in g.records){$(g.getRowObj(o)).removeClass("l-selected l-selected-again");if(g.enabledFrozen()){$(g.getRowObj(o,true)).removeClass("l-selected l-selected-again")}}}g.selected=[]}if(rowobj){$(rowobj).addClass("l-selected")}if(rowobj1){$(rowobj1).addClass("l-selected")}g.selected[g.selected.length]=rowdata;g.trigger("selectRow",[rowdata,rowid,rowobj])},unselect:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);var rowid=rowdata.__id;var rowobj=g.getRowObj(rowid);var rowobj1=g.getRowObj(rowid,true);$(rowobj).removeClass("l-selected l-selected-again");if(g.enabledFrozen()){$(rowobj1).removeClass("l-selected l-selected-again")}g._removeSelected(rowdata);g.trigger("unSelectRow",[rowdata,rowid,rowobj])},isSelected:function(rowParm){var g=this,p=this.options;var rowdata=g.getRow(rowParm);for(var i in g.selected){if(g.selected[i]==rowdata){return true}}return false},arrayToTree:function(data,id,pid){var g=this,p=this.options;var childrenName="children";if(p.tree){childrenName=p.tree.childrenName}if(!data||!data.length){return[]}var targetData=[];var records={};var itemLength=data.length;for(var i=0;i<itemLength;i++){var o=data[i];var key=getKey(o[id]);records[key]=o}for(var i=0;i<itemLength;i++){var currentData=data[i];var key=getKey(currentData[pid]);var parentData=records[key];if(!parentData){targetData.push(currentData);continue}parentData[childrenName]=parentData[childrenName]||[];parentData[childrenName].push(currentData)}return targetData;function getKey(key){if(typeof(key)=="string"){key=key.replace(/[.]/g,"").toLowerCase()}return key}},_onResize:function(){var g=this,p=this.options;if(p.height&&p.height!="auto"){var windowHeight=$(window).height();var h=0;var parentHeight=null;if(typeof(p.height)=="string"&&p.height.indexOf("%")>0){var gridparent=g.grid.parent();if(p.inWindow){parentHeight=windowHeight;parentHeight-=parseInt($("body").css("paddingTop"));parentHeight-=parseInt($("body").css("paddingBottom"))}else{parentHeight=gridparent.height()}h=parentHeight*parseInt(p.height)*0.01;if(p.inWindow||gridparent[0].tagName.toLowerCase()=="body"){h-=(g.grid.offset().top-parseInt($("body").css("paddingTop")))}}else{h=parseInt(p.height)}h+=p.heightDiff;g.windowHeight=windowHeight;g._setHeight(h)}else{g._updateHorizontalScrollStatus.ligerDefer(g,10)}if(g.enabledFrozen()){var gridView1Width=g.gridview1.width();var gridViewWidth=g.gridview.width();g.gridview2.css({width:gridViewWidth-gridView1Width})}g.trigger("SysGridHeightChanged")}});$.ligerui.controls.Grid.prototype.enabledTotal=$.ligerui.controls.Grid.prototype.isTotalSummary;$.ligerui.controls.Grid.prototype.add=$.ligerui.controls.Grid.prototype.addRow;$.ligerui.controls.Grid.prototype.update=$.ligerui.controls.Grid.prototype.updateRow;$.ligerui.controls.Grid.prototype.append=$.ligerui.controls.Grid.prototype.appendRow;$.ligerui.controls.Grid.prototype.getSelected=$.ligerui.controls.Grid.prototype.getSelectedRow;$.ligerui.controls.Grid.prototype.getSelecteds=$.ligerui.controls.Grid.prototype.getSelectedRows;$.ligerui.controls.Grid.prototype.getCheckedRows=$.ligerui.controls.Grid.prototype.getSelectedRows;$.ligerui.controls.Grid.prototype.getCheckedRowObjs=$.ligerui.controls.Grid.prototype.getSelectedRowObjs;$.ligerui.controls.Grid.prototype.setOptions=$.ligerui.controls.Grid.prototype.set;$.ligerui.controls.Grid.prototype.reload=$.ligerui.controls.Grid.prototype.loadData;$.ligerui.controls.Grid.prototype.refreshSize=$.ligerui.controls.Grid.prototype._onResize;function removeArrItem(arr,filterFn){for(var i=arr.length-1;i>=0;i--){if(filterFn(arr[i])){arr.splice(i,1)}}}})(jQuery);(function(a){a.fn.ligerLayout=function(b){return a.ligerui.run.call(this,"ligerLayout",arguments)};a.fn.ligerGetLayoutManager=function(){return a.ligerui.run.call(this,"ligerGetLayoutManager",arguments)};a.ligerDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,InWindow:true,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:false,isRightCollapse:false,allowLeftCollapse:true,allowRightCollapse:true,allowLeftResize:true,allowRightResize:true,allowTopResize:true,allowBottomResize:true,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80};a.ligerMethos.Layout={};a.ligerui.controls.Layout=function(c,b){a.ligerui.controls.Layout.base.constructor.call(this,c,b)};a.ligerui.controls.Layout.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return a.ligerMethos.Layout},_render:function(){var e=this,h=this.options;e.layout=a(this.element);e.layout.addClass("l-layout");e.width=e.layout.width();if(a("> div[position=top]",e.layout).length>0){e.top=a("> div[position=top]",e.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent();e.top.content=a("> div[position=top]",e.top);if(!e.top.content.hasClass("l-layout-content")){e.top.content.addClass("l-layout-content")}e.topHeight=h.topHeight;if(e.topHeight){e.top.height(e.topHeight)}}if(a("> div[position=bottom]",e.layout).length>0){e.bottom=a("> div[position=bottom]",e.layout).wrap('<div class="l-layout-bottom"></div>').parent();e.bottom.content=a("> div[position=bottom]",e.bottom);if(!e.bottom.content.hasClass("l-layout-content")){e.bottom.content.addClass("l-layout-content")}e.bottomHeight=h.bottomHeight;if(e.bottomHeight){e.bottom.height(e.bottomHeight)}var c=e.bottom.content.attr("title");if(c){e.bottom.header=a('<div class="l-layout-header"></div>');e.bottom.prepend(e.bottom.header);e.bottom.header.html(c);e.bottom.content.attr("title","")}}if(a("> div[position=left]",e.layout).length>0){e.left=a("> div[position=left]",e.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent();e.left.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');e.left.prepend(e.left.header);e.left.header.toggle=a(".l-layout-header-toggle",e.left.header);e.left.content=a("> div[position=left]",e.left);if(!e.left.content.hasClass("l-layout-content")){e.left.content.addClass("l-layout-content")}if(!h.allowLeftCollapse){a(".l-layout-header-toggle",e.left.header).remove()}var d=e.left.content.attr("title");if(d){e.left.content.attr("title","");a(".l-layout-header-inner",e.left.header).html(d)}e.leftWidth=h.leftWidth;if(e.leftWidth){e.left.width(e.leftWidth)}}if(a("> div[position=center]",e.layout).length>0){e.center=a("> div[position=center]",e.layout).wrap('<div class="l-layout-center" ></div>').parent();e.center.content=a("> div[position=center]",e.center);e.center.content.addClass("l-layout-content");var b=e.center.content.attr("title");if(b){e.center.content.attr("title","");e.center.header=a('<div class="l-layout-header"></div>');e.center.prepend(e.center.header);e.center.header.html(b)}e.centerWidth=h.centerWidth;if(e.centerWidth){e.center.width(e.centerWidth)}}if(a("> div[position=right]",e.layout).length>0){e.right=a("> div[position=right]",e.layout).wrap('<div class="l-layout-right"></div>').parent();e.right.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>');e.right.prepend(e.right.header);e.right.header.toggle=a(".l-layout-header-toggle",e.right.header);if(!h.allowRightCollapse){a(".l-layout-header-toggle",e.right.header).remove()}e.right.content=a("> div[position=right]",e.right);if(!e.right.content.hasClass("l-layout-content")){e.right.content.addClass("l-layout-content")}var f=e.right.content.attr("title");if(f){e.right.content.attr("title","");a(".l-layout-header-inner",e.right.header).html(f)}e.rightWidth=h.rightWidth;if(e.rightWidth){e.right.width(e.rightWidth)}}e.layout.lock=a("<div class='l-layout-lock'></div>");e.layout.append(e.layout.lock);e._addDropHandle();e.isLeftCollapse=h.isLeftCollapse;e.isRightCollapse=h.isRightCollapse;e.leftCollapse=a('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>');e.rightCollapse=a('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>');e.layout.append(e.leftCollapse).append(e.rightCollapse);e.leftCollapse.toggle=a("> .l-layout-collapse-left-toggle",e.leftCollapse);e.rightCollapse.toggle=a("> .l-layout-collapse-right-toggle",e.rightCollapse);e._setCollapse();e._bulid();a(window).resize(function(){e._onResize()});e.set(h);e.mask.height(e.layout.height())},setLeftCollapse:function(c){var b=this,d=this.options;if(!b.left){return false}b.isLeftCollapse=c;if(b.isLeftCollapse){b.leftCollapse.show();b.leftDropHandle&&b.leftDropHandle.hide();b.left.hide()}else{b.leftCollapse.hide();b.leftDropHandle&&b.leftDropHandle.show();b.left.show()}b._onResize()},setRightCollapse:function(c){var b=this,d=this.options;if(!b.right){return false}b.isRightCollapse=c;b._onResize();if(b.isRightCollapse){b.rightCollapse.show();b.rightDropHandle&&b.rightDropHandle.hide();b.right.hide()}else{b.rightCollapse.hide();b.rightDropHandle&&b.rightDropHandle.show();b.right.show()}b._onResize()},_bulid:function(){var b=this,c=this.options;a("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",b.layout).hover(function(){a(this).addClass("l-layout-header-over")},function(){a(this).removeClass("l-layout-header-over")});a(".l-layout-header-toggle",b.layout).hover(function(){a(this).addClass("l-layout-header-toggle-over")},function(){a(this).removeClass("l-layout-header-toggle-over")});a(".l-layout-header-toggle",b.left).click(function(){b.setLeftCollapse(true)});a(".l-layout-header-toggle",b.right).click(function(){b.setRightCollapse(true)});b.middleTop=0;if(b.top){b.middleTop+=b.top.height();b.middleTop+=parseInt(b.top.css("borderTopWidth"));b.middleTop+=parseInt(b.top.css("borderBottomWidth"));b.middleTop+=c.space}if(b.left){b.left.css({top:b.middleTop});b.leftCollapse.css({top:b.middleTop})}if(b.center){b.center.css({top:b.middleTop})}if(b.right){b.right.css({top:b.middleTop});b.rightCollapse.css({top:b.middleTop})}if(b.left){b.left.css({left:0})}b._onResize();b._onResize()},_setCollapse:function(){var b=this,c=this.options;b.leftCollapse.hover(function(){a(this).addClass("l-layout-collapse-left-over")},function(){a(this).removeClass("l-layout-collapse-left-over")});b.leftCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-left-toggle-over")},function(){a(this).removeClass("l-layout-collapse-left-toggle-over")});b.rightCollapse.hover(function(){a(this).addClass("l-layout-collapse-right-over")},function(){a(this).removeClass("l-layout-collapse-right-over")});b.rightCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-right-toggle-over")},function(){a(this).removeClass("l-layout-collapse-right-toggle-over")});b.leftCollapse.toggle.click(function(){b.setLeftCollapse(false)});b.rightCollapse.toggle.click(function(){b.setRightCollapse(false)});if(b.left&&b.isLeftCollapse){b.leftCollapse.show();b.leftDropHandle&&b.leftDropHandle.hide();b.left.hide()}if(b.right&&b.isRightCollapse){b.rightCollapse.show();b.rightDropHandle&&b.rightDropHandle.hide();b.right.hide()}},_addDropHandle:function(){var b=this,c=this.options;if(b.left&&c.allowLeftResize){b.leftDropHandle=a("<div class='l-layout-drophandle-left'></div>");b.layout.append(b.leftDropHandle);b.leftDropHandle&&b.leftDropHandle.show();b.leftDropHandle.mousedown(function(d){b._start("leftresize",d)})}if(b.right&&c.allowRightResize){b.rightDropHandle=a("<div class='l-layout-drophandle-right'></div>");b.layout.append(b.rightDropHandle);b.rightDropHandle&&b.rightDropHandle.show();b.rightDropHandle.mousedown(function(d){b._start("rightresize",d)})}if(b.top&&c.allowTopResize){b.topDropHandle=a("<div class='l-layout-drophandle-top'></div>");b.layout.append(b.topDropHandle);b.topDropHandle.show();b.topDropHandle.mousedown(function(d){b._start("topresize",d)})}if(b.bottom&&c.allowBottomResize){b.bottomDropHandle=a("<div class='l-layout-drophandle-bottom'></div>");b.layout.append(b.bottomDropHandle);b.bottomDropHandle.show();b.bottomDropHandle.mousedown(function(d){b._start("bottomresize",d)})}b.draggingxline=a("<div class='l-layout-dragging-xline'></div>");b.draggingyline=a("<div class='l-layout-dragging-yline'></div>");b.mask=a("<div class='l-dragging-mask'></div>");b.layout.append(b.draggingxline).append(b.draggingyline).append(b.mask)},_setDropHandlePosition:function(){var b=this,c=this.options;if(b.leftDropHandle){b.leftDropHandle.css({left:b.left.width()+parseInt(b.left.css("left")),height:b.middleHeight,top:b.middleTop})}if(b.rightDropHandle){b.rightDropHandle.css({left:parseInt(b.right.css("left"))-c.space,height:b.middleHeight,top:b.middleTop})}if(b.topDropHandle){b.topDropHandle.css({top:b.top.height()+parseInt(b.top.css("top")),width:b.top.width()})}if(b.bottomDropHandle){b.bottomDropHandle.css({top:parseInt(b.bottom.css("top"))-c.space,width:b.bottom.width()})}},_onResize:function(){var j=this,k=this.options;var b=j.layout.height();var e=0;var m=a(window).height();var d=null;if(typeof(k.height)=="string"&&k.height.indexOf("%")>0){var c=j.layout.parent();if(k.InWindow||c[0].tagName.toLowerCase()=="body"){d=m;d-=parseInt(a("body").css("paddingTop"));d-=parseInt(a("body").css("paddingBottom"))}else{d=c.height()}e=d*parseFloat(k.height)*0.01;if(k.InWindow||c[0].tagName.toLowerCase()=="body"){e-=(j.layout.offset().top-parseInt(a("body").css("paddingTop")))}}else{e=parseInt(k.height)}e+=k.heightDiff;j.layout.height(e);j.layoutHeight=j.layout.height();j.middleWidth=j.layout.width();j.middleHeight=j.layout.height();if(j.top){j.middleHeight-=j.top.height();j.middleHeight-=parseInt(j.top.css("borderTopWidth"));j.middleHeight-=parseInt(j.top.css("borderBottomWidth"));j.middleHeight-=k.space}if(j.bottom){j.middleHeight-=j.bottom.height();j.middleHeight-=parseInt(j.bottom.css("borderTopWidth"));j.middleHeight-=parseInt(j.bottom.css("borderBottomWidth"));j.middleHeight-=k.space}j.middleHeight-=2;if(j.hasBind("heightChanged")&&j.layoutHeight!=b){j.trigger("heightChanged",[{layoutHeight:j.layoutHeight,diff:j.layoutHeight-b,middleHeight:j.middleHeight}])}if(j.center){j.centerWidth=j.middleWidth;if(j.left){if(j.isLeftCollapse){j.centerWidth-=j.leftCollapse.width();j.centerWidth-=parseInt(j.leftCollapse.css("borderLeftWidth"));j.centerWidth-=parseInt(j.leftCollapse.css("borderRightWidth"));j.centerWidth-=parseInt(j.leftCollapse.css("left"));j.centerWidth-=k.space}else{j.centerWidth-=j.leftWidth;j.centerWidth-=parseInt(j.left.css("borderLeftWidth"));j.centerWidth-=parseInt(j.left.css("borderRightWidth"));j.centerWidth-=parseInt(j.left.css("left"));j.centerWidth-=k.space}}if(j.right){if(j.isRightCollapse){j.centerWidth-=j.rightCollapse.width();j.centerWidth-=parseInt(j.rightCollapse.css("borderLeftWidth"));j.centerWidth-=parseInt(j.rightCollapse.css("borderRightWidth"));j.centerWidth-=parseInt(j.rightCollapse.css("right"));j.centerWidth-=k.space}else{j.centerWidth-=j.rightWidth;j.centerWidth-=parseInt(j.right.css("borderLeftWidth"));j.centerWidth-=parseInt(j.right.css("borderRightWidth"));j.centerWidth-=k.space}}j.centerLeft=0;if(j.left){if(j.isLeftCollapse){j.centerLeft+=j.leftCollapse.width();j.centerLeft+=parseInt(j.leftCollapse.css("borderLeftWidth"));j.centerLeft+=parseInt(j.leftCollapse.css("borderRightWidth"));j.centerLeft+=parseInt(j.leftCollapse.css("left"));j.centerLeft+=k.space}else{j.centerLeft+=j.left.width();j.centerLeft+=parseInt(j.left.css("borderLeftWidth"));j.centerLeft+=parseInt(j.left.css("borderRightWidth"));j.centerLeft+=k.space}}j.center.css({left:j.centerLeft});j.center.width(j.centerWidth);j.center.height(j.middleHeight);var f=j.middleHeight;if(j.center.header){f-=j.center.header.height()}j.center.content.height(f)}if(j.left){j.leftCollapse.height(j.middleHeight);j.left.height(j.middleHeight)}if(j.right){j.rightCollapse.height(j.middleHeight);j.right.height(j.middleHeight);j.rightLeft=0;if(j.left){if(j.isLeftCollapse){j.rightLeft+=j.leftCollapse.width();j.rightLeft+=parseInt(j.leftCollapse.css("borderLeftWidth"));j.rightLeft+=parseInt(j.leftCollapse.css("borderRightWidth"));j.rightLeft+=k.space}else{j.rightLeft+=j.left.width();j.rightLeft+=parseInt(j.left.css("borderLeftWidth"));j.rightLeft+=parseInt(j.left.css("borderRightWidth"));j.rightLeft+=parseInt(j.left.css("left"));j.rightLeft+=k.space}}if(j.center){j.rightLeft+=j.center.width();j.rightLeft+=parseInt(j.center.css("borderLeftWidth"));j.rightLeft+=parseInt(j.center.css("borderRightWidth"));j.rightLeft+=k.space}j.right.css({left:j.rightLeft})}if(j.bottom){j.bottomTop=j.layoutHeight-j.bottom.height()-2;j.bottom.css({top:j.bottomTop})}j._setDropHandlePosition()},_start:function(f,d){var b=this,c=this.options;b.dragtype=f;if(f=="leftresize"||f=="rightresize"){b.xresize={startX:d.pageX};b.draggingyline.css({left:d.pageX-b.layout.offset().left,height:b.middleHeight,top:b.middleTop}).show();a("body").css("cursor","col-resize");b.mask.height(b.layout.height()).removeClass("l-layout-ymask").addClass("l-layout-xmask").show()}else{if(f=="topresize"||f=="bottomresize"){b.yresize={startY:d.pageY};b.draggingxline.css({top:d.pageY-b.layout.offset().top,width:b.layout.width()}).show();a("body").css("cursor","row-resize");b.mask.height(b.layout.height()).removeClass("l-layout-xmask").addClass("l-layout-ymask").show()}else{return}}b.layout.lock.width(b.layout.width());b.layout.lock.height(b.layout.height());b.layout.lock.show();if(a.browser.msie||a.browser.safari){a("body").bind("selectstart",function(){return false})}a(document).bind("mouseup",function(){b._stop.apply(b,arguments)});a(document).bind("mousemove",function(){b._drag.apply(b,arguments)})},_drag:function(d){var b=this,c=this.options;if(b.xresize){b.xresize.diff=d.pageX-b.xresize.startX;b.draggingyline.css({left:d.pageX-b.layout.offset().left});a("body").css("cursor","col-resize")}else{if(b.yresize){b.yresize.diff=d.pageY-b.yresize.startY;b.draggingxline.css({top:d.pageY-b.layout.offset().top});a("body").css("cursor","row-resize")}}},_stop:function(f){var b=this,d=this.options;var c;if(b.xresize&&b.xresize.diff!=undefined){c=b.xresize.diff;if(b.dragtype=="leftresize"){if(d.minLeftWidth){if(b.leftWidth+b.xresize.diff<d.minLeftWidth){return}}b.leftWidth+=b.xresize.diff;b.left.width(b.leftWidth);if(b.center){b.center.width(b.center.width()-b.xresize.diff).css({left:parseInt(b.center.css("left"))+b.xresize.diff})}else{if(b.right){b.right.width(b.left.width()-b.xresize.diff).css({left:parseInt(b.right.css("left"))+b.xresize.diff})}}}else{if(b.dragtype=="rightresize"){if(d.minRightWidth){if(b.rightWidth-b.xresize.diff<d.minRightWidth){return}}b.rightWidth-=b.xresize.diff;b.right.width(b.rightWidth).css({left:parseInt(b.right.css("left"))+b.xresize.diff});if(b.center){b.center.width(b.center.width()+b.xresize.diff)}else{if(b.left){b.left.width(b.left.width()+b.xresize.diff)}}}}}else{if(b.yresize&&b.yresize.diff!=undefined){c=b.yresize.diff;if(b.dragtype=="topresize"){b.top.height(b.top.height()+b.yresize.diff);b.middleTop+=b.yresize.diff;b.middleHeight-=b.yresize.diff;if(b.left){b.left.css({top:b.middleTop}).height(b.middleHeight);b.leftCollapse.css({top:b.middleTop}).height(b.middleHeight)}if(b.center){b.center.css({top:b.middleTop}).height(b.middleHeight)}if(b.right){b.right.css({top:b.middleTop}).height(b.middleHeight);b.rightCollapse.css({top:b.middleTop}).height(b.middleHeight)}}else{if(b.dragtype=="bottomresize"){b.bottom.height(b.bottom.height()-b.yresize.diff);b.middleHeight+=b.yresize.diff;b.bottomTop+=b.yresize.diff;b.bottom.css({top:b.bottomTop});if(b.left){b.left.height(b.middleHeight);b.leftCollapse.height(b.middleHeight)}if(b.center){b.center.height(b.middleHeight)}if(b.right){b.right.height(b.middleHeight);b.rightCollapse.height(b.middleHeight)}}}}}b.trigger("endResize",[{direction:b.dragtype?b.dragtype.replace(/resize/,""):"",diff:c},f]);b._setDropHandlePosition();b.draggingxline.hide();b.draggingyline.hide();b.mask.hide();b.xresize=b.yresize=b.dragtype=false;b.layout.lock.hide();if(a.browser.msie||a.browser.safari){a("body").unbind("selectstart")}a(document).unbind("mousemove",b._drag);a(document).unbind("mouseup",b._stop);a("body").css("cursor","")}})})(jQuery);(function(a){a.fn.ligerListBox=function(b){return a.ligerui.run.call(this,"ligerListBox",arguments)};a.ligerDefaults.ListBox={isMultiSelect:false,isShowCheckBox:false,columns:null,width:150,height:100,onSelect:false,onSelected:null,valueField:"id",textField:"text",valueFieldID:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,render:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.ListBox=a.ligerMethos.ListBox||{};a.ligerui.controls.ListBox=function(c,b){a.ligerui.controls.ListBox.base.constructor.call(this,c,b)};a.ligerui.controls.ListBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"ListBox"},_extendMethods:function(){return a.ligerMethos.ListBox},_init:function(){a.ligerui.controls.ListBox.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null){b.valueField[0].name=b.valueField[0].id}if(c.valueFieldCssClass){b.valueField.addClass(c.valueFieldCssClass)}b.valueField.attr("data-ligerid",b.id);b.selectBox=a(this.element);b.selectBox.html('<div class="l-listbox-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-listbox-table"></table></div>').addClass("l-listbox").append(b.valueField);b.selectBox.table=a("table:first",b.selectBox);b.set(c);b._addClickEven()},destroy:function(){if(this.selectBox){this.selectBox.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setIsShowCheckBox:function(b){if(b){a("table",this.selectBox).addClass("l-table-checkbox")}else{a("table",this.selectBox).addClass("l-table-nocheckbox")}},_setCss:function(b){if(b){this.selectBox.addClass(b)}},_setDisabled:function(b){if(b){this.selectBox.addClass("l-text-disabled")}else{this.selectBox.removeClass("l-text-disabled")}},_setWidth:function(b){this.selectBox.width(b)},_setHeight:function(b){this.selectBox.height(b)},findTextByValue:function(e){var b=this,f=this.options;if(e==null){return""}var d="";var c=function(j){var g=e.toString().split(f.split);for(var h=0;h<g.length;h++){if(g[h]==j){return true}}return false};a(b.data).each(function(h,j){var k=j[f.valueField];var g=j[f.textField];if(c(k)){d+=g+f.split}});if(d.length>0){d=d.substr(0,d.length-1)}return d},getDataByValue:function(e){var d=this,f=this.options;for(var c=0,b=d.data.length;c<b;c++){if(d.data[c][f.valueField]==e){return d.data[c]}}return null},indexOf:function(f){var e=this,h=this.options;if(!e.data){return -1}var c=typeof(f)=="object";for(var d=0,b=e.data.length;d<b;d++){if(c){if(e.data[d]==f){return d}}else{if(e.data[d][h.valueField]&&e.data[d][h.valueField].toString()==f.toString()){return d}}}return -1},removeItems:function(b){var c=this;if(!c.data){return}a(b).each(function(e,f){var d=c.indexOf(f);if(d==-1){return}c.data.splice(d,1)});c.refresh()},removeItem:function(c){if(!this.data){return}var b=this.indexOf(c);if(b==-1){return}this.data.splice(b,1);this.refresh()},insertItem:function(d,b){var c=this;if(!c.data){c.data=[]}c.data.splice(b,0,d);c.refresh()},addItems:function(b){var c=this;if(!c.data){c.data=[]}a(b).each(function(d,e){c.data.push(e)});c.refresh()},addItem:function(c){var b=this;if(!b.data){b.data=[]}b.data.push(c);b.refresh()},getSelectedItems:function(){var c=this,e=this.options;if(!c.data){return null}var d=c.getValue();if(!d){return null}var b=[];a(d.split(e.split)).each(function(){var f=c.indexOf(this.toString());if(f!=-1){b.push(c.data[f])}});return b},_setValue:function(c){var b=this,d=this.options;d.value=c;this._dataInit()},setValue:function(b){this._setValue(b)},_setUrl:function(b){if(!b){return}var c=this,d=this.options;a.ajax({type:"post",url:b,data:d.parms,cache:false,dataType:"json",success:function(e){c.setData(e);c.trigger("success",[e])},error:function(e,f){c.trigger("error",[e,f])}})},setUrl:function(b){return this._setUrl(b)},setParm:function(b,e){if(!b){return}var d=this;var c=d.get("parms");if(!c){c={}}c[b]=e;d.set("parms",c)},clearContent:function(){var b=this,c=this.options;a("table",b.selectBox).html("")},_setColumns:function(b){var c=this,d=this.options;d.columns=b;c.refresh()},_setData:function(b){this.setData(b)},setData:function(c){var b=this,d=this.options;if(!c||!c.length){return}b.data=c;b.refresh();b.updateStyle()},refresh:function(){var o=this,b=this.options,m=this.data;this.clearContent();if(!m){return}if(b.columns){o.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px' class='l-checkboxrow'></td></tr>");o.selectBox.table.append(o.selectBox.table.headrow);o.selectBox.table.addClass("l-listbox-grid");for(var e=0;e<b.columns.length;e++){var r=a("<td columnindex='"+e+"' columnname='"+b.columns[e].name+"'>"+b.columns[e].header+"</td>");if(b.columns[e].width){r.width(b.columns[e].width)}o.selectBox.table.headrow.append(r)}}var f=[];for(var n=0;n<m.length;n++){var c=m[n][b.valueField];var k=m[n][b.textField];var h=" value='"+c+"' index='"+n+"'";if(!b.columns){f.push("<tr "+h+">");f.push("<td style='width:18px;' class='l-checkboxrow'><input type='checkbox'"+h+"/></td>");var d=k;if(b.render){d=b.render({data:m[n],value:c,text:k})}f.push("<td align='left'>"+d+"</td></tr>")}else{f.push("<tr "+h+"><td style='width:18px;' class='l-checkboxrow'><input type='checkbox' "+h+"/></td>");for(var e=0;e<b.columns.length;e++){var q=b.columns[e].name;f.push("<td>"+m[n][q]+"</td>")}f.push("</tr>")}}o.selectBox.table.append(f.join(""))},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},selectAll:function(){var c=this,d=this.options;var b=[];a("tr",c.selectBox).each(function(){var e=a(this);b.push(e.attr("value"))});a("tr",c.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=true});c.valueField.val(b.join(d.split))},_dataInit:function(){var c=this,e=this.options;var d=e.value;if(d!=null){c._changeValue(d)}else{if(c.valueField.val()!=""){e.value=c.valueField.val()}}var b=(d||"").toString().split(e.split);a("tr.l-selected",c.selectBox).removeClass("l-selected").find(":checkbox").each(function(){this.checked=false});a(b).each(function(f,g){a("tr[value='"+g+"']",c.selectBox).addClass("l-selected").find(":checkbox").each(function(){this.checked=true})})},_changeValue:function(d){var b=this,c=this.options;b.valueField.val(d);b.selectedValue=d},_updateValue:function(){var c=this,d=this.options;var b=[];a("tr",c.selectBox).each(function(){var e=a(this);if(e.hasClass("l-selected")){b.push(e.attr("value"))}});c._changeValue(b.join(d.split))},_addClickEven:function(){var b=this,c=this.options;b.selectBox.click(function(h){var g=(h.target||h.srcElement);var k=a(g).parents("tr:first");if(!k.length){return}var f=k.attr("value");var j=b.findTextByValue(f),d=b.getDataByValue(f);if(b.hasBind("select")){if(b.trigger("select",[f,j,d])==false){return false}}if(!c.isMultiSelect){a("tr.l-selected",b.selectBox).not(k).removeClass("l-selected").find(":checkbox").each(function(){this.checked=false})}if(k.hasClass("l-selected")){k.removeClass("l-selected")}else{k.addClass("l-selected")}k.find(":checkbox").each(function(){this.checked=k.hasClass("l-selected")});b._updateValue();b.trigger("selected",[f,j,d])})}})})(jQuery);(function(a){a.ligerMenu=function(b){return a.ligerui.run.call(null,"ligerMenu",arguments)};a.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:true};a.ligerMethos.Menu={};a.ligerui.controls.Menu=function(b){a.ligerui.controls.Menu.base.constructor.call(this,null,b)};a.ligerui.controls.Menu.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return a.ligerMethos.Menu},_render:function(){var b=this,c=this.options;b.menuItemCount=0;b.menus={};b.menu=b.createMenu();b.element=b.menu[0];b.menu.css({top:c.top,left:c.left,width:c.width});c.items&&a(c.items).each(function(d,e){b.addItem(e)});a(document).bind("click.menu",function(){for(var d in b.menus){var e=b.menus[d];if(!e){return}e.hide();if(e.shadow){e.shadow.hide()}}});b.set(c)},show:function(b,e){var c=this,d=this.options;if(e==undefined){e=c.menu}if(b&&b.left!=undefined){e.css({left:b.left})}if(b&&b.top!=undefined){e.css({top:b.top})}e.show();c.updateShadow(e)},updateShadow:function(d){var b=this,c=this.options;if(!c.shadow){return}d.shadow.css({left:d.css("left"),top:d.css("top"),width:d.outerWidth(),height:d.outerHeight()});if(d.is(":visible")){d.shadow.show()}else{d.shadow.hide()}},hide:function(d){var b=this,c=this.options;if(d==undefined){d=b.menu}b.hideAllSubMenu(d);d.hide();b.updateShadow(d)},toggle:function(){var b=this,c=this.options;b.menu.toggle();b.updateShadow(b.menu)},removeItem:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).remove()},setEnabled:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).removeClass("l-menu-item-disable")},setDisabled:function(c){var b=this,d=this.options;a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).addClass("l-menu-item-disable")},isEnable:function(c){var b=this,d=this.options;return !a("> .l-menu-item[menuitemid="+c+"]",b.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var b=this,c=this.options;return a("> .l-menu-item",b.menu.items).length},addItem:function(e,h){var d=this,f=this.options;if(!e){return}if(h==undefined){h=d.menu}if(e.line){h.items.append('<div class="l-menu-item-line"></div>');return}var b=a('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>');var c=a("> .l-menu-item",h.items).length;h.items.append(b);b.attr("ligeruimenutemid",++d.menuItemCount);e.id&&b.attr("menuitemid",e.id);e.text&&a(">.l-menu-item-text:first",b).html(e.text);e.icon&&b.prepend('<div class="l-menu-item-icon l-icon-'+e.icon+'"></div>');e.img&&b.prepend('<div class="l-menu-item-icon"><img style="width:16px;height:16px;margin:2px;" src="'+e.img+'" /></div>');if(e.disable||e.disabled){b.addClass("l-menu-item-disable")}if(e.children){b.append('<div class="l-menu-item-arrow"></div>');var k=d.createMenu(b.attr("ligeruimenutemid"));d.menus[b.attr("ligeruimenutemid")]=k;k.width(f.width);k.hover(null,function(){if(!k.showedSubMenu){d.hide(k)}});a(e.children).each(function(){d.addItem(this,k)})}e.click&&b.click(function(){if(a(this).hasClass("l-menu-item-disable")){return}e.click(e,c)});e.dblclick&&b.dblclick(function(){if(a(this).hasClass("l-menu-item-disable")){return}e.dblclick(e,c)});var j=a("> .l-menu-over:first",h);b.hover(function(){if(a(this).hasClass("l-menu-item-disable")){return}var m=a(this).offset().top;var n=m-h.offset().top;j.css({top:n});d.hideAllSubMenu(h);if(e.children){var g=a(this).attr("ligeruimenutemid");if(!g){return}if(d.menus[g]){d.show({top:m,left:a(this).offset().left+a(this).width()-5},d.menus[g]);h.showedSubMenu=true}}},function(){if(a(this).hasClass("l-menu-item-disable")){return}var g=a(this).attr("ligeruimenutemid");if(e.children){var g=a(this).attr("ligeruimenutemid");if(!g){return}}})},hideAllSubMenu:function(d){var b=this,c=this.options;if(d==undefined){d=b.menu}a("> .l-menu-item",d.items).each(function(){if(a("> .l-menu-item-arrow",this).length>0){var e=a(this).attr("ligeruimenutemid");if(!e){return}b.menus[e]&&b.hide(b.menus[e])}});d.showedSubMenu=false},createMenu:function(c){var b=this,d=this.options;var e=a('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');c&&e.attr("ligeruiparentmenuitemid",c);e.items=a("> .l-menu-inner:first",e);e.appendTo("body");if(d.shadow){e.shadow=a('<div class="l-menu-shadow"></div>').insertAfter(e);b.updateShadow(e)}e.hover(null,function(){if(!e.showedSubMenu){a("> .l-menu-over:first",e).css({top:-24})}});if(c){b.menus[c]=e}else{b.menus[0]=e}return e}});a.ligerui.controls.Menu.prototype.setEnable=a.ligerui.controls.Menu.prototype.setEnabled;a.ligerui.controls.Menu.prototype.setDisable=a.ligerui.controls.Menu.prototype.setDisabled})(jQuery);(function(a){a.fn.ligerMenuBar=function(b){return a.ligerui.run.call(this,"ligerMenuBar",arguments)};a.fn.ligerGetMenuBarManager=function(){return a.ligerui.run.call(this,"ligerGetMenuBarManager",arguments)};a.ligerDefaults.MenuBar={};a.ligerMethos.MenuBar={};a.ligerui.controls.MenuBar=function(c,b){a.ligerui.controls.MenuBar.base.constructor.call(this,c,b)};a.ligerui.controls.MenuBar.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return a.ligerMethos.MenuBar},_render:function(){var b=this,c=this.options;b.menubar=a(this.element);if(!b.menubar.hasClass("l-menubar")){b.menubar.addClass("l-menubar")}if(c&&c.items){a(c.items).each(function(d,e){b.addItem(e)})}a(document).click(function(){a(".l-panel-btn-selected",b.menubar).removeClass("l-panel-btn-selected")});b.set(c)},addItem:function(d){var c=this,e=this.options;var b=a('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>');c.menubar.append(b);d.id&&b.attr("menubarid",d.id);d.text&&a("span:first",b).html(d.text);d.disable&&b.addClass("l-menubar-item-disable");d.click&&b.click(function(){d.click(d)});if(d.menu){var f=a.ligerMenu(d.menu);b.hover(function(){c.actionMenu&&c.actionMenu.hide();var h=a(this).offset().left;var g=a(this).offset().top+a(this).height();f.show({top:g,left:h});c.actionMenu=f;a(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){a(this).removeClass("l-panel-btn-over")})}else{b.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")});a(".l-menubar-item-down",b).remove()}}})})(jQuery);(function(a){a.ligerMessageBox=function(b){return a.ligerui.run.call(null,"ligerMessageBox",arguments,{isStatic:true})};a.ligerDefaults.MessageBox={isDrag:true};a.ligerMethos.MessageBox={};a.ligerui.controls.MessageBox=function(b){a.ligerui.controls.MessageBox.base.constructor.call(this,null,b)};a.ligerui.controls.MessageBox.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return a.ligerMethos.MessageBox},_render:function(){var e=this,k=this.options;var f="";f+='<div class="l-messagebox">';f+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>';f+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ';f+='        <div class="l-messagebox-image"></div>';f+='        <div class="l-messagebox-title">';f+='            <div class="l-messagebox-title-inner"></div>';f+='            <div class="l-messagebox-close"></div>';f+="        </div>";f+='        <div class="l-messagebox-content">';f+="        </div>";f+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">';f+="        </div></div>";f+="    </div>";e.messageBox=a(f);a("body").append(e.messageBox);e.messageBox.close=function(){e._removeWindowMask();e.messageBox.remove()};k.width&&e.messageBox.width(k.width);k.title&&a(".l-messagebox-title-inner",e.messageBox).html(k.title);k.content&&a(".l-messagebox-content",e.messageBox).html(k.content);if(k.buttons){a(k.buttons).each(function(m,n){var g=a('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');a(".l-messagebox-btn-inner",g).html(n.text);a(".l-messagebox-buttons-inner",e.messageBox).append(g);n.width&&g.width(n.width);n.onclick&&g.click(function(){n.onclick(n,m,e.messageBox)})});a(".l-messagebox-buttons-inner",e.messageBox).append("<div class='l-clear'></div>")}var d=e.messageBox.width();var c=0;a(".l-messagebox-buttons-inner .l-messagebox-btn",e.messageBox).each(function(){c+=a(this).width()});a(".l-messagebox-buttons-inner",e.messageBox).css({marginLeft:parseInt((d-c)*0.5)});e._applyWindowMask();e._applyDrag();e._setImage();var j=0;var h=0;var b=k.width||e.messageBox.width();if(k.left!=null){j=k.left}else{k.left=j=0.5*(a(window).width()-b)}if(k.top!=null){h=k.top}else{k.top=h=0.5*(a(window).height()-e.messageBox.height())+a(window).scrollTop()-10}if(j<0){k.left=j=0}if(h<0){k.top=h=0}e.messageBox.css({left:j,top:h});a(".l-messagebox-btn",e.messageBox).hover(function(){a(this).addClass("l-messagebox-btn-over")},function(){a(this).removeClass("l-messagebox-btn-over")});a(".l-messagebox-close",e.messageBox).hover(function(){a(this).addClass("l-messagebox-close-over")},function(){a(this).removeClass("l-messagebox-close-over")}).click(function(){e.messageBox.close()});e.set(k)},close:function(){var b=this,c=this.options;this.g._removeWindowMask();this.messageBox.remove()},_applyWindowMask:function(){var b=this,c=this.options;a(".l-window-mask").remove();a("<div class='l-window-mask' style='display: block;'></div>").appendTo(a("body"))},_removeWindowMask:function(){var b=this,c=this.options;a(".l-window-mask").remove()},_applyDrag:function(){var b=this,c=this.options;if(c.isDrag&&a.fn.ligerDrag){b.messageBox.ligerDrag({handler:".l-messagebox-title-inner",animate:false})}},_setImage:function(){var b=this,c=this.options;if(c.type){if(c.type=="success"||c.type=="donne"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-donne").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(c.type=="error"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-error").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(c.type=="warn"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-warn").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})}else{if(c.type=="question"){a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-question").show();a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:40})}}}}}}});a.ligerMessageBox.show=function(b){return a.ligerMessageBox(b)};a.ligerMessageBox.alert=function(f,e,d,c){f=f||"";e=e||f;var b=function(h,g,j){j.close();if(c){c(h,g,j)}};p={title:f,content:e,buttons:[{text:"确定",onclick:b}]};if(d){p.type=d}return a.ligerMessageBox(p)};a.ligerMessageBox.confirm=function(d,c,e){var b=function(g,f,h){h.close();if(e){e(f==0)}};p={type:"question",title:d,content:c,buttons:[{text:"是",onclick:b},{text:"否",onclick:b}]};return a.ligerMessageBox(p)};a.ligerMessageBox.success=function(d,c,b){return a.ligerMessageBox.alert(d,c,"success",b)};a.ligerMessageBox.error=function(d,c,b){return a.ligerMessageBox.alert(d,c,"error",b)};a.ligerMessageBox.warn=function(d,c,b){return a.ligerMessageBox.alert(d,c,"warn",b)};a.ligerMessageBox.question=function(c,b){return a.ligerMessageBox.alert(c,b,"question")}})(jQuery);(function(a){a.fn.ligerPanel=function(b){return a.ligerui.run.call(this,"ligerPanel",arguments)};a.ligerDefaults.Panel={width:400,height:300,title:"Panel",content:null,url:null,frameName:null,data:null,showClose:false,showToggle:true,icon:null,onClose:null,onClosed:null,onLoaded:null};a.ligerMethos.Panel={};a.ligerui.controls.Panel=function(c,b){a.ligerui.controls.Panel.base.constructor.call(this,c,b)};a.ligerui.controls.Panel.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Panel"},__idPrev:function(){return"Panel"},_extendMethods:function(){return a.ligerMethos.Panel},_init:function(){var b=this,c=this.options;a.ligerui.controls.Panel.base._init.call(this);c.content=c.content||a(b.element).html()},_render:function(){var b=this,c=this.options;b.panel=a(b.element).addClass("l-panel").html("");b.panel.append('<div class="l-panel-header"><span></span><div class="icons"></div></div><div class="l-panel-content"></div>');b.set(c);b.panel.bind("click.panel",function(f){var d=(f.target||f.srcElement),g=a(d);if(g.hasClass("l-panel-header-toggle")){b.toggle()}else{if(g.hasClass("l-panel-header-close")){b.close()}}})},collapse:function(){var c=this,d=this.options;var b=c.panel.find(".l-panel-header .l-panel-header-toggle:first");if(b.hasClass("l-panel-header-toggle-hide")){return}c.toggle()},expand:function(){var c=this,d=this.options;var b=c.panel.find(".l-panel-header .l-panel-header-toggle:first");if(!b.hasClass("l-panel-header-toggle-hide")){return}c.toggle()},toggle:function(){var c=this,d=this.options;var b=c.panel.find(".l-panel-header .l-panel-header-toggle:first");if(b.hasClass("l-panel-header-toggle-hide")){b.removeClass("l-panel-header-toggle-hide")}else{b.addClass("l-panel-header-toggle-hide")}c.panel.find(".l-panel-content:first").toggle("normal")},_setShowToggle:function(c){var d=this,e=this.options;var f=d.panel.find(".l-panel-header:first");if(c){var b=a("<div class='l-panel-header-toggle'></div>");b.appendTo(f.find(".icons"))}else{f.find(".l-panel-header-toggle").remove()}},_setContent:function(b){var d=this,e=this.options;var c=d.panel.find(".l-panel-content:first");if(b){c.html(b)}},_setUrl:function(b){var e=this,f=this.options;var d=e.panel.find(".l-panel-content:first");if(b){e.jiframe=a("<iframe frameborder='0'></iframe>");var c=f.frameName?f.frameName:"ligerpanel"+new Date().getTime();e.jiframe.attr("name",c);e.jiframe.attr("id",c);d.prepend(e.jiframe);setTimeout(function(){if(d.find(".l-panel-loading:first").length==0){d.append("<div class='l-panel-loading' style='display:block;'></div>")}var g=a(".l-panel-loading:first",d);e.jiframe[0].panel=e;e.jiframe.attr("src",f.url).bind("load.panel",function(){g.hide();e.trigger("loaded")});e.frame=window.frames[e.jiframe.attr("name")]},0)}},_setShowClose:function(b){var d=this,e=this.options;var f=d.panel.find(".l-panel-header:first");if(b){var c=a("<div class='l-panel-header-close'></div>");c.appendTo(f.find(".icons"))}else{f.find(".l-panel-header-close").remove()}},close:function(){var b=this,c=this.options;if(b.trigger("close")==false){return}b.panel.remove();b.trigger("closed")},show:function(){this.panel.show()},_setIcon:function(b){var c=this;if(!b){c.panel.removeClass("l-panel-hasicon");c.panel.find("img").remove()}else{c.panel.addClass("l-panel-hasicon");c.panel.append('<img src="'+b+'" />')}},_setWidth:function(b){b&&this.panel.width(b)},_setHeight:function(c){var b=this,d=this.options;var e=b.panel.find(".l-panel-header:first");this.panel.find(".l-panel-content:first").height(c-e.height())},_setTitle:function(b){this.panel.find(".l-panel-header span:first").text(b)}})})(jQuery);(function(a){a.fn.ligerPopupEdit=function(b){return a.ligerui.run.call(this,"ligerPopupEdit",arguments)};a.fn.ligerGetPopupEditManager=function(){return a.ligerui.run.call(this,"ligerGetPopupEditManager",arguments)};a.ligerDefaults.PopupEdit={valueFieldID:null,css:null,onButtonClick:null,nullText:null,disabled:false,cancelable:true,width:200,heigth:null,render:null,split:";",grid:null,condition:null,valueField:"id",textField:"text",parms:null,onSelect:null,onSelected:null,valueFieldCssClass:null};a.ligerMethos.PopupEdit=a.ligerMethos.PopupEdit||{};a.ligerui.controls.PopupEdit=function(c,b){a.ligerui.controls.PopupEdit.base.constructor.call(this,c,b)};a.ligerui.controls.PopupEdit.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"PopupEdit"},_extendMethods:function(){return a.ligerMethos.PopupEdit},_init:function(){a.ligerui.controls.PopupEdit.base._init.call(this)},_render:function(){var b=this,c=this.options;b.inputText=null;if(this.element.tagName.toLowerCase()=="input"){this.element.readOnly=true;b.inputText=a(this.element);b.textFieldID=this.element.id}if(b.inputText[0].name==undefined){b.inputText[0].name=b.textFieldID}b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.textFieldID+"_val"}if(b.valueField[0].name==undefined){b.valueField[0].name=b.valueField[0].id}if(c.valueFieldCssClass){b.valueField.addClass(c.valueFieldCssClass)}b.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>');b.wrapper=b.inputText.wrap('<div class="l-text l-text-popup"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link);b.wrapper.append(b.valueField);b.inputText.addClass("l-text-field");b.link.hover(function(){if(c.disabled){return}this.className="l-trigger-hover"},function(){if(c.disabled){return}this.className="l-trigger"}).mousedown(function(){if(c.disabled){return}this.className="l-trigger-pressed"}).mouseup(function(){if(c.disabled){return}this.className="l-trigger-hover"}).click(function(){if(c.disabled){return}if(b.trigger("buttonClick")==false){return false}});b.inputText.click(function(){if(c.disabled){return}}).blur(function(){if(c.disabled){return}b.wrapper.removeClass("l-text-focus")}).focus(function(){if(c.disabled){return}b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(c.disabled){return}b.wrapper.addClass("l-text-over")},function(){if(c.disabled){return}b.wrapper.removeClass("l-text-over")});b.set(c)},destroy:function(){if(this.wrapper){this.wrapper.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){var b=this,c=this.options;b.inputText.val("");b.valueField.val("")},_setCss:function(b){if(b){this.wrapper.addClass(b)}},_setCancelable:function(c){var b=this,d=this.options;if(!c&&b.unselect){b.unselect.remove();b.unselect=null}if(!c&&!b.unselect){return}b.unselect=a('<div class="l-trigger l-trigger-cancel"><div class="l-trigger-icon"></div></div>').hide();b.wrapper.hover(function(){b.unselect.show()},function(){b.unselect.hide()});if(!d.disabled&&d.cancelable){b.wrapper.append(b.unselect)}b.unselect.hover(function(){this.className="l-trigger-hover l-trigger-cancel"},function(){this.className="l-trigger l-trigger-cancel"}).click(function(){b.clear()})},_setDisabled:function(b){if(b){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},_setWidth:function(c){var b=this;if(c>20){b.wrapper.css({width:c});b.inputText.css({width:c-20})}},_setHeight:function(c){var b=this;if(c>10){b.wrapper.height(c);b.inputText.height(c-2)}},getData:function(){var e=this,j=this.options;var h=[];var c=a(e.valueField).val(),d=a(e.inputText).val();var b=c?c.split(j.split):null,f=d?d.split(j.split):null;a(b).each(function(g){var k={};k[j.textField]=f[g];k[j.valueField]=b[g];h.push(k)});return h},_getText:function(){return a(this.inputText).val()},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},getText:function(){return this._getText()},setValue:function(c,e){var b=this,d=this.options;if(arguments.length>=2){b.setValue(c);b.setText(e);return}b.valueField.val(c)},setText:function(d){var b=this,c=this.options;if(c.render){b.inputText.val(c.render(d))}else{b.inputText.val(d)}},addValue:function(k,n){var j=this,c=this.options;if(!k){return}var m=j.getValue(),o=j.getText();if(!m){j.setValue(k);j.setText(n)}else{var b=[],d=[],e=m.split(c.split),k=k.split(c.split),n=n.split(c.split);for(var h=0,f=k.length;h<f;h++){if(a.inArray(k[h],e)==-1){b.push(k[h]);d.push(n[h])}}if(b.length){j.setValue(m+c.split+b.join(c.split));j.setText(o+c.split+d.join(c.split))}}},removeValue:function(j,m){var f=this,c=this.options;if(!j){return}var k=f.getValue(),n=f.getText();if(!k){return}var o=k.split(c.split),b=n.split(c.split),j=j.split(c.split);for(var e=0,h=-1,d=j.length;e<d;e++){if((h=a.inArray(j[e],o))!=-1){o.splice(h,1);b.splice(h,1)}}f.setValue(o.join(c.split));f.setText(b.join(c.split))},_setGrid:function(c){if(!c){return}var b=this,e=this.options;var d=a.extend({parms:e.parms},e.grid);this.bind("buttonClick",function(){if(!b.popupFn){var f={grid:d,condition:e.condition,valueField:e.valueField,textField:e.textField,split:e.split,lastSelected:b.getData(),onSelect:function(g){if(b.trigger("select",g)==false){return}if(e.grid.checkbox){b.addValue(g.value,g.text);b.removeValue(g.remvoeValue,g.remvoeText)}else{b.setValue(g.value);b.setText(g.text)}b.trigger("selected",g)},selectInit:function(h){var g=b.getValue();if(!g){return false}if(!e.valueField||!h[e.valueField]){return false}return a.inArray(h[e.valueField].toString(),g.split(e.split))!=-1}};b.popupFn=a.ligerui.getPopupFn(f)}b.popupFn()})}});a.ligerui.getPopupFn=function(h){h=a.extend({title:"选择数据",width:700,height:320,top:null,left:null,split:";",valueField:null,textField:null,grid:null,condition:null,onSelect:function(k){},selectInit:function(k){return false}},h);if(!h.grid){return}var g,c,j,f=h.lastSelected||[];return function(){b();return false};function b(){function o(t){t=t||h.height;t-=r.height();return t}if(g){c._showData();g.show();c.refreshSize();f=c.selected.concat();return}var n=a("<div></div>");var r=a("<div></div>");var q=a("<div></div>");n.append(r).append(q);if(h.condition){var m=a.extend({labelWidth:60,space:20},h.condition);j=r.ligerForm(m)}else{r.remove()}var s=a.extend({columnWidth:120,alternatingRow:false,frozen:true,rownumbers:true},h.grid,{width:"100%",height:o(),isChecked:h.selectInit,isSelected:h.selectInit,inWindow:false});c=q.ligerGrid(s);if(h.condition){var k=a('<li style="margin-right:9px"><div></div></li>');a("ul:first",r).append(k).after('<div class="l-clear"></div>');a("div",k).ligerButton({text:"搜索",click:function(){var t=a.ligerui.getConditions(r);c.setParm("condition",a.ligerui.toJSON(t));c.reload()}})}g=a.ligerDialog.open({title:h.title,width:h.width,height:"auto",top:h.top,left:h.left,target:n,isResize:true,cls:"l-selectorwin",onContentHeightChange:function(t){c.set("height",o(t));return false},onStopResize:function(){c.refreshSize()},buttons:[{text:"选择",onclick:function(u,t){d();t.hide()}},{text:"取消",onclick:function(u,t){t.hide()}}]});c.refreshSize()}function e(o,n){for(var k=0;n&&n[k];k++){var m=n[k];if(m[h.valueField]==o){return true}}return false}function d(){var n=c.selected||[];var q=[],s=[],o=[];a(n).each(function(u,w){h.valueField&&q.push(w[h.valueField]);h.textField&&s.push(w[h.textField]);var v=a.extend(true,{},this);c.formatRecord(v,true);o.push(v)});var m=[];a(f).each(function(u,v){if(!e(v[h.valueField],n)&&e(v[h.valueField],c.rows)){m.push(v)}});var r=[],k=[],t=[];a(m).each(function(u,w){h.valueField&&r.push(w[h.valueField]);h.textField&&k.push(w[h.textField]);var v=a.extend(true,{},this);c.formatRecord(v,true);t.push(v)});h.onSelect({value:q.join(h.split),text:s.join(h.split),data:o,remvoeValue:r.join(h.split),remvoeText:k.join(h.split),removeData:t})}}})(jQuery);(function(a){a.fn.ligerPortal=function(b){return a.ligerui.run.call(this,"ligerPortal",arguments)};a.ligerDefaults.Portal={width:null,rows:null,columns:null,url:null,method:"get",parms:null,draggable:false,onLoaded:null};a.ligerDefaults.Portal_rows={width:null,height:null};a.ligerDefaults.Portal_columns={width:null,height:null};a.ligerMethos.Portal={};a.ligerui.controls.Portal=function(c,b){a.ligerui.controls.Portal.base.constructor.call(this,c,b)};a.ligerui.controls.Portal.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Portal"},__idPrev:function(){return"Portal"},_extendMethods:function(){return a.ligerMethos.Portal},_init:function(){var b=this,c=this.options;a.ligerui.controls.Portal.base._init.call(this);if(a(">div",b.element).length){c.columns=[];a(">div",b.element).each(function(d,e){c.columns[d]={panels:[]}});b.tempInitPanels=a("<div></div>");a(">div",b.element).appendTo(b.tempInitPanels)}if(!c.rows&&c.columns){c.rows=[{columns:c.columns}]}},_render:function(){var b=this,c=this.options;b.portal=a(b.element).addClass("l-portal").html("");b.set(c)},_setRows:function(d){var c=this,e=this.options;c.rows=[];if(d&&d.length){for(var b=0;b<d.length;b++){var f=d[b];var h=a('<div class="l-row"></div>').appendTo(c.portal);c.rows[b]=c._renderRow({row:f,rowIndex:b,jrow:h});h.append('<div class="l-clear"></div>')}}},_renderRow:function(j){var o=j.row,k=j.rowIndex,d=j.jrow;var h=this,b=this.options;var m={element:d[0]};if(o.width){d.width(o.width)}if(o.height){d.height(o.height)}if(o.columns){m.columns=[]}if(o.columns&&o.columns.length){for(var f=0;f<o.columns.length;f++){var c=o.columns[f];var n=a('<div class="l-column"></div>').appendTo(d);m.columns[f]=h._renderColumn({column:c,columnIndex:f,jcolumn:n,rowIndex:k})}}return m},remove:function(j){var f=this,h=this.options;var k=j.rowIndex,d=j.columnIndex,c=j.index;if(c==null){c=-1}if(c>=0&&f.rows[k]&&f.rows[k].columns&&f.rows[k].columns[d]&&f.rows[k].columns[d].panels){var b=f.rows[k].columns[d].panels[c];b&&b.close();f._updatePortal()}},add:function(m){var h=this,c=this.options;var o=m.rowIndex,n=m.columnIndex,k=m.index,b=m.panel;if(k==null){k=-1}if(!(h.rows[o]&&h.rows[o].columns&&h.rows[o].columns[n])){return}var f=h.rows[o].columns[n],d=c.rows[o].columns[n],r,q=a(f.element);d.panels=d.panels||[];f.panels=f.panels||[];d.panels.splice(k,0,b);if(k<0){var j=a("<div></div>").insertBefore(f.jplace);r=j.ligerPanel(b)}else{if(f.panels[k]){var j=a("<div></div>").insertBefore(f.panels[k].panel);r=j.ligerPanel(b)}}if(r){r.bind("closed",h._createPanelClosed());h.setPanelEvent({panel:r});f.panels.splice(k,0,r)}h._updatePortal()},_createPanelClosed:function(){var b=this,c=this.options;return function(){var d=this;var f=b.getPanels();var h,g,e;a(f).each(function(){if(this.panel==d){h=this.rowIndex;g=this.columnIndex;e=this.index}});c.rows[h].columns[g].panels.splice(e,1);b.rows[h].columns[g].panels.splice(e,1)}},_renderColumn:function(n){var f=n.column,o=n.columnIndex,s=n.jcolumn;var q=n.rowIndex;var k=this,c=this.options;var r={element:s[0]};if(f.width){s.width(f.width)}if(f.height){s.height(f.height)}if(f.panels){r.panels=[]}if(f.panels&&f.panels.length){for(var j=0;j<f.panels.length;j++){var b=f.panels[j];var m=a("<div></div>").appendTo(s);r.panels[j]=m.ligerPanel(b);r.panels[j].bind("closed",k._createPanelClosed());k.setPanelEvent({panel:r.panels[j]})}}else{if(k.tempInitPanels){var d=k.tempInitPanels.find(">div:eq("+o+")");if(d.length){r.panels=[];var t={};var h=d.clone();if(liger.inject&&liger.inject.getOptions){t=liger.inject.getOptions({jelement:h,defaults:a.ligerDefaults.Panel,config:liger.inject.config.Panel})}r.panels[0]=h.appendTo(s).ligerPanel(t);r.panels[0].bind("closed",k._createPanelClosed());k.setPanelEvent({panel:r.panels[0]})}}}r.jplace=a('<div class="l-column-place"></div>').appendTo(s);return r},setPanelEvent:function(h){var b=h.panel,d=b.panel;var c=this,f=this.options;if(a.fn.ligerDrag&&f.draggable){d.addClass("l-panel-draggable").ligerDrag({proxy:false,revert:true,handler:".l-panel-header span:first",onRendered:function(){},onStartDrag:function(j,g){c.portal.find(">.l-row").addClass("l-row-dragging");this.jplace=a('<div class="l-panel-place"></div>');this.jplace.height(d.height());d.width(d.width());d.addClass("l-panel-dragging");d.css("position","absolute");d.after(this.jplace);c._updatePortal()},onDrag:function(u,v){var r=v.pageX||v.screenX,n=v.pageY||v.screenY;var w=d.height(),j=d.width(),o=d.offset();var q=o.left+j/2,m=o.top+10;var t=c.getPanels(),k=c.getEmptyColumns();var x=g(t,k,q,m);if(x){if(this.placeStatus){if(this.placeStatus.panel&&x.panel){if(this.placeStatus.panel.rowIndex==x.panel.rowIndex&&this.placeStatus.panel.columnIndex==x.panel.columnIndex&&this.placeStatus.panel.index==x.panel.index&&this.placeStatus.position==x.position){return}}if(this.placeStatus.column&&x.column){if(this.placeStatus.column.rowIndex==x.column.rowIndex&&this.placeStatus.column.columnIndex==x.column.columnIndex&&this.placeStatus.position==x.position){return}}}if(x.position=="top"){this.jplace.insertBefore(x.panel?x.panel.jpanel:x.column.jplace);this.savedPosition=x.panel?x.panel:x.column;this.savedPosition.inTop=true}else{if(x.position=="bottom"){this.jplace.insertAfter(x.panel.jpanel);this.savedPosition=x.panel;this.savedPosition.inTop=false}}this.placeStatus=x}else{this.placeStatus=null}function g(z,A,e,E){for(i=0,l=z.length;i<l;i++){var D=z[i];if(D.panel==b){continue}var C=s(D,null,e,E);if(C){return C}}for(i=0,l=A.length;i<l;i++){var B=A[i];var C=s(null,B,e,E);if(C){return C}}return null}function s(e,B,F,E){var C=e?e.jpanel:B.jplace;if(!C){return null}var H=C.height(),z=C.width();var A=C.offset().left,D=C.offset().top;var G=3;if(F>A-G&&F<A+z+G){if(E>D-G&&E<D+H/2+G){return{panel:e,column:B,position:"top"}}if(E>D+H/2-G&&E<D+H+G){return{panel:e,column:B,position:e?"bottom":"top"}}}return null}},onStopDrag:function(o,n){c.portal.find(">.l-row").removeClass("l-row-dragging");b.set("width",b.get("width"));d.removeClass("l-panel-dragging");if(this.jplace){d.css({position:"relative",left:null,top:null});d.insertAfter(this.jplace);c.portal.find(">.l-row > .l-column >.l-panel-place").remove();if(this.savedPosition){var j=c.getPanels();var r,k,g;a(j).each(function(){if(this.panel==b){r=this.rowIndex;k=this.columnIndex;g=this.index}});var q=f.rows[r].columns[k].panels[g];var m=c.rows[r].columns[k].panels[g];f.rows[r].columns[k].panels.splice(g,1);c.rows[r].columns[k].panels.splice(g,1);if(this.savedPosition.panel){f.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,q);c.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels.splice(this.savedPosition.index+this.savedPosition.inTop?-1:0,0,m)}else{f.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[q];c.rows[this.savedPosition.rowIndex].columns[this.savedPosition.columnIndex].panels=[m]}}}c._updatePortal();return false}})}},_updatePortal:function(){var b=this,c=this.options;a(b.rows).each(function(d){a(this.columns).each(function(e){if(this.panels&&this.panels.length){a(this.element).removeClass("l-column-empty")}else{a(this.element).addClass("l-column-empty")}})})},getPanels:function(){var c=this,d=this.options;var b=[];a(c.rows).each(function(e){a(this.columns).each(function(f){a(this.panels).each(function(g){b.push({rowIndex:e,columnIndex:f,index:g,panel:this,jpanel:this.panel})})})});return b},getPanel:function(f){var c=this,d=this.options;f=a.extend({rowIndex:0,columnIndex:0,index:0},f);var b=null;a(c.rows).each(function(e){a(this.columns).each(function(g){a(this.panels).each(function(h){if(b){return}if(e==f.rowIndex&&g==f.columnIndex&&h==f.index){b=this}})})});return b},getEmptyColumns:function(){var c=this,d=this.options;var b=[];a(c.rows).each(function(e){a(this.columns).each(function(f){if(!this.panels||!this.panels.length){b.push({rowIndex:e,columnIndex:f,jplace:this.jplace})}})});return b},_setUrl:function(b){var c=this,d=this.options;if(!b){return}a.ajax({url:b,data:d.parms,type:d.method,dataType:"json",success:function(e){c.set("rows",e)}})},_setWidth:function(b){b&&this.portal.width(b)},collapseAll:function(){var c=this,d=this.options;var b=c.getPanels();a(b).each(function(f,g){var e=g.panel;e.collapse()})},expandAll:function(){var c=this,d=this.options;var b=c.getPanels();a(b).each(function(f,g){var e=g.panel;e.expand()})}})})(jQuery);(function(a){a.fn.ligerRadio=function(){return a.ligerui.run.call(this,"ligerRadio",arguments)};a.fn.ligerGetRadioManager=function(){return a.ligerui.run.call(this,"ligerGetRadioManager",arguments)};a.ligerDefaults.Radio={disabled:false};a.ligerMethos.Radio={};a.ligerui.controls.Radio=function(c,b){a.ligerui.controls.Radio.base.constructor.call(this,c,b)};a.ligerui.controls.Radio.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return a.ligerMethos.Radio},_render:function(){var b=this,c=this.options;b.input=a(this.element);b.link=a('<a href="javascript:void(0)" class="l-radio"></a>');b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent();b.wrapper.prepend(b.link);b.input.change(function(){if(this.checked){b.link.addClass("l-radio-checked")}else{b.link.removeClass("l-radio-checked")}return true});b.link.click(function(){b._doclick()});b.wrapper.hover(function(){if(!c.disabled){a(this).addClass("l-over")}},function(){a(this).removeClass("l-over")});this.element.checked&&b.link.addClass("l-radio-checked");if(this.element.id){a("label[for="+this.element.id+"]").click(function(){b._doclick()})}b.set(c)},setValue:function(c){var b=this,d=this.options;if(!c){b.input[0].checked=false;b.link.removeClass("l-radio-checked")}else{b.input[0].checked=true;b.link.addClass("l-radio-checked")}},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",false);this.wrapper.removeClass("l-disabled");this.options.disabled=false},setDisabled:function(){this.input.attr("disabled",true);this.wrapper.addClass("l-disabled");this.options.disabled=true},updateStyle:function(){if(this.input.attr("disabled")){this.wrapper.addClass("l-disabled");this.options.disabled=true}if(this.input[0].checked){this.link.addClass("l-checkbox-checked")}else{this.link.removeClass("l-checkbox-checked")}},_doclick:function(){var c=this,d=this.options;if(c.input.attr("disabled")){return false}c.input.trigger("click").trigger("change");var b;if(c.input[0].form){b=c.input[0].form}else{b=document}a("input:radio[name="+c.input[0].name+"]",b).not(c.input).trigger("change");return false}})})(jQuery);(function(a){a.fn.ligerRadioList=function(b){return a.ligerui.run.call(this,"ligerRadioList",arguments)};a.ligerDefaults.RadioList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.RadioList=a.ligerMethos.RadioList||{};a.ligerui.controls.RadioList=function(c,b){a.ligerui.controls.RadioList.base.constructor.call(this,c,b)};a.ligerui.controls.RadioList.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"RadioList"},_extendMethods:function(){return a.ligerMethos.RadioList},_init:function(){a.ligerui.controls.RadioList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null){b.valueField[0].name=b.valueField[0].id}if(c.valueFieldCssClass){b.valueField.addClass(c.valueFieldCssClass)}b.valueField.attr("data-ligerid",b.id);b.radioList=a(this.element);b.radioList.html('<div class="l-radiolist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-radiolist-table"></table></div>').addClass("l-radiolist").append(b.valueField);b.radioList.table=a("table:first",b.radioList);c.value=b.valueField.val()||c.value;b.set(c);b._addClickEven()},destroy:function(){if(this.radioList){this.radioList.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(b){if(b){this.radioList.addClass(b)}},_setDisabled:function(b){if(b){this.radioList.addClass("l-radiolist-disabled");a("input:radio",this.radioList).attr("disabled",true)}else{this.radioList.removeClass("l-radiolist-disabled");a("input:radio",this.radioList).removeAttr("disabled")}},_setWidth:function(b){this.radioList.width(b)},_setHeight:function(b){this.radioList.height(b)},indexOf:function(e){var d=this,f=this.options;if(!d.data){return -1}for(var c=0,b=d.data.length;c<b;c++){if(typeof(e)=="object"){if(d.data[c]==e){return c}}else{if(d.data[c][f.valueField].toString()==e.toString()){return c}}}return -1},removeItems:function(b){var c=this;if(!c.data){return}a(b).each(function(e,f){var d=c.indexOf(f);if(d==-1){return}c.data.splice(d,1)});c.refresh()},removeItem:function(c){if(!this.data){return}var b=this.indexOf(c);if(b==-1){return}this.data.splice(b,1);this.refresh()},insertItem:function(d,b){var c=this;if(!c.data){c.data=[]}c.data.splice(b,0,d);c.refresh()},addItems:function(b){var c=this;if(!c.data){c.data=[]}a(b).each(function(d,e){c.data.push(e)});c.refresh()},addItem:function(c){var b=this;if(!b.data){b.data=[]}b.data.push(c);b.refresh()},_setValue:function(c){var b=this,d=this.options;d.value=c;this._dataInit()},setValue:function(b){this._setValue(b)},_setUrl:function(b){if(!b){return}var c=this,d=this.options;a.ajax({type:"post",url:b,data:d.parms,cache:false,dataType:"json",success:function(e){c.setData(e);c.trigger("success",[e])},error:function(e,f){c.trigger("error",[e,f])}})},setUrl:function(b){return this._setUrl(b)},setParm:function(b,e){if(!b){return}var d=this;var c=d.get("parms");if(!c){c={}}c[b]=e;d.set("parms",c)},clearContent:function(){var b=this,c=this.options;a("table",b.radioList).html("")},_setData:function(b){this.setData(b)},setData:function(c){var b=this,d=this.options;if(!c||!c.length){return}b.data=c;b.refresh();b.updateStyle()},refresh:function(){var m=this,d=this.options,j=this.data;this.clearContent();if(!j){return}var f=[],o=d.rowSize,n=false,b=d.name||m.id;for(var k=0;k<j.length;k++){var e=j[k][d.valueField],h=j[k][d.textField],c=m.id+"-"+k;var q=k%o==0;if(q){if(n){f.push("</tr>")}f.push("<tr>");n=true}f.push("<td><input type='radio' name='"+b+"' value='"+e+"' id='"+c+"'/><label for='"+c+"'>"+h+"</label></td>")}if(n){f.push("</tr>")}m.radioList.table.append(f.join(""))},_getValue:function(){var c=this,d=this.options,b=d.name||c.id;return a('input:radio[name="'+b+'"]:checked').val()},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var b=this,d=this.options;var c=b.valueField.val()||b._getValue()||d.value;b._changeValue(c)},_changeValue:function(e){var c=this,d=this.options,b=d.name||c.id;a("input:radio[name='"+b+"']",c.radioList).each(function(){this.checked=this.value==e});c.valueField.val(e);c.selectedValue=e},_addClickEven:function(){var b=this,c=this.options;b.radioList.click(function(f){var d=b.getValue();if(d){b.valueField.val(d)}})}})})(jQuery);(function(a){a.fn.ligerResizable=function(b){return a.ligerui.run.call(this,"ligerResizable",arguments,{idAttrName:"ligeruiresizableid",hasElement:false,propertyToElemnt:"target"})};a.fn.ligerGetResizableManager=function(){return a.ligerui.run.call(this,"ligerGetResizableManager",arguments,{idAttrName:"ligeruiresizableid",hasElement:false,propertyToElemnt:"target"})};a.ligerDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2000,maxHeight:2000,minWidth:20,minHeight:20,scope:3,animate:false,onStartResize:function(b){},onResize:function(b){},onStopResize:function(b){},onEndResize:null};a.ligerui.controls.Resizable=function(b){a.ligerui.controls.Resizable.base.constructor.call(this,null,b)};a.ligerui.controls.Resizable.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var b=this,c=this.options;b.target=a(c.target);b.set(c);b.target.mousemove(function(f){if(c.disabled){return}b.dir=b._getDir(f);if(b.dir){b.target.css("cursor",b.dir+"-resize")}else{if(b.target.css("cursor").indexOf("-resize")>0){b.target.css("cursor","default")}}if(c.target.ligeruidragid){var d=a.ligerui.get(c.target.ligeruidragid);if(d&&b.dir){d.set("disabled",true)}else{if(d){d.set("disabled",false)}}}}).mousedown(function(d){if(c.disabled){return}if(b.dir){b._start(d)}})},_rendered:function(){this.options.target.ligeruiresizableid=this.id},_getDir:function(k){var j=this,b=this.options;var d="";var o=j.target.offset();var c=j.target.width();var m=j.target.height();var n=b.scope;var h=k.pageX||k.screenX;var f=k.pageY||k.screenY;if(f>=o.top&&f<o.top+n){d+="n"}else{if(f<=o.top+m&&f>o.top+m-n){d+="s"}}if(h>=o.left&&h<o.left+n){d+="w"}else{if(h<=o.left+c&&h>o.left+c-n){d+="e"}}if(b.handles=="all"||d==""){return d}if(a.inArray(d,j.handles)!=-1){return d}return""},_setHandles:function(b){if(!b){return}this.handles=b.replace(/(\s*)/g,"").split(",")},_createProxy:function(){var b=this;b.proxy=a('<div class="l-resizable"></div>');b.proxy.width(b.target.width()).height(b.target.height());b.proxy.attr("resizableid",b.id).appendTo("body")},_removeProxy:function(){var b=this;if(b.proxy){b.proxy.remove();b.proxy=null}},_start:function(d){var b=this,c=this.options;b._createProxy();b.proxy.css({left:b.target.offset().left,top:b.target.offset().top,position:"absolute"});b.current={dir:b.dir,left:b.target.offset().left,top:b.target.offset().top,startX:d.pageX||d.screenX,startY:d.pageY||d.clientY,width:b.target.width(),height:b.target.height()};a(document).bind("selectstart.resizable",function(){return false});a(document).bind("mouseup.resizable",function(){b._stop.apply(b,arguments)});a(document).bind("mousemove.resizable",function(){b._drag.apply(b,arguments)});b.proxy.show();b.trigger("startResize",[b.current,d])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(h){var d=this,f=this.options;if(!d.current){return}if(!d.proxy){return}d.proxy.css("cursor",d.current.dir==""?"default":d.current.dir+"-resize");var c=h.pageX||h.screenX;var b=h.pageY||h.screenY;d.current.diffX=c-d.current.startX;d.current.diffY=b-d.current.startY;d._applyResize(d.proxy);d.trigger("resize",[d.current,h])},_stop:function(d){var b=this,c=this.options;if(b.hasBind("stopResize")){if(b.trigger("stopResize",[b.current,d])!=false){b._applyResize()}}else{b._applyResize()}b._removeProxy();b.trigger("endResize",[b.current,d]);a(document).unbind("selectstart.resizable");a(document).unbind("mousemove.resizable");a(document).unbind("mouseup.resizable")},_applyResize:function(b){var c=this,d=this.options;var e={left:c.current.left,top:c.current.top,width:c.current.width,height:c.current.height};var f=false;if(!b){b=c.target;f=true;if(!isNaN(parseInt(c.target.css("top")))){e.top=parseInt(c.target.css("top"))}else{e.top=0}if(!isNaN(parseInt(c.target.css("left")))){e.left=parseInt(c.target.css("left"))}else{e.left=0}}if(a.inArray(c.current.dir,c.changeBy.l)>-1){e.left+=c.current.diffX;c.current.diffLeft=c.current.diffX}else{if(f){delete e.left}}if(a.inArray(c.current.dir,c.changeBy.t)>-1){e.top+=c.current.diffY;c.current.diffTop=c.current.diffY}else{if(f){delete e.top}}if(a.inArray(c.current.dir,c.changeBy.w)>-1){e.width+=(c.current.dir.indexOf("w")==-1?1:-1)*c.current.diffX;c.current.newWidth=e.width}else{if(f){delete e.width}}if(a.inArray(c.current.dir,c.changeBy.h)>-1){e.height+=(c.current.dir.indexOf("n")==-1?1:-1)*c.current.diffY;c.current.newHeight=e.height}else{if(f){delete e.height}}if(f&&d.animate){b.animate(e)}else{b.css(e)}}})})(jQuery);(function(a){a.fn.ligerSpinner=function(){return a.ligerui.run.call(this,"ligerSpinner",arguments)};a.fn.ligerGetSpinnerManager=function(){return a.ligerui.run.call(this,"ligerGetSpinnerManager",arguments)};a.ligerDefaults.Spinner={type:"float",isNegative:true,decimalplace:2,step:0.1,interval:50,onChangeValue:false,minValue:null,maxValue:null,disabled:false,readonly:false};a.ligerMethos.Spinner={};a.ligerui.controls.Spinner=function(c,b){a.ligerui.controls.Spinner.base.constructor.call(this,c,b)};a.ligerui.controls.Spinner.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return a.ligerMethos.Spinner},_init:function(){a.ligerui.controls.Spinner.base._init.call(this);var b=this.options;if(b.type=="float"){b.step=0.1;b.interval=50}else{if(b.type=="int"){b.step=1;b.interval=100}else{if(b.type=="time"){b.step=1;b.interval=100}else{b.type="int";b.step=1;b.interval=100}}}},_render:function(){var b=this,c=this.options;b.interval=null;b.inputText=null;b.value=null;b.textFieldID="";if(this.element.tagName.toLowerCase()=="input"&&this.element.type&&this.element.type=="text"){b.inputText=a(this.element);if(this.element.id){b.textFieldID=this.element.id}}else{b.inputText=a('<input type="text"/>');b.inputText.appendTo(a(this.element))}if(b.textFieldID==""&&c.textFieldID){b.textFieldID=c.textFieldID}b.link=a('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>');b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent();b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');b.wrapper.append(b.link).after(b.selectBox).after(b.valueField);b.link.up=a(".l-spinner-up",b.link);b.link.down=a(".l-spinner-down",b.link);b.inputText.addClass("l-text-field");if(c.disabled){b.wrapper.addClass("l-text-disabled")}if(!b._isVerify(b.inputText.val())){b.value=b._getDefaultValue();b._showValue(b.value)}b.link.up.hover(function(){if(!c.disabled){a(this).addClass("l-spinner-up-over")}},function(){clearInterval(b.interval);a(document).unbind("selectstart.spinner");a(this).removeClass("l-spinner-up-over")}).mousedown(function(){if(!c.disabled){b._uping.call(b);b.interval=setInterval(function(){b._uping.call(b)},c.interval);a(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(b.interval);b.inputText.trigger("change").focus();a(document).unbind("selectstart.spinner")});b.link.down.hover(function(){if(!c.disabled){a(this).addClass("l-spinner-down-over")}},function(){clearInterval(b.interval);a(document).unbind("selectstart.spinner");a(this).removeClass("l-spinner-down-over")}).mousedown(function(){if(!c.disabled){b.interval=setInterval(function(){b._downing.call(b)},c.interval);a(document).bind("selectstart.spinner",function(){return false})}}).mouseup(function(){clearInterval(b.interval);b.inputText.trigger("change").focus();a(document).unbind("selectstart.spinner")});b.inputText.change(function(){var d=b.inputText.val();b.value=b._getVerifyValue(d);b.trigger("changeValue",[b.value]);b._showValue(b.value)}).blur(function(){b.wrapper.removeClass("l-text-focus")}).focus(function(){b.wrapper.addClass("l-text-focus")});b.wrapper.hover(function(){if(!c.disabled){b.wrapper.addClass("l-text-over")}},function(){b.wrapper.removeClass("l-text-over")});b.set(c)},_setWidth:function(c){var b=this;if(c>20){b.wrapper.css({width:c});b.inputText.css({width:c-20})}},_setHeight:function(c){var b=this;if(c>10){b.wrapper.height(c);b.inputText.height(c-2);b.link.height(c-4)}},_setDisabled:function(b){if(b){this.wrapper.addClass("l-text-disabled")}else{this.wrapper.removeClass("l-text-disabled")}},_showValue:function(c){var b=this,d=this.options;if(!c||c=="NaN"){c=0}if(d.type=="float"){c=parseFloat(c).toFixed(d.decimalplace)}this.inputText.val(c)},_setValue:function(b){this._showValue(b)},setValue:function(b){this._showValue(b)},getValue:function(){return this.inputText.val()},_round:function(b,h){var d=this,f=this.options;var c=1;for(;h>0;c*=10,h--){}for(;h<0;c/=10,h++){}return Math.round(b*c)/c},_isInt:function(e){var b=this,c=this.options;var d=c.isNegative?/^-?\d+$/:/^\d+$/;if(!d.test(e)){return false}if(parseFloat(e)!=e){return false}return true},_isFloat:function(e){var b=this,c=this.options;var d=c.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;if(!d.test(e)){return false}if(parseFloat(e)!=e){return false}return true},_isTime:function(e){var c=this,d=this.options;var b=e.match(/^(\d{1,2}):(\d{1,2})$/);if(b==null){return false}if(b[1]>24||b[2]>60){return false}return true},_isVerify:function(e){var b=this,d=this.options;if(d.type=="float"){if(!b._isFloat(e)){return false}var c=parseFloat(e);if(d.minValue!=undefined&&d.minValue>c){return false}if(d.maxValue!=undefined&&d.maxValue<c){return false}return true}else{if(d.type=="int"){if(!b._isInt(e)){return false}var c=parseInt(e);if(d.minValue!=undefined&&d.minValue>c){return false}if(d.maxValue!=undefined&&d.maxValue<c){return false}return true}else{if(d.type=="time"){return b._isTime(e)}}}return false},_getVerifyValue:function(d){var c=this,e=this.options;var b=null;if(e.type=="float"){b=c._round(d,e.decimalplace)}else{if(e.type=="int"){b=parseInt(d)}else{if(e.type=="time"){b=d}}}if(!c._isVerify(b)){return c.value}else{return b}},_isOverValue:function(c){var b=this,d=this.options;if(d.minValue!=null&&d.minValue>c){return true}if(d.maxValue!=null&&d.maxValue<c){return true}return false},_getDefaultValue:function(){var b=this,c=this.options;if(c.type=="float"||c.type=="int"){return 0}else{if(c.type=="time"){return"00:00"}}},_addValue:function(b){var c=this,e=this.options;var d=c.inputText.val();d=parseFloat(d)+b;if(c._isOverValue(d)){return}c._showValue(d);c.inputText.trigger("change")},_addTime:function(f){var c=this,e=this.options;var d=c.inputText.val();var b=d.match(/^(\d{1,2}):(\d{1,2})$/);newminute=parseInt(b[2])+f;if(newminute<10){newminute="0"+newminute}d=b[1]+":"+newminute;if(c._isOverValue(d)){return}c._showValue(d);c.inputText.trigger("change")},_uping:function(){var b=this,c=this.options;if(c.type=="float"||c.type=="int"){b._addValue(c.step)}else{if(c.type=="time"){b._addTime(c.step)}}},_downing:function(){var b=this,c=this.options;if(c.type=="float"||c.type=="int"){b._addValue(-1*c.step)}else{if(c.type=="time"){b._addTime(-1*c.step)}}},_isDateTime:function(b){var e=this,f=this.options;var c=b.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(c==null){return false}var h=new Date(c[1],c[3]-1,c[4]);if(h=="NaN"){return false}return(h.getFullYear()==c[1]&&(h.getMonth()+1)==c[3]&&h.getDate()==c[4])},_isLongDateTime:function(b){var f=this,h=this.options;var c=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/;var e=b.match(c);if(e==null){return false}var j=new Date(e[1],e[3]-1,e[4],e[5],e[6]);if(j=="NaN"){return false}return(j.getFullYear()==e[1]&&(j.getMonth()+1)==e[3]&&j.getDate()==e[4]&&j.getHours()==e[5]&&j.getMinutes()==e[6])}})})(jQuery);(function(a){a.fn.ligerTab=function(b){return a.ligerui.run.call(this,"ligerTab",arguments)};a.fn.ligerGetTabManager=function(){return a.ligerui.run.call(this,"ligerGetTabManager",arguments)};a.ligerDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:false,contextmenu:true,dblClickToClose:false,dragToMove:false,showSwitch:false,showSwitchInTab:false,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null,onCloseOther:null,onCloseAll:null,onClose:null,onReload:null};a.ligerDefaults.TabString={closeMessage:"关闭当前页",closeOtherMessage:"关闭其他",closeAllMessage:"关闭所有",reloadMessage:"刷新"};a.ligerMethos.Tab={};a.ligerui.controls.Tab=function(c,b){a.ligerui.controls.Tab.base.constructor.call(this,c,b)};a.ligerui.controls.Tab.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return a.ligerMethos.Tab},_render:function(){var c=this,e=this.options;if(e.height){c.makeFullHeight=true}c.tab=a(this.element);c.tab.addClass("l-tab");if(e.contextmenu&&a.ligerMenu){c.tab.menu=a.ligerMenu({width:100,items:[{text:e.closeMessage,id:"close",click:function(){c._menuItemClick.apply(c,arguments)}},{text:e.closeOtherMessage,id:"closeother",click:function(){c._menuItemClick.apply(c,arguments)}},{text:e.closeAllMessage,id:"closeall",click:function(){c._menuItemClick.apply(c,arguments)}},{text:e.reloadMessage,id:"reload",click:function(){c._menuItemClick.apply(c,arguments)}}]})}c.tab.content=a('<div class="l-tab-content"></div>');a("> div",c.tab).appendTo(c.tab.content);c.tab.content.appendTo(c.tab);c.tab.links=a('<div class="l-tab-links"><ul style="left: 0px; "></ul><div class="l-tab-switch"></div></div>');c.tab.links.prependTo(c.tab);c.tab.links.ul=a("ul",c.tab.links);var b=a("> div[lselected=true]",c.tab.content);var d=b.length>0;c.selectedTabId=b.attr("tabid");a("> div",c.tab.content).each(function(j,m){var f=a('<li class=""><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>');var h=a(this);if(h.attr("title")){a("> a",f).html(h.attr("title"));h.attr("title","")}var g=h.attr("tabid");if(g==undefined){g=c.getNewTabid();h.attr("tabid",g);if(h.attr("lselected")){c.selectedTabId=g}}f.attr("tabid",g);if(!d&&j==0){c.selectedTabId=g}var o=h.attr("showClose");if(o){f.append("<div class='l-tab-links-item-close'></div>")}a("> ul",c.tab.links).append(f);if(!h.hasClass("l-tab-content-item")){h.addClass("l-tab-content-item")}if(h.find("iframe").length>0){var k=a("iframe:first",h);if(k[0].readyState!="complete"){if(h.find(".l-tab-loading:first").length==0){h.prepend("<div class='l-tab-loading' style='display:block;'></div>")}var n=a(".l-tab-loading:first",h);k.bind("load.tab",function(){n.hide()})}}});c.selectTabItem(c.selectedTabId);if(e.height){if(typeof(e.height)=="string"&&e.height.indexOf("%")>0){c.onResize();if(e.changeHeightOnResize){a(window).resize(function(){c.onResize.call(c)})}}else{c.setHeight(e.height)}}if(c.makeFullHeight){c.setContentHeight()}a("li",c.tab.links).each(function(){c._addTabItemEvent(a(this))});c.tab.bind("dblclick.tab",function(k){if(!e.dblClickToClose){return}c.dblclicking=true;var j=(k.target||k.srcElement);var h=j.tagName.toLowerCase();if(h=="a"){var g=a(j).parent().attr("tabid");var f=a(j).parent().find("div.l-tab-links-item-close").length?true:false;if(f){c.removeTabItem(g)}}c.dblclicking=false});c.set(e)},_setShowSwitch:function(c){var b=this,d=this.options;if(c){if(!a(".l-tab-switch",b.tab.links).length){a("<div class='l-tab-switch'></div>").appendTo(b.tab.links)}a(b.tab).addClass("l-tab-switchable");a(".l-tab-switch",b.tab).click(function(){b.toggleSwitch(this)})}else{a(b.tab).removeClass("l-tab-switchable");a("body > .l-tab-windowsswitch").remove()}},_setShowSwitchInTab:function(d){var c=this,e=this.options;if(e.showSwitch&&d){a(c.tab).removeClass("l-tab-switchable");a(".l-tab-switch",c.tab).remove();var b=a("<li class='l-tab-itemswitch'><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div></li>");b.appendTo(c.tab.links.ul);b.click(function(){c.toggleSwitch(this)})}else{a(".l-tab-itemswitch",c.tab.ul).remove()}},toggleSwitch:function(b){var c=this,f=this.options;if(a("body > .l-tab-windowsswitch").length){a("body > .l-tab-windowsswitch").remove();return}if(b==null){return}var e=a("<div class='l-tab-windowsswitch'></div>").appendTo("body");var h=c.tab.links.ul.find(">li");var d=c.getSelectedTabItemID();h.each(function(k,m){var j=a("<a href='javascript:void(0)'></a>");j.text(a(m).find("a").text());var g=a(m).attr("tabid");if(g==null){return}if(g==d){j.addClass("selected")}j.attr("tabid",g);e.append(j)});e.css({top:a(b).offset().top+a(b).height(),left:a(b).offset().left-e.width()});e.bind("click",function(k){var j=(k.target||k.srcElement);if(j.tagName.toLowerCase()=="a"){var g=a(j).attr("tabid");c.selectTabItem(g);c.moveToTabItem(g);a("body > .l-tab-windowsswitch").remove();return}})},_applyDrag:function(d){var c=this,e=this.options;c.droptip=c.droptip||a("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body");var b=a(d).ligerDrag({revert:true,animate:false,proxy:function(){var f=a(this).find("a").html();c.dragproxy=a("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body");c.dragproxy.append(f);return c.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(h,g){if(!a(d).hasClass("l-selected")){return false}if(g.button==2){return false}var f=g.srcElement||g.target;if(a(f).hasClass("l-tab-links-item-close")){return false}},onDrag:function(h,g){if(c.dropIn==null){c.dropIn=-1}var j=c.tab.links.ul.find(">li");var f=j.index(h.target);j.each(function(o,r){if(f==o){return}var k=o>f;if(c.dropIn!=-1&&c.dropIn!=o){return}var s=a(this).offset();var m={top:s.top,bottom:s.top+a(this).height(),left:s.left-10,right:s.left+10};if(k){m.left+=a(this).width();m.right+=a(this).width()}var q=g.pageX||g.screenX;var n=g.pageY||g.screenY;if(q>m.left&&q<m.right&&n>m.top&&n<m.bottom){c.droptip.css({left:m.left+5,top:m.top-9}).show();c.dropIn=o;c.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")}else{c.dropIn=-1;c.droptip.hide();c.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no")}})},onStopDrag:function(g,f){if(c.dropIn>-1){var j=c.tab.links.ul.find(">li:eq("+c.dropIn+")").attr("tabid");var h=a(g.target).attr("tabid");setTimeout(function(){c.moveTabItem(h,j)},0);c.dropIn=-1;c.dragproxy.remove()}c.droptip.hide();this.set("cursor","default")}});return b},_setDragToMove:function(c){if(!a.fn.ligerDrag){return}var b=this,d=this.options;if(c){if(b.drags){return}b.drags=b.drags||[];b.tab.links.ul.find(">li").each(function(){b.drags.push(b._applyDrag(this))})}},moveTabItem:function(j,c){var b=this;var h=b.tab.links.ul.find(">li[tabid="+j+"]");var f=b.tab.links.ul.find(">li[tabid="+c+"]");var e=b.tab.links.ul.find(">li").index(h);var d=b.tab.links.ul.find(">li").index(f);if(e<d){f.after(h)}else{f.before(h)}},setTabButton:function(){var c=this,d=this.options;var e=0;a("li",c.tab.links.ul).each(function(){e+=a(this).width()+2});var b=c.tab.width();if(e>b){if(!a(".l-tab-links-left",c.tab).length){c.tab.links.append('<div class="l-tab-links-left"><span></span></div><div class="l-tab-links-right"><span></span></div>');c.setTabButtonEven()}return true}else{c.tab.links.ul.animate({left:0});a(".l-tab-links-left,.l-tab-links-right",c.tab.links).remove();return false}},setTabButtonEven:function(){var b=this,c=this.options;a(".l-tab-links-left",b.tab.links).hover(function(){a(this).addClass("l-tab-links-left-over")},function(){a(this).removeClass("l-tab-links-left-over")}).click(function(){b.moveToPrevTabItem()});a(".l-tab-links-right",b.tab.links).hover(function(){a(this).addClass("l-tab-links-right-over")},function(){a(this).removeClass("l-tab-links-right-over")}).click(function(){b.moveToNextTabItem()})},moveToPrevTabItem:function(v){var u=this,o=this.options;var m=a("> li",u.tab.links.ul),s=a(".l-tab-links-right",u.tab),h=a(".l-tab-links-left",u.tab);if(!s.length||!h.length){return false}var n=s.offset(),w=h.offset();var b=null,j=0;var k=w.left+h.outerWidth();for(var t=0,r=m.length;t<r;t++){var q=a(m[t]);var f=q.offset();var e=f.left,c=f.left+q.outerWidth();if(v!=null){if(e<k&&q.attr("tabid")==v){b=q;break}}else{if(e<k&&c>=k){b=q;break}}j+=q.outerWidth()+parseInt(q.css("marginLeft"))+parseInt(q.css("marginRight"))}if(b==null){return false}var d=j-h.outerWidth();u.tab.links.ul.animate({left:-1*d});return true},moveToNextTabItem:function(b){var t=this,e=this.options;var k=a("> li",t.tab.links.ul),c=a(".l-tab-links-right",t.tab),n=a(".l-tab-links-left",t.tab);if(!c.length||!n.length){return false}var r=c.offset(),u=n.offset();var v=null,h=0;for(var s=0,m=k.length;s<m;s++){var f=a(k[s]);h+=f.outerWidth()+parseInt(f.css("marginLeft"))+parseInt(f.css("marginRight"));var q=f.offset();var d=q.left,o=q.left+f.outerWidth();if(b!=null){if(o>r.left&&f.attr("tabid")==b){v=f;break}}else{if(d<=r.left&&o>r.left){v=f;break}}}if(v==null){return false}var j=h-(r.left-u.left)+parseInt(v.css("marginLeft"))+parseInt(v.css("marginRight"));t.tab.links.ul.animate({left:-1*j});return true},moveToTabItem:function(b){var c=this,d=this.options;if(!c.moveToPrevTabItem(b)){c.moveToNextTabItem(b)}},getTabItemCount:function(){var b=this,c=this.options;return a("li",b.tab.links.ul).length},getSelectedTabItemID:function(){var b=this,c=this.options;return a("li.l-selected",b.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){var b=this,c=this.options;b.removeTabItem(b.getSelectedTabItemID())},overrideSelectedTabItem:function(b){var c=this,d=this.options;c.overrideTabItem(c.getSelectedTabItemID(),b)},overrideTabItem:function(n,r){var f=this,d=this.options;if(f.trigger("beforeOverrideTabItem",[n])==false){return false}var b=r.tabid;if(b==undefined){b=f.getNewTabid()}var c=r.url;var j=r.content;var h=r.target;var q=r.text;var k=r.showClose;var o=r.height;if(f.isTabItemExist(b)){return}var e=a("li[tabid="+n+"]",f.tab.links.ul);var m=a(".l-tab-content-item[tabid="+n+"]",f.tab.content);if(!e||!m){return}e.attr("tabid",b);m.attr("tabid",b);if(a("iframe",m).length==0&&c){m.html("<iframe frameborder='0'></iframe>")}else{if(j){m.html(j)}}a("iframe",m).attr("name",b);if(k==undefined){k=true}if(k==false){a(".l-tab-links-item-close",e).remove()}else{if(a(".l-tab-links-item-close",e).length==0){e.append("<div class='l-tab-links-item-close'></div>")}}if(q==undefined){q=b}if(o){m.height(o)}a("a",e).text(q);a("iframe",m).attr("src",c);f.trigger("afterOverrideTabItem",[n])},setHeader:function(b,c){a("li[tabid="+b+"] a",this.tab.links.ul).text(c)},selectTabItem:function(b){var c=this,d=this.options;if(c.trigger("beforeSelectTabItem",[b])==false){return false}c.selectedTabId=b;a("> .l-tab-content-item[tabid="+b+"]",c.tab.content).show().siblings().hide();a("li[tabid="+b+"]",c.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected");c.trigger("afterSelectTabItem",[b])},moveToLastTabItem:function(){var d=this,e=this.options;var f=0;a("li",d.tab.links.ul).each(function(){f+=a(this).width()+2});var c=d.tab.width();if(f>c){var b=a(".l-tab-links-right",d.tab.links).width();d.tab.links.ul.animate({left:-1*(f-c+b+2)})}},isTabItemExist:function(b){var c=this,d=this.options;return a("li[tabid="+b+"]",c.tab.links.ul).length>0},addTabItem:function(s){var h=this,d=this.options;if(h.trigger("beforeAddTabItem",[s])==false){return false}var b=s.tabid;if(b==undefined){b=h.getNewTabid()}var c=s.url;var j=s.content;var r=s.text;var k=s.showClose;var q=s.height;if(h.isTabItemExist(b)){h.selectTabItem(b);return}var e=a("<li><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>");var n=a("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0'></iframe></div>");var o=a("div:first",n);var f=a("iframe:first",n);if(h.makeFullHeight){var m=h.tab.height()-h.tab.links.height();n.height(m)}e.attr("tabid",b);n.attr("tabid",b);if(c){f.attr("name",b).attr("id",b).attr("src",c).bind("load.tab",function(){o.hide();if(s.callback){s.callback()}})}else{f.remove();o.remove()}if(j){n.html(j)}else{if(s.target){n.append(s.target)}}if(k==undefined){k=true}if(k==false){a(".l-tab-links-item-close",e).remove()}if(r==undefined){r=b}if(q){n.height(q)}a("a",e).text(r);if(a(".l-tab-itemswitch",h.tab.links.ul).length){e.insertBefore(a(".l-tab-itemswitch",h.tab.links.ul))}else{h.tab.links.ul.append(e)}h.tab.content.append(n);h.selectTabItem(b);if(h.setTabButton()){h.moveToTabItem(b)}h._addTabItemEvent(e);if(d.dragToMove&&a.fn.ligerDrag){h.drags=h.drags||[];e.each(function(){h.drags.push(h._applyDrag(this))})}h.toggleSwitch();h.trigger("afterAddTabItem",[s])},_addTabItemEvent:function(b){var c=this,d=this.options;b.click(function(){var e=a(this).attr("tabid");c.selectTabItem(e)});c.tab.menu&&c._addTabItemContextMenuEven(b);a(".l-tab-links-item-close",b).hover(function(){a(this).addClass("l-tab-links-item-close-over")},function(){a(this).removeClass("l-tab-links-item-close-over")}).click(function(){var e=a(this).parent().attr("tabid");c.removeTabItem(e)})},removeTabItem:function(c){var f=this,h=this.options;if(f.trigger("beforeRemoveTabItem",[c])==false){return false}var e=a("li[tabid="+c+"]",f.tab.links.ul).hasClass("l-selected");if(e){a(".l-tab-content-item[tabid="+c+"]",f.tab.content).prev().show();a("li[tabid="+c+"]",f.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected")}var b=a(".l-tab-content-item[tabid="+c+"]",f.tab.content);var d=a("iframe",b);if(d.length){var j=d[0];j.src="about:blank";j.contentWindow.document.write("");a.browser.msie&&CollectGarbage();d.remove()}b.remove();a("li[tabid="+c+"]",f.tab.links.ul).remove();f.setTabButton();f.trigger("afterRemoveTabItem",[c])},addHeight:function(e){var c=this,d=this.options;var b=c.tab.height()+e;c.setHeight(b)},setHeight:function(b){var c=this,d=this.options;c.tab.height(b);c.setContentHeight()},setContentHeight:function(){var c=this,d=this.options;var b=c.tab.height()-c.tab.links.height();c.tab.content.height(b);a("> .l-tab-content-item",c.tab.content).height(b)},getNewTabid:function(){var b=this,c=this.options;b.getnewidcount=b.getnewidcount||0;return"tabitem"+(++b.getnewidcount)},getTabidList:function(c,b){var e=this,f=this.options;var d=[];a("> li",e.tab.links.ul).each(function(){if(a(this).attr("tabid")&&a(this).attr("tabid")!=c&&(!b||a(".l-tab-links-item-close",this).length>0)){d.push(a(this).attr("tabid"))}});return d},removeOther:function(b,f){var d=this,e=this.options;var c=d.getTabidList(b,true);a(c).each(function(){d.removeTabItem(this)})},reload:function(b){var f=this,j=this.options;var d=a(".l-tab-content-item[tabid="+b+"]");var h=a(".l-tab-loading:first",d);var e=a("iframe:first",d);var c=a(e).attr("src");h.show();e.attr("src",c).unbind("load.tab").bind("load.tab",function(){h.hide()})},removeAll:function(e){var c=this,d=this.options;var b=c.getTabidList(null,true);a(b).each(function(){c.removeTabItem(this)})},onResize:function(){var b=this,c=this.options;if(!c.height||typeof(c.height)!="string"||c.height.indexOf("%")==-1){return false}if(b.tab.parent()[0].tagName.toLowerCase()=="body"){var d=a(window).height();d-=parseInt(b.tab.parent().css("paddingTop"));d-=parseInt(b.tab.parent().css("paddingBottom"));b.height=c.heightDiff+d*parseFloat(b.height)*0.01}else{b.height=c.heightDiff+(b.tab.parent().height()*parseFloat(c.height)*0.01)}b.tab.height(b.height);b.setContentHeight()},_menuItemClick:function(c){var b=this,d=this.options;if(!c.id||!b.actionTabid){return}switch(c.id){case"close":if(b.trigger("close")==false){return}b.removeTabItem(b.actionTabid);b.actionTabid=null;break;case"closeother":if(b.trigger("closeother")==false){return}b.removeOther(b.actionTabid);break;case"closeall":if(b.trigger("closeall")==false){return}b.removeAll();b.actionTabid=null;break;case"reload":if(b.trigger("reload",[{tabid:b.actionTabid}])==false){return}b.selectTabItem(b.actionTabid);b.reload(b.actionTabid);break}},_addTabItemContextMenuEven:function(b){var c=this,d=this.options;b.bind("contextmenu",function(f){if(!c.tab.menu){return}c.actionTabid=b.attr("tabid");c.tab.menu.show({top:f.pageY,left:f.pageX});if(a(".l-tab-links-item-close",this).length==0){c.tab.menu.setDisabled("close")}else{c.tab.menu.setEnabled("close")}return false})}})})(jQuery);(function(a){a.fn.ligerTextBox=function(){return a.ligerui.run.call(this,"ligerTextBox",arguments)};a.fn.ligerGetTextBoxManager=function(){return a.ligerui.run.call(this,"ligerGetTextBoxManager",arguments)};a.ligerDefaults.TextBox={onChangeValue:null,onMouseOver:null,onMouseOut:null,onBlur:null,onFocus:null,width:null,disabled:false,value:null,nullText:null,digits:false,number:false,currency:false,readonly:false};a.ligerui.controls.TextBox=function(d,c){a.ligerui.controls.TextBox.base.constructor.call(this,d,c)};a.ligerui.controls.TextBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){a.ligerui.controls.TextBox.base._init.call(this);var c=this,d=this.options;if(!d.width){d.width=a(c.element).width()}if(a(this.element).attr("readonly")){d.readonly=true}else{if(d.readonly){a(this.element).attr("readonly",true)}}},_render:function(){var c=this,d=this.options;c.inputText=a(this.element);c.wrapper=c.inputText.wrap('<div class="l-text"></div>').parent();c.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>');if(!c.inputText.hasClass("l-text-field")){c.inputText.addClass("l-text-field")}this._setEvent();if(d.digits||d.number||d.currency){c.inputText.addClass("l-text-field-number")}c.set(d);c.checkValue()},destroy:function(){var c=this;if(c.wrapper){c.wrapper.remove()}c.options=null;liger.remove(this)},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var f=this,h=this.options;var d=f.inputText.val()||"";if(h.currency){d=d.replace(/\$|\,/g,"")}var c=h.number||h.currency,e=h.digits;if(d!=""&&c&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(d)||e&&!/^\d+$/.test(d)){if(f.value!=null){f.inputText.val(f.value)}else{f.inputText.val("")}h.currency&&f.inputText.val(b(f.value));return}f.value=d;h.currency&&f.inputText.val(b(f.value))},checkNotNull:function(){var c=this,d=this.options;if(d.nullText&&!d.disabled){if(!c.inputText.val()){c.inputText.addClass("l-text-field-null").val(d.nullText)}}},_setEvent:function(){var c=this,d=this.options;c.inputText.bind("blur.textBox",function(){c.trigger("blur");c.checkNotNull();c.checkValue();c.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){c.trigger("focus");if(d.nullText){if(a(this).hasClass("l-text-field-null")){a(this).removeClass("l-text-field-null").val("")}}c.wrapper.addClass("l-text-focus")}).change(function(){c.trigger("changeValue",[this.value])});c.wrapper.hover(function(){c.trigger("mouseOver");c.wrapper.addClass("l-text-over")},function(){c.trigger("mouseOut");c.wrapper.removeClass("l-text-over")})},_setDisabled:function(d){var c=this,e=this.options;if(d){this.inputText.attr("readonly","readonly");this.wrapper.addClass("l-text-disabled")}else{if(!e.readonly){this.inputText.removeAttr("readonly");this.wrapper.removeClass("l-text-disabled")}}},_setWidth:function(c){if(c>20){this.wrapper.css({width:c});this.inputText.css({width:c-4})}},_setHeight:function(c){if(c>10){this.wrapper.height(c);this.inputText.height(c-2)}},_setValue:function(c){if(c!=null){this.inputText.val(c)}},_setLabel:function(e){var d=this,f=this.options;if(!d.labelwrapper){d.labelwrapper=d.wrapper.wrap('<div class="l-labeltext"></div>').parent();var c=a('<div class="l-text-label" style="float:left;">'+e+":&nbsp</div>");d.labelwrapper.prepend(c);d.wrapper.css("float","left");if(!f.labelWidth){f.labelWidth=c.width()}else{d._setLabelWidth(f.labelWidth)}c.height(d.wrapper.height());if(f.labelAlign){d._setLabelAlign(f.labelAlign)}d.labelwrapper.append('<br style="clear:both;" />');d.labelwrapper.width(f.labelWidth+f.width+2)}else{d.labelwrapper.find(".l-text-label").html(e+":&nbsp")}},_setLabelWidth:function(d){var c=this,e=this.options;if(!c.labelwrapper){return}c.labelwrapper.find(".l-text-label").width(d)},_setLabelAlign:function(d){var c=this,e=this.options;if(!c.labelwrapper){return}c.labelwrapper.find(".l-text-label").css("text-align",d)},updateStyle:function(){var c=this,d=this.options;if(c.inputText.attr("readonly")){c.wrapper.addClass("l-text-readonly");d.disabled=true}else{c.wrapper.removeClass("l-text-readonly");d.disabled=false}if(c.inputText.attr("disabled")){c.wrapper.addClass("l-text-disabled");d.disabled=true}else{c.wrapper.removeClass("l-text-disabled");d.disabled=false}if(c.inputText.hasClass("l-text-field-null")&&c.inputText.val()!=d.nullText){c.inputText.removeClass("l-text-field-null")}c.checkValue()}});function b(c){if(!c){return"0.00"}c=c.toString().replace(/\$|\,/g,"");if(isNaN(c)){c="0.00"}sign=(c==(c=Math.abs(c)));c=Math.floor(c*100+0.50000000001);cents=c%100;c=Math.floor(c/100).toString();if(cents<10){cents="0"+cents}for(var d=0;d<Math.floor((c.length-(1+d))/3);d++){c=c.substring(0,c.length-(4*d+3))+","+c.substring(c.length-(4*d+3))}return""+(((sign)?"":"-")+""+c+"."+cents)}})(jQuery);(function(a){a.ligerTip=function(b){return a.ligerui.run.call(null,"ligerTip",arguments)};a.fn.ligerTip=function(b){this.each(function(){var c=a.extend({},a.ligerDefaults.ElementTip,b||{});c.target=c.target||this;if(c.auto||b==undefined){if(!c.content){c.content=this.title;if(c.removeTitle){a(this).removeAttr("title")}}c.content=c.content||this.title;a(this).bind("mouseover.tip",function(){c.x=a(this).offset().left+a(this).width()+(c.distanceX||0);c.y=a(this).offset().top+(c.distanceY||0);a.ligerTip(c)}).bind("mouseout.tip",function(){var d=a.ligerui.managers[this.ligeruitipid];if(d){d.remove()}})}else{if(c.target.ligeruitipid){return}c.x=a(this).offset().left+a(this).width()+(c.distanceX||0);c.y=a(this).offset().top+(c.distanceY||0);c.x=c.x||0;c.y=c.y||0;a.ligerTip(c)}});return a.ligerui.get(this,"ligeruitipid")};a.fn.ligerHideTip=function(b){return this.each(function(){var f=b||{};if(f.isLabel==undefined){f.isLabel=this.tagName.toLowerCase()=="label"&&a(this).attr("for")!=null}var e=this;if(f.isLabel){var c=a("#"+a(this).attr("for"));if(c.length==0){return}e=c[0]}var d=a.ligerui.managers[e.ligeruitipid];if(d){d.remove()}}).unbind("mouseover.tip").unbind("mouseout.tip")};a.fn.ligerGetTipManager=function(){return a.ligerui.get(this)};a.ligerDefaults=a.ligerDefaults||{};a.ligerDefaults.HideTip={};a.ligerDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:true};a.ligerDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:true};a.ligerMethos.Tip={};a.ligerui.controls.Tip=function(b){a.ligerui.controls.Tip.base.constructor.call(this,null,b)};a.ligerui.controls.Tip.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return a.ligerMethos.Tip},_render:function(){var b=this,d=this.options;var c=a('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');b.tip=c;b.tip.attr("id",b.id);if(d.content){a("> .l-verify-tip-content:first",c).html(d.content);c.appendTo("body")}else{return}c.css({left:d.x,top:d.y}).show();d.width&&a("> .l-verify-tip-content:first",c).width(d.width-8);d.height&&a("> .l-verify-tip-content:first",c).width(d.height);eee=d.appendIdTo;if(d.appendIdTo){d.appendIdTo.attr("ligerTipId",b.id)}if(d.target){a(d.target).attr("ligerTipId",b.id);d.target.ligeruitipid=b.id}d.callback&&d.callback(c);b.set(d)},_setContent:function(b){a("> .l-verify-tip-content:first",this.tip).html(b)},remove:function(){if(this.options.appendIdTo){this.options.appendIdTo.removeAttr("ligerTipId")}if(this.options.target){a(this.options.target).removeAttr("ligerTipId");this.options.target.ligeruitipid=null}this.tip.remove()}})})(jQuery);(function(a){a.fn.ligerToolBar=function(b){return a.ligerui.run.call(this,"ligerToolBar",arguments)};a.fn.ligerGetToolBarManager=function(){return a.ligerui.run.call(this,"ligerGetToolBarManager",arguments)};a.ligerDefaults.ToolBar={};a.ligerMethos.ToolBar={};a.ligerui.controls.ToolBar=function(c,b){a.ligerui.controls.ToolBar.base.constructor.call(this,c,b)};a.ligerui.controls.ToolBar.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return a.ligerMethos.ToolBar},_render:function(){var b=this,c=this.options;b.toolbarItemCount=0;b.toolBar=a(this.element);b.toolBar.addClass("l-toolbar");b.set(c)},_setItems:function(b){var c=this;c.toolBar.html("");a(b).each(function(d,e){c.addItem(e)})},removeItem:function(c){var b=this,d=this.options;a("> .l-toolbar-item[toolbarid="+c+"]",b.toolBar).remove()},setEnabled:function(c){var b=this,d=this.options;a("> .l-toolbar-item[toolbarid="+c+"]",b.toolBar).removeClass("l-toolbar-item-disable")},setDisabled:function(c){var b=this,d=this.options;a("> .l-toolbar-item[toolbarid="+c+"]",b.toolBar).addClass("l-toolbar-item-disable")},isEnable:function(c){var b=this,d=this.options;return !a("> .l-toolbar-item[toolbarid="+c+"]",b.toolBar).hasClass("l-toolbar-item-disable")},addItem:function(d){var c=this,e=this.options;if(d.line){c.toolBar.append('<div class="l-bar-separator"></div>');return}var b=a('<div class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>');c.toolBar.append(b);if(!d.id){d.id="item-"+(++c.toolbarItemCount)}b.attr("toolbarid",d.id);if(d.img){b.append("<img src='"+d.img+"' />");b.addClass("l-toolbar-item-hasicon")}else{if(d.icon){b.append("<div class='l-icon l-icon-"+d.icon+"'></div>");b.addClass("l-toolbar-item-hasicon")}else{if(d.color){b.append("<div class='l-toolbar-item-color' style='background:"+d.color+"'></div>");b.addClass("l-toolbar-item-hasicon")}}}d.text&&a("span:first",b).html(d.text);d.disable&&b.addClass("l-toolbar-item-disable");d.click&&b.click(function(){if(a(this).hasClass("l-toolbar-item-disable")){return}d.click(d)});if(d.menu){d.menu=a.ligerMenu(d.menu);b.hover(function(){if(a(this).hasClass("l-toolbar-item-disable")){return}c.actionMenu&&c.actionMenu.hide();var g=a(this).offset().left;var f=a(this).offset().top+a(this).height();d.menu.show({top:f,left:g});c.actionMenu=d.menu;a(this).addClass("l-panel-btn-over")},function(){if(a(this).hasClass("l-toolbar-item-disable")){return}a(this).removeClass("l-panel-btn-over")})}else{b.hover(function(){if(a(this).hasClass("l-toolbar-item-disable")){return}a(this).addClass("l-panel-btn-over")},function(){if(a(this).hasClass("l-toolbar-item-disable")){return}a(this).removeClass("l-panel-btn-over")})}}});a.ligerui.controls.ToolBar.prototype.setEnable=a.ligerui.controls.ToolBar.prototype.setEnabled;a.ligerui.controls.ToolBar.prototype.setDisable=a.ligerui.controls.ToolBar.prototype.setDisabled})(jQuery);(function(a){a.fn.ligerTree=function(b){return a.ligerui.run.call(this,"ligerTree",arguments)};a.fn.ligerGetTreeManager=function(){return a.ligerui.run.call(this,"ligerGetTreeManager",arguments)};a.ligerDefaults.Tree={url:null,data:null,checkbox:true,autoCheckboxEven:true,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:true,nodeWidth:90,statusName:"__status",isLeaf:null,single:false,needCancel:true,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:true,iconFieldName:"icon",nodeDraggable:false,nodeDraggingRender:null,btnClickToToggleOnly:true,ajaxType:"post",render:null,selectable:null,isExpand:null,delay:null};a.ligerui.controls.Tree=function(c,b){a.ligerui.controls.Tree.base.constructor.call(this,c,b)};a.ligerui.controls.Tree.ligerExtend(a.ligerui.core.UIComponent,{_init:function(){a.ligerui.controls.Tree.base._init.call(this);var b=this,c=this.options;if(c.single){c.autoCheckboxEven=false}},_render:function(){var b=this,c=this.options;b.set(c,true);b.tree=a(b.element);b.tree.addClass("l-tree");b.toggleNodeCallbacks=[];b.sysAttribute=["isexpand","ischecked","href","style","delay"];b.loading=a("<div class='l-tree-loading'></div>");b.tree.after(b.loading);b.data=[];b.maxOutlineLevel=1;b.treedataindex=0;b._applyTree();b._setTreeEven();b.set(c,false)},_setTreeLine:function(b){if(b){this.tree.removeClass("l-tree-noline")}else{this.tree.addClass("l-tree-noline")}},_setParms:function(){var b=this,c=this.options;if(a.isFunction(c.parms)){c.parms=c.parms()}},_setUrl:function(b){var c=this,d=this.options;if(b){c.clear();c.loadData(null,b)}},_setData:function(b){if(b){this.clear();this.append(null,b)}},setData:function(b){this.set("data",b)},getData:function(){return this.data},hasChildren:function(b){if(this.options.isLeaf){return !this.options.isLeaf(b)}return b.children?true:false},getParent:function(f,e){var d=this;f=d.getNodeDom(f);var c=d.getParentTreeItem(f,e);if(!c){return null}var b=a(c).attr("treedataindex");return d._getDataNodeByTreeDataIndex(b)},getParentTreeItem:function(j,h){var d=this;j=d.getNodeDom(j);var f=a(j);if(f.parent().hasClass("l-tree")){return null}if(h==undefined){if(f.parent().parent("li").length==0){return null}return f.parent().parent("li")[0]}var e=parseInt(f.attr("outlinelevel"));var c=f;for(var b=e-1;b>=h;b--){c=c.parent().parent("li")}return c[0]},getChecked:function(){var c=this,d=this.options;if(!this.options.checkbox){return null}var b=[];a(".l-checkbox-checked",c.tree).parent().parent("li").each(function(){var e=parseInt(a(this).attr("treedataindex"));b.push({target:this,data:c._getDataNodeByTreeDataIndex(c.data,e)})});return b},refreshTree:function(){var b=this,c=this.options;a.each(this.getChecked(),function(e,d){b._setParentCheckboxStatus(a(d.target))})},getSelected:function(){var c=this,e=this.options;var b={};b.target=a(".l-selected",c.tree).parent("li")[0];if(b.target){var d=parseInt(a(b.target).attr("treedataindex"));b.data=c._getDataNodeByTreeDataIndex(c.data,d);return b}return null},upgrade:function(c){var b=this,d=this.options;a(".l-note",c).each(function(){a(this).removeClass("l-note").addClass("l-expandable-open")});a(".l-note-last",c).each(function(){a(this).removeClass("l-note-last").addClass("l-expandable-open")});a("."+b._getChildNodeClassName(),c).each(function(){a(this).removeClass(b._getChildNodeClassName()).addClass(b._getParentNodeClassName(true))})},demotion:function(c){var b=this,d=this.options;if(!c&&c[0].tagName.toLowerCase()!="li"){return}var e=a(c).hasClass("l-last");a(".l-expandable-open",c).each(function(){a(this).removeClass("l-expandable-open").addClass(e?"l-note-last":"l-note")});a(".l-expandable-close",c).each(function(){a(this).removeClass("l-expandable-close").addClass(e?"l-note-last":"l-note")});a("."+b._getParentNodeClassName(true),c).each(function(){a(this).removeClass(b._getParentNodeClassName(true)).addClass(b._getChildNodeClassName())})},collapseAll:function(){var b=this,c=this.options;a(".l-expandable-open",b.tree).click()},expandAll:function(){var b=this,c=this.options;a(".l-expandable-close",b.tree).click()},loadData:function(f,c,k,j){var d=this,h=this.options;j=a.extend({showLoading:function(){d.loading.show()},hideLoading:function(){d.loading.hide()}},j||{});var b=h.ajaxType;k=k||[];a.ajax({type:b,url:c,data:k,dataType:"json",beforeSend:function(){j.showLoading()},success:function(e){if(!e){return}j.hideLoading();d.append(f,e);d.trigger("success",[e])},error:function(g,o,n){try{m.hideLoading();d.trigger("error",[g,o,n])}catch(m){}}})},clear:function(){var b=this,c=this.options;b.toggleNodeCallbacks=[];b.data=null;b.data=[];b.nodes=null;b.tree.html("")},getNodeDom:function(c){var b=this,d=this.options;if(c==null){return c}if(typeof(c)=="string"||typeof(c)=="number"){return a("li[treedataindex="+c+"]",b.tree).get(0)}else{if(typeof(c)=="object"&&"treedataindex" in c){return b.getNodeDom(c.treedataindex)}}return c},hide:function(c){var b=this,d=this.options;c=b.getNodeDom(c);if(c){a(c).hide()}},show:function(c){var b=this,d=this.options;c=b.getNodeDom(c);if(c){a(c).show()}},remove:function(f){var c=this,h=this.options;f=c.getNodeDom(f);var e=parseInt(a(f).attr("treedataindex"));var d=c._getDataNodeByTreeDataIndex(c.data,e);if(d){c._setTreeDataStatus([d],"delete")}var b=c.getParentTreeItem(f);if(h.checkbox){c._setParentCheckboxStatus(a(f))}a(f).remove();c._updateStyle(b?a("ul:first",b):c.tree)},_updateStyle:function(b){var c=this,e=this.options;var f=a(" > li",b);var d=f.length;if(!d){return}f.each(function(g,h){if(g==0&&!a(this).hasClass("l-first")){a(this).addClass("l-first")}if(g==d-1&&!a(this).hasClass("l-last")){a(this).addClass("l-last")}if(g==0&&g==d-1){a(this).addClass("l-onlychild")}a("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(g==d-1?"l-note-last":"l-note");c._setTreeItem(this,{isLast:g==d-1})})},update:function(h,c){var d=this,f=this.options;h=d.getNodeDom(h);var e=parseInt(a(h).attr("treedataindex"));nodedata=d._getDataNodeByTreeDataIndex(d.data,e);for(var b in c){nodedata[b]=c[b];if(b==f.textFieldName){a("> .l-body > span",h).text(c[b])}}},append:function(j,o,m,r){var k=this,c=this.options;j=k.getNodeDom(j);if(k.trigger("beforeAppend",[j,o])==false){return false}if(!o||!o.length){return false}if(c.idFieldName&&c.parentIDFieldName){o=k.arrayToTree(o,c.idFieldName,c.parentIDFieldName)}k._addTreeDataIndexToData(o);k._setTreeDataStatus(o,"add");if(m!=null){m=k.getNodeDom(m)}k.trigger("append",[j,o]);k._appendData(j,o);if(j==null){var d=k._getTreeHTMLByData(o,1,[],true);d[d.length-1]=d[0]="";if(m!=null){a(m)[r?"after":"before"](d.join(""));k._updateStyle(j?a("ul:first",j):k.tree)}else{if(a("> li:last",k.tree).length>0){k._setTreeItem(a("> li:last",k.tree)[0],{isLast:false})}k.tree.append(d.join(""))}a(".l-body",k.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});k._upadteTreeWidth();k.trigger("afterAppend",[j,o]);return}var b=a(j);var q=parseInt(b.attr("outlinelevel"));var h=a("> ul",b).length>0;if(!h){b.append("<ul class='l-children'></ul>");k.upgrade(j)}var f=[];for(var e=1;e<=q-1;e++){var n=a(k.getParentTreeItem(j,e));f.push(n.hasClass("l-last"))}f.push(b.hasClass("l-last"));var d=k._getTreeHTMLByData(o,q+1,f,true);d[d.length-1]=d[0]="";if(m!=null){a(m)[r?"after":"before"](d.join(""));k._updateStyle(j?a("ul:first",j):k.tree)}else{if(a("> .l-children > li:last",b).length>0){k._setTreeItem(a("> .l-children > li:last",b)[0],{isLast:false})}a(">.l-children",j).append(d.join(""))}k._upadteTreeWidth();a(">.l-children .l-body",j).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});k.trigger("afterAppend",[j,o])},cancelSelect:function(d){var c=this,j=this.options;var b=c.getNodeDom(d);var k=a(b);var f=parseInt(k.attr("treedataindex"));var e=c._getDataNodeByTreeDataIndex(c.data,f);var h=a(">div:first",k);if(j.checkbox){a(".l-checkbox",h).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked")}else{h.removeClass("l-selected")}c.trigger("cancelSelect",[{data:e,target:k[0]}])},selectNode:function(c){var b=this,j=this.options;var h=null;if(typeof(c)=="function"){h=c}else{if(typeof(c)=="object"){var k=a(c);var e=parseInt(k.attr("treedataindex"));var d=b._getDataNodeByTreeDataIndex(b.data,e);var f=a(">div:first",k);if(j.checkbox){a(".l-checkbox",f).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked")}else{f.addClass("l-selected")}b.trigger("select",[{data:d,target:k[0]}]);return}else{h=function(g){if(!g[j.idFieldName]){return false}return g[j.idFieldName].toString()==c.toString()}}}a("li",b.tree).each(function(){var n=a(this);var m=parseInt(n.attr("treedataindex"));var g=b._getDataNodeByTreeDataIndex(b.data,m);if(h(g,m)){b.selectNode(this)}else{b.cancelSelect(this)}})},getTextByID:function(e){var b=this,d=this.options;var c=b.getDataByID(e);if(!c){return null}return c[d.textFieldName]},getDataByID:function(e){var b=this,d=this.options;var c=null;a("li",b.tree).each(function(){if(c){return}var h=a(this);var g=parseInt(h.attr("treedataindex"));var f=b._getDataNodeByTreeDataIndex(b.data,g);if(f[d.idFieldName].toString()==e.toString()){c=f}});return c},arrayToTree:function(f,b,h){if(!f||!f.length){return[]}var m=[];var d={};var j=f.length;for(var g=0;g<j;g++){var c=f[g];d[c[b]]=c}for(var g=0;g<j;g++){var e=f[g];var k=d[e[h]];if(!k){m.push(e);continue}k.children=k.children||[];k.children.push(e)}return m},_getDataNodeByTreeDataIndex:function(e,d){var c=this,f=this.options;for(var b=0;b<e.length;b++){if(e[b].treedataindex==d){return e[b]}if(e[b].children){var h=c._getDataNodeByTreeDataIndex(e[b].children,d);if(h){return h}}}return null},_setTreeDataStatus:function(d,b){var c=this,e=this.options;a(d).each(function(){this[e.statusName]=b;if(this.children){c._setTreeDataStatus(this.children,b)}})},_addTreeDataIndexToData:function(c){var b=this,d=this.options;a(c).each(function(){if(this.treedataindex!=undefined){return}this.treedataindex=b.treedataindex++;if(this.children){b._addTreeDataIndexToData(this.children)}})},_addToNodes:function(c){var b=this,d=this.options;b.nodes=b.nodes||[];b.nodes.push(c);if(!c.children){return}a(c.children).each(function(e,f){b._addToNodes(f)})},_appendData:function(f,e){var b=this,h=this.options;var d=parseInt(a(f).attr("treedataindex"));var c=b._getDataNodeByTreeDataIndex(b.data,d);if(b.treedataindex==undefined){b.treedataindex=0}if(c&&c.children==undefined){c.children=[]}a(e).each(function(g,j){if(c){c.children[c.children.length]=j}else{b.data[b.data.length]=j}b._addToNodes(j)})},_setTreeItem:function(f,c){var d=this,h=this.options;if(!c){return}f=d.getNodeDom(f);var e=a(f);var b=parseInt(e.attr("outlinelevel"));if(c.isLast!=undefined){if(c.isLast==true){e.removeClass("l-last").addClass("l-last");a("> div .l-note",e).removeClass("l-note").addClass("l-note-last");a(".l-children li",e).find(".l-box:eq("+(b-1)+")").removeClass("l-line")}else{if(c.isLast==false){e.removeClass("l-last");a("> div .l-note-last",e).removeClass("l-note-last").addClass("l-note");a(".l-children li",e).find(".l-box:eq("+(b-1)+")").removeClass("l-line").addClass("l-line")}}}},_upadteTreeWidth:function(){var b=this,c=this.options;var d=b.maxOutlineLevel*22;if(c.checkbox){d+=22}if(c.parentIcon||c.childIcon){d+=22}d+=c.nodeWidth;b.tree.width(d)},_getChildNodeClassName:function(){var b=this,c=this.options;return"l-tree-icon-"+c.childIcon},_getParentNodeClassName:function(c){var d=this,e=this.options;var b="l-tree-icon-"+e.parentIcon;if(c){b+="-open"}return b},_isExpand:function(e,f){var c=this,d=this.options;var b=e.isExpand!=null?e.isExpand:(e.isexpand!=null?e.isexpand:d.isExpand);if(b==null){return true}if(typeof(b)=="function"){b=d.isExpand({data:e,level:f})}if(typeof(b)=="boolean"){return b}if(typeof(b)=="string"){return b=="true"}if(typeof(b)=="number"){return b>f}return true},_getDelay:function(e,f){var c=this,d=this.options;var b=e.delay!=null?e.delay:d.delay;if(b==null){return false}if(typeof(b)=="function"){b=b({data:e,level:f})}if(typeof(b)=="boolean"){return b}if(typeof(b)=="string"){return{url:b}}if(typeof(b)=="number"){b=[b]}if(a.isArray(b)){return a.inArray(f,b)!=-1}if(typeof(b)=="object"&&b.url){return b}return false},_getTreeHTMLByData:function(q,w,r,t){var u=this,c=this.options;if(u.maxOutlineLevel<w){u.maxOutlineLevel=w}r=r||[];w=w||1;var x=[];if(!t){x.push('<ul class="l-children" style="display:none">')}else{x.push("<ul class='l-children'>")}for(var s=0;s<q.length;s++){var d=q[s];var m=s==0;var f=s==q.length-1;var n=u._getDelay(d,w);var v=n?false:u._isExpand(d,w);x.push("<li ");if(d.treedataindex!=undefined){x.push('treedataindex="'+d.treedataindex+'" ')}if(v){x.push("isexpand="+d.isexpand+" ")}x.push("outlinelevel="+w+" ");for(var h=0;h<u.sysAttribute.length;h++){if(a(this).attr(u.sysAttribute[h])){q[dataindex][u.sysAttribute[h]]=a(this).attr(u.sysAttribute[h])}}for(var h=0;h<c.attribute.length;h++){if(d[c.attribute[h]]){x.push(c.attribute[h]+'="'+d[c.attribute[h]]+'" ')}}x.push('class="');m&&x.push("l-first ");f&&x.push("l-last ");m&&f&&x.push("l-onlychild ");x.push('"');x.push(">");x.push('<div class="l-body');if(c.selectable&&c.selectable(d)==false){x.push(" l-unselectable")}x.push('">');for(var e=0;e<=w-2;e++){if(r[e]){x.push('<div class="l-box"></div>')}else{x.push('<div class="l-box l-line"></div>')}}if(u.hasChildren(d)){if(v){x.push('<div class="l-box l-expandable-open"></div>')}else{x.push('<div class="l-box l-expandable-close"></div>')}if(c.checkbox){if(d.ischecked){x.push('<div class="l-box l-checkbox l-checkbox-checked"></div>')}else{x.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')}}if(c.parentIcon){x.push('<div class="l-box l-tree-icon ');x.push(u._getParentNodeClassName(v?true:false)+" ");if(c.iconFieldName&&d[c.iconFieldName]){x.push("l-tree-icon-none")}x.push('">');if(c.iconFieldName&&d[c.iconFieldName]){x.push('<img src="'+d[c.iconFieldName]+'" />')}x.push("</div>")}}else{if(f){x.push('<div class="l-box l-note-last"></div>')}else{x.push('<div class="l-box l-note"></div>')}if(c.checkbox){if(d.ischecked){x.push('<div class="l-box l-checkbox l-checkbox-checked"></div>')}else{x.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')}}if(c.childIcon){x.push('<div class="l-box l-tree-icon ');x.push(u._getChildNodeClassName()+" ");if(c.iconFieldName&&d[c.iconFieldName]){x.push("l-tree-icon-none")}x.push('">');if(c.iconFieldName&&d[c.iconFieldName]){x.push('<img src="'+d[c.iconFieldName]+'" />')}x.push("</div>")}}if(c.render){x.push("<span>"+c.render(d,d[c.textFieldName])+"</span>")}else{x.push("<span>"+d[c.textFieldName]+"</span>")}x.push("</div>");if(u.hasChildren(d)){var b=[];for(var e=0;e<r.length;e++){b.push(r[e])}b.push(f);if(n){if(n==true){u.toggleNodeCallbacks.push({data:d,callback:function(k,j){var g=u._getTreeHTMLByData(j.children,w+1,b,v).join("");a(k).append(g);a(">.l-children .l-body",k).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")});u._removeToggleNodeCallback(j)}})}else{if(n.url){(function(k,g,j){u.toggleNodeCallbacks.push({data:k,callback:function(z,y){u.loadData(z,g,j,{showLoading:function(){a("div.l-expandable-close:first",z).addClass("l-box-loading")},hideLoading:function(){a("div.l-box-loading:first",z).removeClass("l-box-loading")}});u._removeToggleNodeCallback(y)}})})(d,n.url,n.parms)}}}else{x.push(u._getTreeHTMLByData(d.children,w+1,b,v).join(""))}}x.push("</li>")}x.push("</ul>");return x},_removeToggleNodeCallback:function(b){var d=this,e=this.options;for(var c=0;c<=d.toggleNodeCallbacks.length;c++){if(d.toggleNodeCallbacks[c]&&d.toggleNodeCallbacks[c].data==b){d.toggleNodeCallbacks.splice(c,1);break}}},_getDataByTreeHTML:function(d){var b=this,e=this.options;var c=[];a("> li",d).each(function(g,h){var k=c.length;c[k]={treedataindex:b.treedataindex++};c[k][e.textFieldName]=a("> span,> a",this).html();for(var f=0;f<b.sysAttribute.length;f++){if(a(this).attr(b.sysAttribute[f])){c[k][b.sysAttribute[f]]=a(this).attr(b.sysAttribute[f])}}for(var f=0;f<e.attribute.length;f++){if(a(this).attr(e.attribute[f])){c[k][e.attribute[f]]=a(this).attr(e.attribute[f])}}if(a("> ul",this).length>0){c[k].children=b._getDataByTreeHTML(a("> ul",this))}});return c},_applyTree:function(){var c=this,d=this.options;c.data=c._getDataByTreeHTML(c.tree);var b=c._getTreeHTMLByData(c.data,1,[],true);b[b.length-1]=b[0]="";c.tree.html(b.join(""));c._upadteTreeWidth();a(".l-body",c.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_getSrcElementByEvent:function(m){var f=this;var k=(m.target||m.srcElement);var b=k.tagName.toLowerCase();var j=a(k).parents().add(k);var c=function(g){for(var e=j.length-1;e>=0;e--){if(a(j[e]).hasClass(g)){return j[e]}}return null};if(j.index(this.element)==-1){return{out:true}}var d={tree:c("l-tree"),node:c("l-body"),checkbox:c("l-checkbox"),icon:c("l-tree-icon"),text:b=="span"};if(d.node){var h=parseInt(a(d.node).parent().attr("treedataindex"));d.data=f._getDataNodeByTreeDataIndex(f.data,h)}return d},_setTreeEven:function(){var b=this,c=this.options;if(b.hasBind("contextmenu")){b.tree.bind("contextmenu",function(h){var g=(h.target||h.srcElement);var j=null;if(g.tagName.toLowerCase()=="a"||g.tagName.toLowerCase()=="span"||a(g).hasClass("l-box")){j=a(g).parent().parent()}else{if(a(g).hasClass("l-body")){j=a(g).parent()}else{if(g.tagName.toLowerCase()=="li"){j=a(g)}}}if(!j){return}var f=parseInt(j.attr("treedataindex"));var d=b._getDataNodeByTreeDataIndex(b.data,f);return b.trigger("contextmenu",[{data:d,target:j[0]},h])})}b.tree.click(function(k){var j=(k.target||k.srcElement);var n=null;if(j.tagName.toLowerCase()=="a"||j.tagName.toLowerCase()=="span"||a(j).hasClass("l-box")){n=a(j).parent().parent()}else{if(a(j).hasClass("l-body")){n=a(j).parent()}else{n=a(j)}}if(!n){return}var h=parseInt(n.attr("treedataindex"));var g=b._getDataNodeByTreeDataIndex(b.data,h);var f=a("div.l-body:first",n).find("div.l-expandable-open:first,div.l-expandable-close:first");var d=a(j).hasClass("l-expandable-open")||a(j).hasClass("l-expandable-close");if(!a(j).hasClass("l-checkbox")&&!d){if(!n.hasClass("l-unselectable")){if(a(">div:first",n).hasClass("l-selected")&&c.needCancel){if(b.trigger("beforeCancelSelect",[{data:g,target:n[0]}])==false){return false}a(">div:first",n).removeClass("l-selected");b.trigger("cancelSelect",[{data:g,target:n[0]}])}else{if(b.trigger("beforeSelect",[{data:g,target:n[0]}])==false){return false}a(".l-body",b.tree).removeClass("l-selected");a(">div:first",n).addClass("l-selected");b.trigger("select",[{data:g,target:n[0]}])}}}if(a(j).hasClass("l-checkbox")){if(c.autoCheckboxEven){if(a(j).hasClass("l-checkbox-unchecked")){a(j).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");a(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");b.trigger("check",[{data:g,target:n[0]},true])}else{if(a(j).hasClass("l-checkbox-checked")){a(j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");a(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:g,target:n[0]},false])}else{if(a(j).hasClass("l-checkbox-incomplete")){a(j).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked");a(".l-children .l-checkbox",n).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked");b.trigger("check",[{data:g,target:n[0]},true])}}}b._setParentCheckboxStatus(n)}else{if(a(j).hasClass("l-checkbox-unchecked")){a(j).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked");if(c.single){a(".l-checkbox",b.tree).not(j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked")}b.trigger("check",[{data:g,target:n[0]},true])}else{if(a(j).hasClass("l-checkbox-checked")){a(j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked");b.trigger("check",[{data:g,target:n[0]},false])}}}}else{if(f.hasClass("l-expandable-open")&&(!c.btnClickToToggleOnly||d)){if(b.trigger("beforeCollapse",[{data:g,target:n[0]}])==false){return false}f.removeClass("l-expandable-open").addClass("l-expandable-close");if(c.slide){a("> .l-children",n).slideToggle("fast")}else{a("> .l-children",n).hide()}a("> div ."+b._getParentNodeClassName(true),n).removeClass(b._getParentNodeClassName(true)).addClass(b._getParentNodeClassName());b.trigger("collapse",[{data:g,target:n[0]}])}else{if(f.hasClass("l-expandable-close")&&(!c.btnClickToToggleOnly||d)){if(b.trigger("beforeExpand",[{data:g,target:n[0]}])==false){return false}a(b.toggleNodeCallbacks).each(function(){if(this.data==g){this.callback(n[0],g)}});f.removeClass("l-expandable-close").addClass("l-expandable-open");var m=function(){b.trigger("expand",[{data:g,target:n[0]}])};if(c.slide){a("> .l-children",n).slideToggle("fast",m)}else{a("> .l-children",n).show();m()}a("> div ."+b._getParentNodeClassName(),n).removeClass(b._getParentNodeClassName()).addClass(b._getParentNodeClassName(true))}}}b.trigger("click",[{data:g,target:n[0]}])});if(a.fn.ligerDrag&&c.nodeDraggable){b.nodeDroptip=a("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body");b.tree.ligerDrag({revert:true,animate:false,proxyX:20,proxyY:20,proxy:function(d,m){var n=b._getSrcElementByEvent(m);if(n.node){var k="dragging";if(c.nodeDraggingRender){k=c.nodeDraggingRender(d.draggingNodes,d,b)}else{k="";var h=false;for(var g in d.draggingNodes){var j=d.draggingNodes[g];if(h){k+=","}k+=j.text;h=true}}var f=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+k+"</div>").appendTo("body");return f}},onRevert:function(){return false},onRendered:function(){this.set("cursor","default");b.children[this.id]=this},onStartDrag:function(h,g){if(g.button==2){return false}this.set("cursor","default");var j=b._getSrcElementByEvent(g);if(j.checkbox){return false}if(c.checkbox){var f=b.getChecked();this.draggingNodes=[];for(var d in f){this.draggingNodes.push(f[d].data)}if(!this.draggingNodes||!this.draggingNodes.length){return false}}else{this.draggingNodes=[j.data]}this.draggingNode=j.data;this.set("cursor","move");b.nodedragging=true;this.validRange={top:b.tree.offset().top,bottom:b.tree.offset().top+b.tree.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()}},onDrag:function(r,s){var u=this.draggingNode;if(!u){return false}var f=this.draggingNodes?this.draggingNodes:[u];if(b.nodeDropIn==null){b.nodeDropIn=-1}var m=s.pageX;var h=s.pageY;var v=false;var w=this.validRange;if(m<w.left||m>w.right||h>w.bottom||h<w.top){b.nodeDropIn=-1;b.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no");return}for(var n=0,g=b.nodes.length;n<g;n++){var k=b.nodes[n];var q=k.treedataindex;if(u.treedataindex==q){v=true}if(a.inArray(k,f)!=-1){continue}var x=v?true:false;if(b.nodeDropIn!=-1&&b.nodeDropIn!=q){continue}var d=a("li[treedataindex="+q+"] div:first",b.tree);var j=d.offset();var o={top:j.top,bottom:j.top+d.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()};if(m>o.left&&m<o.right&&h>o.top&&h<o.bottom){var t=j.top;if(x){t+=d.height()}b.nodeDroptip.css({left:o.left,top:t,width:o.right-o.left}).show();b.nodeDropIn=q;b.nodeDropDir=x?"bottom":"top";if(h>o.top+7&&h<o.bottom-7){this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add");b.nodeDroptip.hide();b.nodeDropInParent=true}else{this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes");b.nodeDroptip.show();b.nodeDropInParent=false}break}else{if(b.nodeDropIn!=-1){b.nodeDropIn=-1;b.nodeDropInParent=false;b.nodeDroptip.hide();this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no")}}}},onStopDrag:function(k,j){var d=this.draggingNodes;b.nodedragging=false;if(b.nodeDropIn!=-1){for(var g=0;g<d.length;g++){var f=d[g].children;if(f){d=a.grep(d,function(m,e){var n=a.inArray(m,f)==-1;return n})}}for(var g in d){var h=d[g];if(b.nodeDropInParent){b.remove(h);b.append(b.nodeDropIn,[h])}else{b.remove(h);b.append(b.getParent(b.nodeDropIn),[h],b.nodeDropIn,b.nodeDropDir=="bottom")}}b.nodeDropIn=-1}b.nodeDroptip.hide();this.set("cursor","default")}})}},_setParentCheckboxStatus:function(f){var d=this,e=this.options;var b=a(".l-checkbox-unchecked",f.parent()).length==0;var c=a(".l-checkbox-checked",f.parent()).length==0;if(b){f.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked")}else{if(c){f.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked")}else{f.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete")}}if(f.parent().parent("li").length>0){d._setParentCheckboxStatus(f.parent().parent("li"))}}})})(jQuery);(function(b){var a=b.ligerui;a.windowCount=0;b.ligerWindow=function(c){return a.run.call(null,"ligerWindow",arguments,{isStatic:true})};b.ligerWindow.show=function(c){return b.ligerWindow(c)};b.ligerDefaults.Window={showClose:true,showMax:true,showToggle:true,showMin:true,title:"window",load:false,onLoaded:null,onClose:null,onRegain:null,onMax:null,modal:false};b.ligerMethos.Window={};a.controls.Window=function(c){a.controls.Window.base.constructor.call(this,null,c)};a.controls.Window.ligerExtend(a.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return b.ligerMethos.Window},_render:function(){var f=this,k=this.options;f.window=b('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>');f.element=f.window[0];f.window.content=b(".l-window-content",f.window);f.window.header=b(".l-window-header",f.window);f.window.buttons=b(".l-window-header-buttons:first",f.window);if(k.url){if(k.load){f.window.content.load(k.url,function(){f.trigger("loaded")});f.window.content.addClass("l-window-content-scroll")}else{var d=b("<iframe frameborder='0' src='"+k.url+"'></iframe>");var c="ligeruiwindow"+a.windowCount++;if(k.name){c=k.name}d.attr("name",c).attr("id",c);k.framename=c;d.appendTo(f.window.content);f.iframe=d}}else{if(k.content){var e=b("<div>"+k.content+"</div>");e.appendTo(f.window.content)}else{if(k.target){f.window.content.append(k.target);k.target.show()}}}this.mask();f.active();b("body").append(f.window);f.set({width:k.width,height:k.height});var j=0;var h=0;if(k.left!=null){j=k.left}else{k.left=j=0.5*(b(window).width()-f.window.width())}if(k.top!=null){h=k.top}else{k.top=h=0.5*(b(window).height()-f.window.height())+b(window).scrollTop()-10}if(j<0){k.left=j=0}if(h<0){k.top=h=0}f.set(k);k.framename&&b(">iframe",f.window.content).attr("name",k.framename);if(!k.showToggle){b(".l-window-toggle",f.window).remove()}if(!k.showMax){b(".l-window-max",f.window).remove()}if(!k.showClose){b(".l-window-close",f.window).remove()}f._saveStatus();if(b.fn.ligerDrag){f.draggable=f.window.drag=f.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){f.active()},onStopDrag:function(){f._saveStatus()},animate:false})}if(b.fn.ligerResizable){f.resizeable=f.window.resizable=f.window.ligerResizable({onStartResize:function(){f.active();b(".l-window-max",f.window).removeClass("l-window-regain")},onStopResize:function(o,n){var m=0;var g=0;if(!isNaN(parseInt(f.window.css("top")))){m=parseInt(f.window.css("top"))}if(!isNaN(parseInt(f.window.css("left")))){g=parseInt(f.window.css("left"))}if(o.diffTop){f.window.css({top:m+o.diffTop})}if(o.diffLeft){f.window.css({left:g+o.diffLeft})}if(o.newWidth){f.window.width(o.newWidth)}if(o.newHeight){f.window.content.height(o.newHeight-28)}f._saveStatus();return false}});f.window.append("<div class='l-btn-nw-drop'></div>")}b(".l-window-toggle",f.window).click(function(){if(b(this).hasClass("l-window-toggle-close")){f.collapsed=false;b(this).removeClass("l-window-toggle-close")}else{f.collapsed=true;b(this).addClass("l-window-toggle-close")}f.window.content.slideToggle()}).hover(function(){if(f.window.drag){f.window.drag.set("disabled",true)}},function(){if(f.window.drag){f.window.drag.set("disabled",false)}});b(".l-window-close",f.window).click(function(){if(f.trigger("close")==false){return false}f.window.hide();a.win.removeTask(f)}).hover(function(){if(f.window.drag){f.window.drag.set("disabled",true)}},function(){if(f.window.drag){f.window.drag.set("disabled",false)}});b(".l-window-max",f.window).click(function(){if(b(this).hasClass("l-window-regain")){if(f.trigger("regain")==false){return false}f.window.width(f._width).css({left:f._left,top:f._top});f.window.content.height(f._height-28);b(this).removeClass("l-window-regain")}else{if(f.trigger("max")==false){return false}f.window.width(b(window).width()-2).css({left:0,top:0});f.window.content.height(b(window).height()-28).show();b(this).addClass("l-window-regain")}})},_saveStatus:function(){var c=this;c._width=c.window.width();c._height=c.window.height();var e=0;var d=0;if(!isNaN(parseInt(c.window.css("top")))){e=parseInt(c.window.css("top"))}if(!isNaN(parseInt(c.window.css("left")))){d=parseInt(c.window.css("left"))}c._top=e;c._left=d},min:function(){this.window.hide();this.minimize=true;this.actived=false},_setShowMin:function(d){var c=this,e=this.options;if(d){if(!c.winmin){c.winmin=b('<div class="l-window-min"></div>').prependTo(c.window.buttons).click(function(){c.min()});a.win.addTask(c)}}else{if(c.winmin){c.winmin.remove();c.winmin=null}}},_setLeft:function(c){if(c!=null){this.window.css({left:c})}},_setTop:function(c){if(c!=null){this.window.css({top:c})}},_setWidth:function(c){if(c>0){this.window.width(c)}},_setHeight:function(c){if(c>28){this.window.content.height(c-28)}},_setTitle:function(c){if(c){b(".l-window-header-inner",this.window.header).html(c)}},_setUrl:function(c){var d=this,e=this.options;e.url=c;if(e.load){d.window.content.html("").load(e.url,function(){if(d.trigger("loaded")==false){return false}})}else{if(d.jiframe){d.jiframe.attr("src",e.url)}}},hide:function(){var c=this,d=this.options;this.unmask();this.window.hide()},show:function(){var c=this,d=this.options;this.mask();this.window.show()},remove:function(){var c=this,d=this.options;this.unmask();this.window.remove()},active:function(){var e=this,j=this.options;if(e.minimize){var d=e._width,c=e._height,h=e._left,f=e._top;if(e.maximum){d=b(window).width();c=b(window).height();h=f=0;if(a.win.taskbar){c-=a.win.taskbar.outerHeight();if(a.win.top){f+=a.win.taskbar.outerHeight()}}}e.set({width:d,height:c,left:h,top:f})}e.actived=true;e.minimize=false;a.win.setFront(e);e.show();a.win.setFront(this)},setUrl:function(c){return _setUrl(c)}})})(jQuery);