(function(a){a.fn.ligerCheckBoxList=function(b){return a.ligerui.run.call(this,"ligerCheckBoxList",arguments)};a.ligerDefaults.CheckBoxList={rowSize:3,valueField:"id",textField:"text",valueFieldID:null,name:null,split:";",data:null,parms:null,url:null,onSuccess:null,onError:null,css:null,value:null,valueFieldCssClass:null};a.ligerMethos.CheckBoxList=a.ligerMethos.CheckBoxList||{};a.ligerui.controls.CheckBoxList=function(c,b){a.ligerui.controls.CheckBoxList.base.constructor.call(this,c,b)};a.ligerui.controls.CheckBoxList.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"CheckBoxList"},_extendMethods:function(){return a.ligerMethos.CheckBoxList},_init:function(){a.ligerui.controls.CheckBoxList.base._init.call(this)},_render:function(){var b=this,c=this.options;b.data=c.data;b.valueField=null;if(c.valueFieldID){b.valueField=a("#"+c.valueFieldID+":input,[name="+c.valueFieldID+"]:input");if(b.valueField.length==0){b.valueField=a('<input type="hidden"/>')}b.valueField[0].id=b.valueField[0].name=c.valueFieldID}else{b.valueField=a('<input type="hidden"/>');b.valueField[0].id=b.valueField[0].name=b.id+"_val"}if(b.valueField[0].name==null){b.valueField[0].name=b.valueField[0].id}if(c.valueFieldCssClass){b.valueField.addClass(c.valueFieldCssClass)}b.valueField.attr("data-ligerid",b.id);b.checkboxList=a(this.element);b.checkboxList.html('<div class="l-checkboxlist-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-checkboxlist-table"></table></div>').addClass("l-checkboxlist").append(b.valueField);b.checkboxList.table=a("table:first",b.checkboxList);b.set(c);b._addClickEven()},destroy:function(){if(this.checkboxList){this.checkboxList.remove()}this.options=null;a.ligerui.remove(this)},clear:function(){this._changeValue("");this.trigger("clear")},_setCss:function(b){if(b){this.checkboxList.addClass(b)}},_setDisabled:function(b){if(b){this.checkboxList.addClass("l-checkboxlist-disabled");a("input:checkbox",this.radioList).attr("disabled",true)}else{this.checkboxList.removeClass("l-checkboxlist-disabled");a("input:checkbox",this.radioList).removeAttr("disabled")}},_setWidth:function(b){this.checkboxList.width(b)},_setHeight:function(b){this.checkboxList.height(b)},indexOf:function(e){var d=this,f=this.options;if(!d.data){return -1}for(var c=0,b=d.data.length;c<b;c++){if(typeof(e)=="object"){if(d.data[c]==e){return c}}else{if(d.data[c][f.valueField].toString()==e.toString()){return c}}}return -1},removeItems:function(b){var c=this;if(!c.data){return}a(b).each(function(e,f){var d=c.indexOf(f);if(d==-1){return}c.data.splice(d,1)});c.refresh()},removeItem:function(c){if(!this.data){return}var b=this.indexOf(c);if(b==-1){return}this.data.splice(b,1);this.refresh()},insertItem:function(d,b){var c=this;if(!c.data){c.data=[]}c.data.splice(b,0,d);c.refresh()},addItems:function(b){var c=this;if(!c.data){c.data=[]}a(b).each(function(d,e){c.data.push(e)});c.refresh()},addItem:function(c){var b=this;if(!b.data){b.data=[]}b.data.push(c);b.refresh()},_setValue:function(c){var b=this,d=this.options;d.value=c;b.valueField.val(d.value);this._dataInit()},setValue:function(b){this._setValue(b)},_setUrl:function(b){if(!b){return}var d=this,e=this.options;var c=a.isFunction(e.parms)?e.parms():e.parms;a.ajax({type:"post",url:b,data:c,cache:false,dataType:"json",success:function(f){d.setData(f);d.trigger("success",[f])},error:function(f,g){d.trigger("error",[f,g])}})},setUrl:function(b){return this._setUrl(b)},setParm:function(b,e){if(!b){return}var d=this;var c=d.get("parms");if(!c){c={}}c[b]=e;d.set("parms",c)},clearContent:function(){var b=this,c=this.options;a("table",b.checkboxList).html("")},_setData:function(b){this.setData(b)},setData:function(c){var b=this,d=this.options;if(!c||!c.length){return}b.data=c;b.refresh();b.updateStyle()},refresh:function(){var l=this,d=this.options,j=this.data;this.clearContent();if(!j){return}var f=[],n=d.rowSize,m=false,b=d.name||l.id;for(var k=0;k<j.length;k++){var e=j[k][d.valueField],h=j[k][d.textField],c=l.id+"-"+k;var o=k%n==0;if(o){if(m){f.push("</tr>")}f.push("<tr>");m=true}f.push("<td><input type='checkbox' name='"+b+"' value='"+e+"' id='"+c+"'/><label for='"+c+"'>"+h+"</label></td>")}if(m){f.push("</tr>")}l.checkboxList.table.append(f.join(""))},_getValue:function(){var d=this,e=this.options,c=e.name||d.id;var b=[];a('input:checkbox[name="'+c+'"]:checked').each(function(){b.push(this.value)});if(!b.length){return null}return b.join(e.split)},getValue:function(){return this._getValue()},updateStyle:function(){this._dataInit()},_dataInit:function(){var b=this,d=this.options;var c=b.valueField.val();b._changeValue(c)},_changeValue:function(e){var d=this,f=this.options,c=f.name||d.id;var b=e?e.split(f.split):[];a("input:checkbox[name='"+c+"']",d.checkboxList).each(function(){this.checked=a.inArray(this.value,b)>-1});d.valueField.val(e);d.selectedValue=e},_addClickEven:function(){var b=this,c=this.options;b.checkboxList.click(function(f){var d=b.getValue();if(d){b.valueField.val(d)}})}})})(jQuery);