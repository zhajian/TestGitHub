define("echarts/chart/heatmap",["require","./base","../layer/heatmap","../config","../util/ecData","zrender/tool/util","zrender/tool/color","zrender/shape/Image","../chart"],function(g){function d(l,k,p,i,m){c.call(this,l,k,p,i,m),this.refresh(i)}var c=g("./base"),j=g("../layer/heatmap"),b=g("../config"),h=(g("../util/ecData"),g("zrender/tool/util")),f=(g("zrender/tool/color"),g("zrender/shape/Image"));return b.heatmap={zlevel:0,z:2,clickable:!0},d.prototype={type:b.CHART_TYPE_HEATMAP,refresh:function(a){this.clear(),a&&(this.option=a,this.series=a.series),this._init()},_init:function(){var p=this.series;this.backupShapeList();for(var m=p.length,k=0;m>k;++k){if(p[k].type===b.CHART_TYPE_HEATMAP){p[k]=this.reformOption(p[k]);var q=new j(p[k]),n=q.getCanvas(p[k].data,this.zr.getWidth(),this.zr.getHeight()),a=new f({position:[0,0],scale:[1,1],hoverable:this.option.hoverable,style:{x:0,y:0,image:n,width:n.width,height:n.height}});this.shapeList.push(a)}}this.addShapeList()}},h.inherits(d,c),g("../chart").define("heatmap",d),d}),define("echarts/layer/heatmap",["require"],function(){function c(g){if(this.option=g,g){for(var f in b){this.option[f]=void 0!==g[f]?g[f]:b[f]}}else{this.option=b}}var b={blurSize:30,gradientColors:["blue","cyan","lime","yellow","red"],minAlpha:0.05,valueScale:1,opacity:1},a=20,d=256;return c.prototype={getCanvas:function(F,q,J){var z=this._getBrush(),w=this._getGradient(),v=a+this.option.blurSize,B=document.createElement("canvas");B.width=q,B.height=J;for(var C=B.getContext("2d"),A=F.length,i=0;A>i;++i){var G=F[i],j=G[0],x=G[1],H=G[2],n=Math.min(1,Math.max(H*this.option.valueScale||this.option.minAlpha,this.option.minAlpha));C.globalAlpha=n,C.drawImage(z,j-v,x-v)}for(var D=C.getImageData(0,0,B.width,B.height),k=D.data,A=k.length/4;A--;){var I=4*A+3,n=k[I]/256,E=Math.floor(n*(d-1));k[I-3]=w[4*E],k[I-2]=w[4*E+1],k[I-1]=w[4*E+2],k[I]*=this.option.opacity}return C.putImageData(D,0,0),B},_getBrush:function(){if(!this._brushCanvas){this._brushCanvas=document.createElement("canvas");var g=a+this.option.blurSize,f=2*g;this._brushCanvas.width=f,this._brushCanvas.height=f;var h=this._brushCanvas.getContext("2d");h.shadowOffsetX=f,h.shadowBlur=this.option.blurSize,h.shadowColor="black",h.beginPath(),h.arc(-g,g,a,0,2*Math.PI,!0),h.closePath(),h.fill()}return this._brushCanvas},_getGradient:function(){if(!this._gradientPixels){var k=d,h=document.createElement("canvas");h.width=1,h.height=k;for(var g=h.getContext("2d"),f=g.createLinearGradient(0,0,0,k),l=this.option.gradientColors.length,j=0;l>j;++j){"string"==typeof this.option.gradientColors[j]?f.addColorStop((j+1)/l,this.option.gradientColors[j]):f.addColorStop(this.option.gradientColors[j].offset,this.option.gradientColors[j].color)}g.fillStyle=f,g.fillRect(0,0,1,k),this._gradientPixels=g.getImageData(0,0,1,k).data}return this._gradientPixels}},c}),define("echarts/layer/heatmap",["require"],function(){function c(g){if(this.option=g,g){for(var f in b){this.option[f]=void 0!==g[f]?g[f]:b[f]}}else{this.option=b}}var b={blurSize:30,gradientColors:["blue","cyan","lime","yellow","red"],minAlpha:0.05,valueScale:1,opacity:1},a=20,d=256;return c.prototype={getCanvas:function(F,q,J){var z=this._getBrush(),w=this._getGradient(),v=a+this.option.blurSize,B=document.createElement("canvas");B.width=q,B.height=J;for(var C=B.getContext("2d"),A=F.length,i=0;A>i;++i){var G=F[i],j=G[0],x=G[1],H=G[2],n=Math.min(1,Math.max(H*this.option.valueScale||this.option.minAlpha,this.option.minAlpha));C.globalAlpha=n,C.drawImage(z,j-v,x-v)}for(var D=C.getImageData(0,0,B.width,B.height),k=D.data,A=k.length/4;A--;){var I=4*A+3,n=k[I]/256,E=Math.floor(n*(d-1));k[I-3]=w[4*E],k[I-2]=w[4*E+1],k[I-1]=w[4*E+2],k[I]*=this.option.opacity}return C.putImageData(D,0,0),B},_getBrush:function(){if(!this._brushCanvas){this._brushCanvas=document.createElement("canvas");var g=a+this.option.blurSize,f=2*g;this._brushCanvas.width=f,this._brushCanvas.height=f;var h=this._brushCanvas.getContext("2d");h.shadowOffsetX=f,h.shadowBlur=this.option.blurSize,h.shadowColor="black",h.beginPath(),h.arc(-g,g,a,0,2*Math.PI,!0),h.closePath(),h.fill()}return this._brushCanvas},_getGradient:function(){if(!this._gradientPixels){var k=d,h=document.createElement("canvas");h.width=1,h.height=k;for(var g=h.getContext("2d"),f=g.createLinearGradient(0,0,0,k),l=this.option.gradientColors.length,j=0;l>j;++j){"string"==typeof this.option.gradientColors[j]?f.addColorStop((j+1)/l,this.option.gradientColors[j]):f.addColorStop(this.option.gradientColors[j].offset,this.option.gradientColors[j].color)}g.fillStyle=f,g.fillRect(0,0,1,k),this._gradientPixels=g.getImageData(0,0,1,k).data}return this._gradientPixels}},c});