define("echarts/chart/force",["require","./base","../data/Graph","../layout/Force","zrender/shape/Line","zrender/shape/BezierCurve","zrender/shape/Image","../util/shape/Icon","../config","../util/ecData","zrender/tool/util","zrender/config","zrender/tool/vector","../chart"],function(G){function k(g,a,l,f,i){var m=this;v.call(this,g,a,l,f,i),this.__nodePositionMap={},this._graph=new q(!0),this._layout=new B,this._layout.onupdate=function(){m._step()},this._steps=1,this.ondragstart=function(){C.apply(m,arguments)},this.ondragend=function(){J.apply(m,arguments)},this.ondrop=function(){},this.shapeHandler.ondragstart=function(){m.isDragstart=!0},this.onmousemove=function(){z.apply(m,arguments)},this.refresh(f)}function C(c){if(this.isDragstart&&c.target){var a=c.target;a.fixed=!0,this.isDragstart=!1,this.zr.on(b.EVENT.MOUSEMOVE,this.onmousemove)}}function z(){this._layout.temperature=0.8,this._step()}function J(d,c){if(this.isDragend&&d.target){var a=d.target;a.fixed=!1,c.dragIn=!0,c.needRefresh=!1,this.isDragend=!1,this.zr.un(b.EVENT.MOUSEMOVE,this.onmousemove)}}function x(d,c,a){var f=F.create();return f[0]=(Math.random()-0.5)*a+d,f[1]=(Math.random()-0.5)*a+c,f}var v=G("./base"),q=G("../data/Graph"),B=G("../layout/Force"),D=G("zrender/shape/Line"),H=G("zrender/shape/BezierCurve"),I=G("zrender/shape/Image"),w=G("../util/shape/Icon"),A=G("../config");A.force={zlevel:1,z:2,center:["50%","50%"],size:"100%",preventOverlap:!1,coolDown:0.99,minRadius:10,maxRadius:20,ratioScaling:!1,large:!1,useWorker:!1,steps:1,scaling:1,gravity:1,symbol:"circle",symbolSize:0,linkSymbol:null,linkSymbolSize:[10,15],draggable:!0,clickable:!0,roam:!1,itemStyle:{normal:{label:{show:!1,position:"inside"},nodeStyle:{brushType:"both",borderColor:"#5182ab",borderWidth:1},linkStyle:{color:"#5182ab",width:1,type:"line"}},emphasis:{label:{show:!1},nodeStyle:{},linkStyle:{opacity:0}}}};var j=G("../util/ecData"),E=G("zrender/tool/util"),b=G("zrender/config"),F=G("zrender/tool/vector");return k.prototype={constructor:k,type:A.CHART_TYPE_FORCE,_init:function(){this.selectedMap={};var g,f=this.component.legend,d=this.series;this.clear();for(var l=0,c=d.length;c>l;l++){var h=d[l];if(h.type===A.CHART_TYPE_FORCE){if(d[l]=this.reformOption(d[l]),g=d[l].name||"",this.selectedMap[g]=f?f.isSelected(g):!0,!this.selectedMap[g]){continue}this.buildMark(l),this._initSerie(h,l);break}}this.animationEffect()},_getNodeCategory:function(c,a){return c.categories&&c.categories[a.category||0]},_getNodeQueryTarget:function(d,c,a){a=a||"normal";var f=this._getNodeCategory(d,c)||{};return[c.itemStyle&&c.itemStyle[a],f&&f.itemStyle&&f.itemStyle[a],d.itemStyle[a].nodeStyle]},_getEdgeQueryTarget:function(d,c,a){return a=a||"normal",[c.itemStyle&&c.itemStyle[a],d.itemStyle[a].linkStyle]},_initSerie:function(d,c){this._temperature=1,d.matrix?this._graph=this._getSerieGraphFromDataMatrix(d):d.links&&(this._graph=this._getSerieGraphFromNodeLinks(d)),this._buildLinkShapes(d,c),this._buildNodeShapes(d,c);var a=d.roam===!0||"move"===d.roam,f=d.roam===!0||"scale"===d.roam;this.zr.modLayer(this.getZlevelBase(),{panable:a,zoomable:f}),(this.query("markPoint.effect.show")||this.query("markLine.effect.show"))&&this.zr.modLayer(A.EFFECT_ZLEVEL,{panable:a,zoomable:f}),this._initLayout(d),this._step()},_getSerieGraphFromDataMatrix:function(N){for(var R=[],L=0,u=[],Q=0;Q<N.matrix.length;Q++){u[Q]=N.matrix[Q].slice()}for(var s=N.data||N.nodes,Q=0;Q<s.length;Q++){var f={},K=s[Q];for(var M in K){"name"===M?f.id=K.name:f[M]=K[M]}var O=this._getNodeCategory(N,K),P=O?O.name:K.name;if(this.selectedMap[P]=this.isSelected(P),this.selectedMap[P]){R.push(f),L++}else{u.splice(L,1);for(var g=0;g<u.length;g++){u[g].splice(L,1)}}}var y=q.fromMatrix(R,u,!0);return y.eachNode(function(c,a){c.layout={size:c.data.value,mass:0},c.rawIndex=a}),y.eachEdge(function(a){a.layout={weight:a.data.weight}}),y},_getSerieGraphFromNodeLinks:function(N){for(var R=new q(!0),L=N.data||N.nodes,u=0,Q=L.length;Q>u;u++){var s=L[u];if(s&&!s.ignore){var f=this._getNodeCategory(N,s),K=f?f.name:s.name;if(this.selectedMap[K]=this.isSelected(K),this.selectedMap[K]){var M=R.addNode(s.name,s);M.rawIndex=u}}}for(var u=0,Q=N.links.length;Q>u;u++){var O=N.links[u],P=O.source,g=O.target;"number"==typeof P&&(P=L[P],P&&(P=P.name)),"number"==typeof g&&(g=L[g],g&&(g=g.name));var y=R.addEdge(P,g,O);y&&(y.rawIndex=u)}return R.eachNode(function(d){var c=d.data.value;if(null==c){c=0;for(var a=0;a<d.edges.length;a++){c+=d.edges[a].data.weight||0}}d.layout={size:c,mass:0}}),R.eachEdge(function(a){a.layout={weight:null==a.data.weight?1:a.data.weight}}),R},_initLayout:function(Q){var W=this._graph,N=W.nodes.length,K=this.query(Q,"minRadius"),U=this.query(Q,"maxRadius");this._steps=Q.steps||1;var f=this._layout;f.center=this.parseCenter(this.zr,Q.center),f.width=this.parsePercent(Q.size,this.zr.getWidth()),f.height=this.parsePercent(Q.size,this.zr.getHeight()),f.large=Q.large,f.scaling=Q.scaling,f.ratioScaling=Q.ratioScaling,f.gravity=Q.gravity,f.temperature=1,f.coolDown=Q.coolDown,f.preventNodeEdgeOverlap=Q.preventOverlap,f.preventNodeOverlap=Q.preventOverlap;for(var X=1/0,M=-(1/0),O=0;N>O;O++){var R=W.nodes[O];M=Math.max(R.layout.size,M),X=Math.min(R.layout.size,X)}for(var S=M-X,O=0;N>O;O++){var R=W.nodes[O];S>0?(R.layout.size=(R.layout.size-X)*(U-K)/S+K,R.layout.mass=R.layout.size/U):(R.layout.size=(U-K)/2,R.layout.mass=0.5)}for(var O=0;N>O;O++){var R=W.nodes[O];if("undefined"!=typeof this.__nodePositionMap[R.id]){R.layout.position=F.create(),F.copy(R.layout.position,this.__nodePositionMap[R.id])}else{if("undefined"!=typeof R.data.initial){R.layout.position=F.create(),F.copy(R.layout.position,R.data.initial)}else{var o=this._layout.center,L=Math.min(this._layout.width,this._layout.height);R.layout.position=x(o[0],o[1],0.8*L)}}var V=R.shape.style,P=R.layout.size;V.width=V.width||2*P,V.height=V.height||2*P,V.x=-V.width/2,V.y=-V.height/2,F.copy(R.shape.position,R.layout.position)}N=W.edges.length,M=-(1/0);for(var O=0;N>O;O++){var T=W.edges[O];T.layout.weight>M&&(M=T.layout.weight)}for(var O=0;N>O;O++){var T=W.edges[O];T.layout.weight/=M}this._layout.init(W,Q.useWorker)},_buildNodeShapes:function(d,c){var a=this._graph,f=this.query(d,"categories");a.eachNode(function(n){var m=this._getNodeCategory(d,n.data),K=[n.data,m,d],u=this._getNodeQueryTarget(d,n.data),t=this._getNodeQueryTarget(d,n.data,"emphasis"),g=new w({style:{x:0,y:0,color:this.deepQuery(u,"color"),brushType:"both",strokeColor:this.deepQuery(u,"strokeColor")||this.deepQuery(u,"borderColor"),lineWidth:this.deepQuery(u,"lineWidth")||this.deepQuery(u,"borderWidth")},highlightStyle:{color:this.deepQuery(t,"color"),strokeColor:this.deepQuery(t,"strokeColor")||this.deepQuery(t,"borderColor"),lineWidth:this.deepQuery(t,"lineWidth")||this.deepQuery(t,"borderWidth")},clickable:d.clickable,zlevel:this.getZlevelBase(),z:this.getZBase()});g.style.color||(g.style.color=this.getColor(m?m.name:n.id)),g.style.iconType=this.deepQuery(K,"symbol");var p=this.deepQuery(K,"symbolSize")||0;"number"==typeof p&&(p=[p,p]),g.style.width=2*p[0],g.style.height=2*p[1],g.style.iconType.match("image")&&(g.style.image=g.style.iconType.replace(new RegExp("^image:\\/\\/"),""),g=new I({style:g.style,highlightStyle:g.highlightStyle,clickable:g.clickable,zlevel:this.getZlevelBase(),z:this.getZBase()})),this.deepQuery(K,"itemStyle.normal.label.show")&&(g.style.text=null==n.data.label?n.id:n.data.label,g.style.textPosition=this.deepQuery(K,"itemStyle.normal.label.position"),g.style.textColor=this.deepQuery(K,"itemStyle.normal.label.textStyle.color"),g.style.textFont=this.getFont(this.deepQuery(K,"itemStyle.normal.label.textStyle")||{})),this.deepQuery(K,"itemStyle.emphasis.label.show")&&(g.highlightStyle.textPosition=this.deepQuery(K,"itemStyle.emphasis.label.position"),g.highlightStyle.textColor=this.deepQuery(K,"itemStyle.emphasis.label.textStyle.color"),g.highlightStyle.textFont=this.getFont(this.deepQuery(K,"itemStyle.emphasis.label.textStyle")||{})),this.deepQuery(K,"draggable")&&(this.setCalculable(g),g.dragEnableTime=0,g.draggable=!0,g.ondragstart=this.shapeHandler.ondragstart,g.ondragover=null);var y="";if("undefined"!=typeof n.category){var m=f[n.category];y=m&&m.name||""}j.pack(g,d,c,n.data,n.rawIndex,n.data.name||"",n.category),this.shapeList.push(g),this.zr.addShape(g),n.shape=g},this)},_buildLinkShapes:function(O,S){for(var M=this._graph,h=M.edges.length,R=0;h>R;R++){var g=M.edges[R],d=g.data,T=g.node1,L=g.node2,P=M.getEdge(L,T),u=this._getEdgeQueryTarget(O,d),Q=this.deepQuery(u,"type");O.linkSymbol&&"none"!==O.linkSymbol&&(Q="line");var N="line"===Q?D:H,p=new N({style:{xStart:0,yStart:0,xEnd:0,yEnd:0},clickable:this.query(O,"clickable"),highlightStyle:{},zlevel:this.getZlevelBase(),z:this.getZBase()});if(P&&P.shape&&(p.style.offset=4,P.shape.style.offset=4),E.merge(p.style,this.query(O,"itemStyle.normal.linkStyle"),!0),E.merge(p.highlightStyle,this.query(O,"itemStyle.emphasis.linkStyle"),!0),"undefined"!=typeof d.itemStyle&&(d.itemStyle.normal&&E.merge(p.style,d.itemStyle.normal,!0),d.itemStyle.emphasis&&E.merge(p.highlightStyle,d.itemStyle.emphasis,!0)),p.style.lineWidth=p.style.lineWidth||p.style.width,p.style.strokeColor=p.style.strokeColor||p.style.color,p.highlightStyle.lineWidth=p.highlightStyle.lineWidth||p.highlightStyle.width,p.highlightStyle.strokeColor=p.highlightStyle.strokeColor||p.highlightStyle.color,j.pack(p,O,S,g.data,null==g.rawIndex?R:g.rawIndex,g.data.name||T.id+" - "+L.id,T.id,L.id),this.shapeList.push(p),this.zr.addShape(p),g.shape=p,O.linkSymbol&&"none"!==O.linkSymbol){var K=new w({style:{x:-5,y:0,width:O.linkSymbolSize[0],height:O.linkSymbolSize[1],iconType:O.linkSymbol,brushType:"fill",color:p.style.strokeColor},highlightStyle:{brushType:"fill"},position:[0,0],rotation:0,zlevel:this.getZlevelBase(),z:this.getZBase()});p._symbolShape=K,this.shapeList.push(K),this.zr.addShape(K)}}},_updateLinkShapes:function(){for(var M=F.create(),Q=F.create(),K=F.create(),u=F.create(),P=this._graph.edges,m=0,f=P.length;f>m;m++){var R=P[m],y=R.node1.shape,L=R.node2.shape;F.copy(K,y.position),F.copy(u,L.position);var N=R.shape.style;if(F.sub(M,K,u),F.normalize(M,M),N.offset?(Q[0]=M[1],Q[1]=-M[0],F.scaleAndAdd(K,K,Q,N.offset),F.scaleAndAdd(u,u,Q,N.offset)):"bezier-curve"===R.shape.type&&(N.cpX1=(K[0]+u[0])/2-(u[1]-K[1])/4,N.cpY1=(K[1]+u[1])/2-(K[0]-u[0])/4),N.xStart=K[0],N.yStart=K[1],N.xEnd=u[0],N.yEnd=u[1],R.shape.modSelf(),R.shape._symbolShape){var O=R.shape._symbolShape;F.copy(O.position,u),F.scaleAndAdd(O.position,O.position,M,L.style.width/2+2);var g=Math.atan2(M[1],M[0]);O.rotation=Math.PI/2-g,O.modSelf()}}},_syncNodePositions:function(){for(var u=this._graph,K=0;K<u.nodes.length;K++){var m=u.nodes[K],f=m.layout.position,y=m.data,d=m.shape,c=d.fixed||y.fixX,L=d.fixed||y.fixY;c===!0?c=1:isNaN(c)&&(c=0),L===!0?L=1:isNaN(L)&&(L=0),d.position[0]+=(f[0]-d.position[0])*(1-c),d.position[1]+=(f[1]-d.position[1])*(1-L),F.copy(f,d.position);var g=y.name;if(g){var p=this.__nodePositionMap[g];p||(p=this.__nodePositionMap[g]=F.create()),F.copy(p,f)}d.modSelf()}},_step:function(){this._syncNodePositions(),this._updateLinkShapes(),this.zr.refreshNextFrame(),this._layout.temperature>0.01?this._layout.step(this._steps):this.messageCenter.dispatch(A.EVENT.FORCE_LAYOUT_END,{},{},this.myChart)},refresh:function(d){if(d&&(this.option=d,this.series=this.option.series),this.legend=this.component.legend,this.legend){this.getColor=function(f){return this.legend.getColor(f)},this.isSelected=function(f){return this.legend.isSelected(f)}}else{var c={},a=0;this.getColor=function(f){return c[f]?c[f]:(c[f]||(c[f]=this.zr.getColor(a++)),c[f])},this.isSelected=function(){return !0}}this._init()},dispose:function(){this.clear(),this.shapeList=null,this.effectList=null,this._layout.dispose(),this._layout=null,this.__nodePositionMap={}},getPosition:function(){var a=[];return this._graph.eachNode(function(c){c.layout&&a.push({name:c.data.name,position:Array.prototype.slice.call(c.layout.position)})}),a}},E.inherits(k,v),G("../chart").define("force",k),k}),define("echarts/data/Graph",["require","zrender/tool/util"],function(f){var d=f("zrender/tool/util"),c=function(a){this._directed=a||!1,this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={}};c.prototype.isDirected=function(){return this._directed},c.prototype.addNode=function(h,a){if(this._nodesMap[h]){return this._nodesMap[h]}var i=new c.Node(h,a);return this.nodes.push(i),this._nodesMap[h]=i,i},c.prototype.getNodeById=function(a){return this._nodesMap[a]},c.prototype.addEdge=function(j,i,l){if("string"==typeof j&&(j=this._nodesMap[j]),"string"==typeof i&&(i=this._nodesMap[i]),j&&i){var h=j.id+"-"+i.id;if(this._edgesMap[h]){return this._edgesMap[h]}var k=new c.Edge(j,i,l);return this._directed&&(j.outEdges.push(k),i.inEdges.push(k)),j.edges.push(k),j!==i&&i.edges.push(k),this.edges.push(k),this._edgesMap[h]=k,k}},c.prototype.removeEdge=function(k){var j=k.node1,l=k.node2,h=j.id+"-"+l.id;this._directed&&(j.outEdges.splice(d.indexOf(j.outEdges,k),1),l.inEdges.splice(d.indexOf(l.inEdges,k),1)),j.edges.splice(d.indexOf(j.edges,k),1),j!==l&&l.edges.splice(d.indexOf(l.edges,k),1),delete this._edgesMap[h],this.edges.splice(d.indexOf(this.edges,k),1)},c.prototype.getEdge=function(h,a){return"string"!=typeof h&&(h=h.id),"string"!=typeof a&&(a=a.id),this._directed?this._edgesMap[h+"-"+a]:this._edgesMap[h+"-"+a]||this._edgesMap[a+"-"+h]},c.prototype.removeNode=function(h){if("string"!=typeof h||(h=this._nodesMap[h])){delete this._nodesMap[h.id],this.nodes.splice(d.indexOf(this.nodes,h),1);for(var a=0;a<this.edges.length;){var j=this.edges[a];j.node1===h||j.node2===h?this.removeEdge(j):a++}}},c.prototype.filterNode=function(j,h){for(var a=this.nodes.length,k=0;a>k;){j.call(h,this.nodes[k],k)?k++:(this.removeNode(this.nodes[k]),a--)}},c.prototype.filterEdge=function(j,h){for(var a=this.edges.length,k=0;a>k;){j.call(h,this.edges[k],k)?k++:(this.removeEdge(this.edges[k]),a--)}},c.prototype.eachNode=function(j,h){for(var a=this.nodes.length,k=0;a>k;k++){this.nodes[k]&&j.call(h,this.nodes[k],k)}},c.prototype.eachEdge=function(j,h){for(var a=this.edges.length,k=0;a>k;k++){this.edges[k]&&j.call(h,this.edges[k],k)}},c.prototype.clear=function(){this.nodes.length=0,this.edges.length=0,this._nodesMap={},this._edgesMap={}},c.prototype.breadthFirstTraverse=function(v,y,q,m){if("string"==typeof y&&(y=this._nodesMap[y]),y){var x="edges";"out"===q?x="outEdges":"in"===q&&(x="inEdges");for(var k=0;k<this.nodes.length;k++){this.nodes[k].__visited=!1}if(!v.call(m,y,null)){for(var j=[y];j.length;){for(var z=j.shift(),p=z[x],k=0;k<p.length;k++){var u=p[k],w=u.node1===z?u.node2:u.node1;if(!w.__visited){if(v.call(w,w,z)){return}j.push(w),w.__visited=!0}}}}}},c.prototype.clone=function(){for(var h=new c(this._directed),a=0;a<this.nodes.length;a++){h.addNode(this.nodes[a].id,this.nodes[a].data)}for(var a=0;a<this.edges.length;a++){var i=this.edges[a];h.addEdge(i.node1.id,i.node2.id,i.data)}return h};var g=function(h,a){this.id=h,this.data=a||null,this.inEdges=[],this.outEdges=[],this.edges=[]};g.prototype.degree=function(){return this.edges.length},g.prototype.inDegree=function(){return this.inEdges.length},g.prototype.outDegree=function(){return this.outEdges.length};var b=function(j,h,a){this.node1=j,this.node2=h,this.data=a||null};return c.Node=g,c.Edge=b,c.fromMatrix=function(x,B,q){if(B&&B.length&&B[0].length===B.length&&x.length===B.length){for(var A=B.length,k=new c(q),i=0;A>i;i++){var C=k.addNode(x[i].id,x[i]);C.data.value=0,q&&(C.data.outValue=C.data.inValue=0)}for(var i=0;A>i;i++){for(var v=0;A>v;v++){var w=B[i][v];q&&(k.nodes[i].data.outValue+=w,k.nodes[v].data.inValue+=w),k.nodes[i].data.value+=w,k.nodes[v].data.value+=w}}for(var i=0;A>i;i++){for(var v=i;A>v;v++){var w=B[i][v];if(0!==w){var y=k.nodes[i],z=k.nodes[v],j=k.addEdge(y,z,{});if(j.data.weight=w,i!==v&&q&&B[v][i]){var u=k.addEdge(z,y,{});u.data.weight=B[v][i]}}}}return k}},c}),define("echarts/layout/Force",["require","./forceLayoutWorker","zrender/tool/vector"],function(h){function d(){if("undefined"!=typeof Worker&&"undefined"!=typeof Blob){try{var i=new Blob([k.getWorkerCode()]);c=window.URL.createObjectURL(i)}catch(a){c=""}}return c}var c,k=h("./forceLayoutWorker"),b=h("zrender/tool/vector"),j=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(a){setTimeout(a,16)},g="undefined"==typeof Float32Array?Array:Float32Array,f=function(l){"undefined"==typeof c&&d(),l=l||{},this.width=l.width||500,this.height=l.height||500,this.center=l.center||[this.width/2,this.height/2],this.ratioScaling=l.ratioScaling||!1,this.scaling=l.scaling||1,this.gravity="undefined"!=typeof l.gravity?l.gravity:1,this.large=l.large||!1,this.preventNodeOverlap=l.preventNodeOverlap||!1,this.preventNodeEdgeOverlap=l.preventNodeEdgeOverlap||!1,this.maxSpeedIncrease=l.maxSpeedIncrease||1,this.onupdate=l.onupdate||function(){},this.temperature=l.temperature||1,this.coolDown=l.coolDown||0.99,this._layout=null,this._layoutWorker=null;var m=this,i=this._$onupdate;this._$onupdate=function(a){i.call(m,a)}};return f.prototype.updateConfig=function(){var p=this.width,o=this.height,m=Math.min(p,o),q={center:this.center,width:this.ratioScaling?p:m,height:this.ratioScaling?o:m,scaling:this.scaling||1,gravity:this.gravity||1,barnesHutOptimize:this.large,preventNodeOverlap:this.preventNodeOverlap,preventNodeEdgeOverlap:this.preventNodeEdgeOverlap,maxSpeedIncrease:this.maxSpeedIncrease};if(this._layoutWorker){this._layoutWorker.postMessage({cmd:"updateConfig",config:q})}else{for(var l in q){this._layout[l]=q[l]}}},f.prototype.init=function(w,B){if(this._layoutWorker&&(this._layoutWorker.terminate(),this._layoutWorker=null),c&&B){try{this._layoutWorker||(this._layoutWorker=new Worker(c),this._layoutWorker.onmessage=this._$onupdate),this._layout=null}catch(z){this._layoutWorker=null,this._layout||(this._layout=new k)}}else{this._layout||(this._layout=new k)}this.temperature=1,this.graph=w;for(var n=w.nodes.length,C=new g(2*n),r=new g(n),v=new g(n),x=0;n>x;x++){var y=w.nodes[x];C[2*x]=y.layout.position[0],C[2*x+1]=y.layout.position[1],r[x]="undefined"==typeof y.layout.mass?1:y.layout.mass,v[x]="undefined"==typeof y.layout.size?1:y.layout.size,y.layout.__index=x}n=w.edges.length;for(var i=new g(2*n),q=new g(n),x=0;n>x;x++){var A=w.edges[x];i[2*x]=A.node1.layout.__index,i[2*x+1]=A.node2.layout.__index,q[x]=A.layout.weight||1}this._layoutWorker?this._layoutWorker.postMessage({cmd:"init",nodesPosition:C,nodesMass:r,nodesSize:v,edges:i,edgesWeight:q}):(this._layout.initNodes(C,r,v),this._layout.initEdges(i,q)),this.updateConfig()},f.prototype.step=function(o){var l=this.graph.nodes;if(this._layoutWorker){for(var a=new g(2*l.length),p=0;p<l.length;p++){var m=l[p];a[2*p]=m.layout.position[0],a[2*p+1]=m.layout.position[1]}this._layoutWorker.postMessage(a.buffer,[a.buffer]),this._layoutWorker.postMessage({cmd:"update",steps:o,temperature:this.temperature,coolDown:this.coolDown});for(var p=0;o>p;p++){this.temperature*=this.coolDown}}else{j(this._$onupdate);for(var p=0;p<l.length;p++){var m=l[p];b.copy(this._layout.nodes[p].position,m.layout.position)}for(var p=0;o>p;p++){this._layout.temperature=this.temperature,this._layout.update(),this.temperature*=this.coolDown}}},f.prototype._$onupdate=function(m){if(this._layoutWorker){for(var l=new Float32Array(m.data),a=0;a<this.graph.nodes.length;a++){var o=this.graph.nodes[a];o.layout.position[0]=l[2*a],o.layout.position[1]=l[2*a+1]}this.onupdate&&this.onupdate()}else{if(this._layout){for(var a=0;a<this.graph.nodes.length;a++){var o=this.graph.nodes[a];b.copy(o.layout.position,this._layout.nodes[a].position)}this.onupdate&&this.onupdate()}}},f.prototype.dispose=function(){this._layoutWorker&&this._layoutWorker.terminate(),this._layoutWorker=null,this._layout=null},f}),define("echarts/layout/forceLayoutWorker",["require","zrender/tool/vector"],function e(m){function g(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new f(4),this.size=0}function d(){this.position=b.create(),this.force=b.create(),this.forcePrev=b.create(),this.speed=b.create(),this.speedPrev=b.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function k(h,a){this.node1=h,this.node2=a,this.weight=1}function c(){this.barnesHutOptimize=!1,this.barnesHutTheta=1.5,this.repulsionByDegree=!1,this.preventNodeOverlap=!1,this.preventNodeEdgeOverlap=!1,this.strongGravity=!0,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.center=[0,0],this.width=500,this.height=500,this.maxSpeedIncrease=1,this.nodes=[],this.edges=[],this.bbox=new f(4),this._rootRegion=new g,this._rootRegion.centerOfMass=b.create(),this._massArr=null,this._k=0}var b,p="undefined"==typeof window&&"undefined"==typeof m;b=p?{create:function(l,h){var a=new Float32Array(2);return a[0]=l||0,a[1]=h||0,a},dist:function(l,h){var a=h[0]-l[0],o=h[1]-l[1];return Math.sqrt(a*a+o*o)},len:function(l){var h=l[0],a=l[1];return Math.sqrt(h*h+a*a)},scaleAndAdd:function(l,h,a,o){return l[0]=h[0]+a[0]*o,l[1]=h[1]+a[1]*o,l},scale:function(l,h,a){return l[0]=h[0]*a,l[1]=h[1]*a,l},add:function(l,h,a){return l[0]=h[0]+a[0],l[1]=h[1]+a[1],l},sub:function(l,h,a){return l[0]=h[0]-a[0],l[1]=h[1]-a[1],l},dot:function(h,a){return h[0]*a[0]+h[1]*a[1]},normalize:function(q,o){var l=o[0],r=o[1],h=l*l+r*r;return h>0&&(h=1/Math.sqrt(h),q[0]=o[0]*h,q[1]=o[1]*h),q},negate:function(h,a){return h[0]=-a[0],h[1]=-a[1],h},copy:function(h,a){return h[0]=a[0],h[1]=a[1],h},set:function(l,h,a){return l[0]=h,l[1]=a,l}}:m("zrender/tool/vector");var f="undefined"==typeof Float32Array?Array:Float32Array;if(g.prototype.beforeUpdate=function(){for(var a=0;a<this.nSubRegions;a++){this.subRegions[a].beforeUpdate()}this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},g.prototype.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var a=0;a<this.nSubRegions;a++){this.subRegions[a].afterUpdate()}},g.prototype.addNode=function(a){if(0===this.nSubRegions){if(null==this.node){return void (this.node=a)}this._addNodeToSubRegion(this.node),this.node=null}this._addNodeToSubRegion(a),this._updateCenterOfMass(a)},g.prototype.findSubRegion=function(l,h){for(var a=0;a<this.nSubRegions;a++){var o=this.subRegions[a];if(o.contain(l,h)){return o}}},g.prototype.contain=function(h,a){return this.bbox[0]<=h&&this.bbox[2]>=h&&this.bbox[1]<=a&&this.bbox[3]>=a},g.prototype.setBBox=function(l,h,a,o){this.bbox[0]=l,this.bbox[1]=h,this.bbox[2]=a,this.bbox[3]=o,this.size=(a-l+o-h)/2},g.prototype._newSubRegion=function(){var a=this.subRegions[this.nSubRegions];return a||(a=new g,this.subRegions[this.nSubRegions]=a),this.nSubRegions++,a},g.prototype._addNodeToSubRegion=function(x){var z=this.findSubRegion(x.position[0],x.position[1]),w=this.bbox;if(!z){var u=(w[0]+w[2])/2,y=(w[1]+w[3])/2,q=(w[2]-w[0])/2,h=(w[3]-w[1])/2,A=x.position[0]>=u?1:0,v=x.position[1]>=y?1:0,z=this._newSubRegion();z.setBBox(A*q+w[0],v*h+w[1],(A+1)*q+w[0],(v+1)*h+w[1])}z.addNode(x)},g.prototype._updateCenterOfMass=function(l){null==this.centerOfMass&&(this.centerOfMass=b.create());var h=this.centerOfMass[0]*this.mass,a=this.centerOfMass[1]*this.mass;h+=l.position[0]*l.mass,a+=l.position[1]*l.mass,this.mass+=l.mass,this.centerOfMass[0]=h/this.mass,this.centerOfMass[1]=a/this.mass},c.prototype.nodeToNodeRepulsionFactor=function(l,h,a){return a*a*l/h},c.prototype.edgeToNodeRepulsionFactor=function(l,h,a){return a*l/h},c.prototype.attractionFactor=function(l,h,a){return l*h/a},c.prototype.initNodes=function(v,n,l){this.temperature=1;var h=v.length/2;this.nodes.length=0;for(var w="undefined"!=typeof l,u=0;h>u;u++){var q=new d;q.position[0]=v[2*u],q.position[1]=v[2*u+1],q.mass=n[u],w&&(q.size=l[u]),this.nodes.push(q)}this._massArr=n,w&&(this._sizeArr=l)},c.prototype.initEdges=function(y,A){var w=y.length/2;this.edges.length=0;for(var u="undefined"!=typeof A,q=0;w>q;q++){var a=y[2*q],B=y[2*q+1],v=this.nodes[a],x=this.nodes[B];if(v&&x){v.outDegree++,x.inDegree++;var z=new k(v,x);u&&(z.weight=A[q]),this.edges.push(z)}}},c.prototype.update=function(){var q=this.nodes.length;if(this.updateBBox(),this._k=0.4*this.scaling*Math.sqrt(this.width*this.height/q),this.barnesHutOptimize){this._rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this._rootRegion.beforeUpdate();for(var o=0;q>o;o++){this._rootRegion.addNode(this.nodes[o])}this._rootRegion.afterUpdate()}else{var l=0,r=this._rootRegion.centerOfMass;b.set(r,0,0);for(var o=0;q>o;o++){var h=this.nodes[o];l+=h.mass,b.scaleAndAdd(r,r,h.position,h.mass)}l>0&&b.scale(r,r,1/l)}this.updateForce(),this.updatePosition()},c.prototype.updateForce=function(){for(var l=this.nodes.length,h=0;l>h;h++){var a=this.nodes[h];b.copy(a.forcePrev,a.force),b.copy(a.speedPrev,a.speed),b.set(a.force,0,0)}this.updateNodeNodeForce(),this.gravity>0&&this.updateGravityForce(),this.updateEdgeForce(),this.preventNodeEdgeOverlap&&this.updateNodeEdgeForce()},c.prototype.updatePosition=function(){for(var x=this.nodes.length,A=b.create(),v=0;x>v;v++){var r=this.nodes[v],z=r.speed;b.scale(r.force,r.force,1/30);var q=b.len(r.force)+0.1,B=Math.min(q,500)/q;b.scale(r.force,r.force,B),b.add(z,z,r.force),b.scale(z,z,this.temperature),b.sub(A,z,r.speedPrev);var u=b.len(A);if(u>0){b.scale(A,A,1/u);var w=b.len(r.speedPrev);w>0&&(u=Math.min(u/w,this.maxSpeedIncrease)*w,b.scaleAndAdd(z,r.speedPrev,A,u))}var y=b.len(z),B=Math.min(y,100)/(y+0.1);b.scale(z,z,B),b.add(r.position,r.position,z)}},c.prototype.updateNodeNodeForce=function(){for(var q=this.nodes.length,o=0;q>o;o++){var l=this.nodes[o];if(this.barnesHutOptimize){this.applyRegionToNodeRepulsion(this._rootRegion,l)}else{for(var r=o+1;q>r;r++){var h=this.nodes[r];this.applyNodeToNodeRepulsion(l,h,!1)}}}},c.prototype.updateGravityForce=function(){for(var a=0;a<this.nodes.length;a++){this.applyNodeGravity(this.nodes[a])}},c.prototype.updateEdgeForce=function(){for(var a=0;a<this.edges.length;a++){this.applyEdgeAttraction(this.edges[a])}},c.prototype.updateNodeEdgeForce=function(){for(var h=0;h<this.nodes.length;h++){for(var a=0;a<this.edges.length;a++){this.applyEdgeToNodeRepulsion(this.edges[a],this.nodes[h])}}},c.prototype.applyRegionToNodeRepulsion=function(){var a=b.create();return function(q,l){if(q.node){this.applyNodeToNodeRepulsion(q.node,l,!0)}else{if(0===q.mass&&0===l.mass){return}b.sub(a,l.position,q.centerOfMass);var s=a[0]*a[0]+a[1]*a[1];if(s>this.barnesHutTheta*q.size*q.size){var h=this._k*this._k*(l.mass+q.mass)/(s+1);b.scaleAndAdd(l.force,l.force,a,2*h)}else{for(var r=0;r<q.nSubRegions;r++){this.applyRegionToNodeRepulsion(q.subRegions[r],l)}}}}}(),c.prototype.applyNodeToNodeRepulsion=function(){var a=b.create();return function(u,r,x){if(u!==r&&(0!==u.mass||0!==r.mass)){b.sub(a,u.position,r.position);var q=a[0]*a[0]+a[1]*a[1];if(0!==q){var w,v=u.mass+r.mass,h=Math.sqrt(q);b.scale(a,a,1/h),this.preventNodeOverlap?(h=h-u.size-r.size,h>0?w=this.nodeToNodeRepulsionFactor(v,h,this._k):0>=h&&(w=this._k*this._k*10*v)):w=this.nodeToNodeRepulsionFactor(v,h,this._k),x||b.scaleAndAdd(u.force,u.force,a,2*w),b.scaleAndAdd(r.force,r.force,a,2*-w)}}}}(),c.prototype.applyEdgeAttraction=function(){var a=b.create();return function(q){var l=q.node1,v=q.node2;b.sub(a,l.position,v.position);var h,u=b.len(a);h=0===this.edgeWeightInfluence?1:1==this.edgeWeightInfluence?q.weight:Math.pow(q.weight,this.edgeWeightInfluence);var r;if(!(this.preventOverlap&&(u=u-l.size-v.size,0>=u))){var r=this.attractionFactor(h,u,this._k);b.scaleAndAdd(l.force,l.force,a,-r),b.scaleAndAdd(v.force,v.force,a,r)}}}(),c.prototype.applyNodeGravity=function(){var a=b.create();return function(l){b.sub(a,this.center,l.position),this.width>this.height?a[1]*=this.width/this.height:a[0]*=this.height/this.width;var h=b.len(a)/100;this.strongGravity?b.scaleAndAdd(l.force,l.force,a,h*this.gravity*l.mass):b.scaleAndAdd(l.force,l.force,a,this.gravity*l.mass/(h+1))}}(),c.prototype.applyEdgeToNodeRepulsion=function(){var l=b.create(),h=b.create(),a=b.create();return function(x,q){var v=x.node1,t=x.node2;if(v!==q&&t!==q){b.sub(l,t.position,v.position),b.sub(h,q.position,v.position);var i=b.len(l);b.scale(l,l,1/i);var r=b.dot(l,h);if(!(0>r||r>i)){b.scaleAndAdd(a,v.position,l,r);var u=b.dist(a,q.position)-q.size,w=this.edgeToNodeRepulsionFactor(q.mass,Math.max(u,0.1),100);b.sub(l,q.position,a),b.normalize(l,l),b.scaleAndAdd(q.force,q.force,l,w),b.scaleAndAdd(v.force,v.force,l,-w),b.scaleAndAdd(t.force,t.force,l,-w)}}}}(),c.prototype.updateBBox=function(){for(var r=1/0,q=1/0,l=-(1/0),u=-(1/0),h=0;h<this.nodes.length;h++){var s=this.nodes[h].position;r=Math.min(r,s[0]),q=Math.min(q,s[1]),l=Math.max(l,s[0]),u=Math.max(u,s[1])}this.bbox[0]=r,this.bbox[1]=q,this.bbox[2]=l,this.bbox[3]=u},c.getWorkerCode=function(){var a=e.toString();return a.slice(a.indexOf("{")+1,a.lastIndexOf("return"))},p){var j=null;self.onmessage=function(x){if(x.data instanceof ArrayBuffer){if(!j){return}for(var u=new Float32Array(x.data),q=u.length/2,y=0;q>y;y++){var o=j.nodes[y];o.position[0]=u[2*y],o.position[1]=u[2*y+1]}}else{switch(x.data.cmd){case"init":j||(j=new c),j.initNodes(x.data.nodesPosition,x.data.nodesMass,x.data.nodesSize),j.initEdges(x.data.edges,x.data.edgesWeight);break;case"updateConfig":if(j){for(var w in x.data.config){j[w]=x.data.config[w]}}break;case"update":var v=x.data.steps;if(j){var q=j.nodes.length,u=new Float32Array(2*q);j.temperature=x.data.temperature;for(var y=0;v>y;y++){j.update(),j.temperature*=x.data.coolDown}for(var y=0;q>y;y++){var o=j.nodes[y];u[2*y]=o.position[0],u[2*y+1]=o.position[1]}self.postMessage(u.buffer,[u.buffer])}else{var h=new Float32Array;self.postMessage(h.buffer,[h.buffer])}}}}}return c});