define("echarts/chart/venn",["require","./base","zrender/shape/Text","zrender/shape/Circle","zrender/shape/Path","../config","../util/ecData","zrender/tool/util","../chart"],function(h){function k(p,l,r,i,q){g.call(this,p,l,r,i,q),this.refresh(i)}var g=h("./base"),d=h("zrender/shape/Text"),j=h("zrender/shape/Circle"),c=h("zrender/shape/Path"),b=h("../config");b.venn={zlevel:0,z:1,calculable:!1};var m=h("../util/ecData"),f=h("zrender/tool/util");return k.prototype={type:b.CHART_TYPE_VENN,_buildShape:function(){this.selectedMap={},this._symbol=this.option.symbolList,this._queryTarget,this._dropBoxList=[],this._vennDataCounter=0;for(var o=this.series,l=this.component.legend,a=0;a<o.length;a++){if(o[a].type===b.CHART_TYPE_VENN){o[a]=this.reformOption(o[a]);var p=o[a].name||"";if(this.selectedMap[p]=l?l.isSelected(p):!0,!this.selectedMap[p]){continue}this._buildVenn(a)}}this.addShapeList()},_buildVenn:function(D){var G,B,w=this.series[D],F=w.data;F[0].value>F[1].value?(G=this.zr.getHeight()/3,B=G*Math.sqrt(F[1].value)/Math.sqrt(F[0].value)):(B=this.zr.getHeight()/3,G=B*Math.sqrt(F[0].value)/Math.sqrt(F[1].value));var v=this.zr.getWidth()/2-G,q=(G+B)/2*Math.sqrt(F[2].value)/Math.sqrt((F[0].value+F[1].value)/2),H=G+B;0!==F[2].value&&(H=this._getCoincideLength(F[0].value,F[1].value,F[2].value,G,B,q,Math.abs(G-B),G+B));var A=v+H,C=this.zr.getHeight()/2;if(this._buildItem(D,0,F[0],v,C,G),this._buildItem(D,1,F[1],A,C,B),0!==F[2].value&&F[2].value!==F[0].value&&F[2].value!==F[1].value){var y=(G*G-B*B)/(2*H)+H/2,x=H/2-(G*G-B*B)/(2*H),z=Math.sqrt(G*G-y*y),E=0,u=0;F[0].value>F[1].value&&v+y>A&&(u=1),F[0].value<F[1].value&&v+x>A&&(E=1),this._buildCoincideItem(D,2,F[2],v+y,C-z,C+z,G,B,E,u)}},_getCoincideLength:function(E,J,C,x,H,w,q,K){var B=(x*x-H*H)/(2*w)+w/2,D=w/2-(x*x-H*H)/(2*w),z=Math.acos(B/x),y=Math.acos(D/H),A=x*x*Math.PI,F=z*x*x-B*x*Math.sin(z)+y*H*H-D*H*Math.sin(y),v=F/A,G=C/E,I=Math.abs(v/G);return I>0.999&&1.001>I?w:0.999>=I?(K=w,w=(w+q)/2,this._getCoincideLength(E,J,C,x,H,w,q,K)):(q=w,w=(w+K)/2,this._getCoincideLength(E,J,C,x,H,w,q,K))},_buildItem:function(y,A,w,s,z,q){var p=this.series,v=p[y],x=this.getCircle(y,A,w,s,z,q);if(m.pack(x,v,y,w,A,w.name),this.shapeList.push(x),v.itemStyle.normal.label.show){var u=this.getLabel(y,A,w,s,z,q);m.pack(u,v,y,v.data[A],A,v.data[A].name),this.shapeList.push(u)}},_buildCoincideItem:function(I,w,E,A,M,x,C,F,B,o){var q=this.series,J=q[I],z=[E,J],K=this.deepMerge(z,"itemStyle.normal")||{},v=this.deepMerge(z,"itemStyle.emphasis")||{},s=K.color||this.zr.getColor(w),G=v.color||this.zr.getColor(w),L="M"+A+","+M+"A"+C+","+C+",0,"+B+",1,"+A+","+x+"A"+F+","+F+",0,"+o+",1,"+A+","+M,H={color:s,path:L},D={zlevel:J.zlevel,z:J.z,style:H,highlightStyle:{color:G,lineWidth:v.borderWidth,strokeColor:v.borderColor}};D=new c(D),D.buildPathArray&&(D.style.pathArray=D.buildPathArray(H.path)),m.pack(D,q[I],0,E,w,E.name),this.shapeList.push(D)},getCircle:function(A,C,y,q,p,a){var D=this.series[A],x=[y,D],z=this.deepMerge(x,"itemStyle.normal")||{},v=this.deepMerge(x,"itemStyle.emphasis")||{},u=z.color||this.zr.getColor(C),w=v.color||this.zr.getColor(C),B={zlevel:D.zlevel,z:D.z,clickable:!0,style:{x:q,y:p,r:a,brushType:"fill",opacity:1,color:u},highlightStyle:{color:w,lineWidth:v.borderWidth,strokeColor:v.borderColor}};return this.deepQuery([y,D,this.option],"calculable")&&(this.setCalculable(B),B.draggable=!0),new j(B)},getLabel:function(I,x,F,L,C,A){var z=this.series[I],E=z.itemStyle,G=[F,z],D=this.deepMerge(G,"itemStyle.normal")||{},n="normal",q=E[n].label,J=q.textStyle||{},B=this.getLabelText(x,F,n),K=this.getFont(J),w=D.color||this.zr.getColor(x),v=J.fontSize||12,H={zlevel:z.zlevel,z:z.z,style:{x:L,y:C-A-v,color:J.color||w,text:B,textFont:K,textAlign:"center"}};return new d(H)},getLabelText:function(r,q,p){var u=this.series,l=u[0],s=this.deepQuery([q,l],"itemStyle."+p+".label.formatter");return s?"function"==typeof s?s(l.name,q.name,q.value):"string"==typeof s?(s=s.replace("{a}","{a0}").replace("{b}","{b0}").replace("{c}","{c0}"),s=s.replace("{a0}",l.name).replace("{b0}",q.name).replace("{c0}",q.value)):void 0:q.name},refresh:function(a){a&&(this.option=a,this.series=a.series),this._buildShape()}},f.inherits(k,g),h("../chart").define("venn",k),k}),define("zrender/shape/Path",["require","./Base","./util/PathProxy","../tool/util"],function(h){var d=h("./Base"),c=h("./util/PathProxy"),k=c.PathSegment,b=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])},j=function(i,a){return(i[0]*a[0]+i[1]*a[1])/(b(i)*b(a))},g=function(i,a){return(i[0]*a[1]<i[1]*a[0]?-1:1)*Math.acos(j(i,a))},f=function(a){d.call(this,a)};return f.prototype={type:"path",buildPathArray:function(Y,G,Q){if(!Y){return[]}G=G||0,Q=Q||0;var ac=Y,M=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];ac=ac.replace(/-/g," -"),ac=ac.replace(/  /g," "),ac=ac.replace(/ /g,","),ac=ac.replace(/,,/g,",");var I;for(I=0;I<M.length;I++){ac=ac.replace(new RegExp(M[I],"g"),"|"+M[I])}var H=ac.split("|"),O=[],R=0,N=0;for(I=1;I<H.length;I++){var w=H[I],z=w.charAt(0);w=w.slice(1),w=w.replace(new RegExp("e,-","g"),"e-");var Z=w.split(",");Z.length>0&&""===Z[0]&&Z.shift();for(var J=0;J<Z.length;J++){Z[J]=parseFloat(Z[J])}for(;Z.length>0&&!isNaN(Z[0]);){var aa,F,C,S,ab,T,P,ad,D=null,A=[],q=R,n=N;switch(z){case"l":R+=Z.shift(),N+=Z.shift(),D="L",A.push(R,N);break;case"L":R=Z.shift(),N=Z.shift(),A.push(R,N);break;case"m":R+=Z.shift(),N+=Z.shift(),D="M",A.push(R,N),z="l";break;case"M":R=Z.shift(),N=Z.shift(),D="M",A.push(R,N),z="L";break;case"h":R+=Z.shift(),D="L",A.push(R,N);break;case"H":R=Z.shift(),D="L",A.push(R,N);break;case"v":N+=Z.shift(),D="L",A.push(R,N);break;case"V":N=Z.shift(),D="L",A.push(R,N);break;case"C":A.push(Z.shift(),Z.shift(),Z.shift(),Z.shift()),R=Z.shift(),N=Z.shift(),A.push(R,N);break;case"c":A.push(R+Z.shift(),N+Z.shift(),R+Z.shift(),N+Z.shift()),R+=Z.shift(),N+=Z.shift(),D="C",A.push(R,N);break;case"S":aa=R,F=N,C=O[O.length-1],"C"===C.command&&(aa=R+(R-C.points[2]),F=N+(N-C.points[3])),A.push(aa,F,Z.shift(),Z.shift()),R=Z.shift(),N=Z.shift(),D="C",A.push(R,N);break;case"s":aa=R,F=N,C=O[O.length-1],"C"===C.command&&(aa=R+(R-C.points[2]),F=N+(N-C.points[3])),A.push(aa,F,R+Z.shift(),N+Z.shift()),R+=Z.shift(),N+=Z.shift(),D="C",A.push(R,N);break;case"Q":A.push(Z.shift(),Z.shift()),R=Z.shift(),N=Z.shift(),A.push(R,N);break;case"q":A.push(R+Z.shift(),N+Z.shift()),R+=Z.shift(),N+=Z.shift(),D="Q",A.push(R,N);break;case"T":aa=R,F=N,C=O[O.length-1],"Q"===C.command&&(aa=R+(R-C.points[0]),F=N+(N-C.points[1])),R=Z.shift(),N=Z.shift(),D="Q",A.push(aa,F,R,N);break;case"t":aa=R,F=N,C=O[O.length-1],"Q"===C.command&&(aa=R+(R-C.points[0]),F=N+(N-C.points[1])),R+=Z.shift(),N+=Z.shift(),D="Q",A.push(aa,F,R,N);break;case"A":S=Z.shift(),ab=Z.shift(),T=Z.shift(),P=Z.shift(),ad=Z.shift(),q=R,n=N,R=Z.shift(),N=Z.shift(),D="A",A=this._convertPoint(q,n,R,N,P,ad,S,ab,T);break;case"a":S=Z.shift(),ab=Z.shift(),T=Z.shift(),P=Z.shift(),ad=Z.shift(),q=R,n=N,R+=Z.shift(),N+=Z.shift(),D="A",A=this._convertPoint(q,n,R,N,P,ad,S,ab,T)}for(var E=0,B=A.length;B>E;E+=2){A[E]+=G,A[E+1]+=Q}O.push(new k(D||z,A))}("z"===z||"Z"===z)&&O.push(new k("z",[]))}return O},_convertPoint:function(K,z,G,C,O,A,E,H,D){var o=D*(Math.PI/180),q=Math.cos(o)*(K-G)/2+Math.sin(o)*(z-C)/2,L=-1*Math.sin(o)*(K-G)/2+Math.cos(o)*(z-C)/2,B=q*q/(E*E)+L*L/(H*H);B>1&&(E*=Math.sqrt(B),H*=Math.sqrt(B));var M=Math.sqrt((E*E*H*H-E*E*L*L-H*H*q*q)/(E*E*L*L+H*H*q*q));O===A&&(M*=-1),isNaN(M)&&(M=0);var w=M*E*L/H,r=M*-H*q/E,I=(K+G)/2+Math.cos(o)*w-Math.sin(o)*r,N=(z+C)/2+Math.sin(o)*w+Math.cos(o)*r,J=g([1,0],[(q-w)/E,(L-r)/H]),F=[(q-w)/E,(L-r)/H],P=[(-1*q-w)/E,(-1*L-r)/H],v=g(F,P);return j(F,P)<=-1&&(v=Math.PI),j(F,P)>=1&&(v=0),0===A&&v>0&&(v-=2*Math.PI),1===A&&0>v&&(v+=2*Math.PI),[I,N,E,H,J,v,o,A]},buildPath:function(Q,C){var M=C.path,H=C.x||0,W=C.y||0;C.pathArray=C.pathArray||this.buildPathArray(M,H,W);for(var G=C.pathArray,E=C.pointList=[],D=[],J=0,N=G.length;N>J;J++){"M"==G[J].command.toUpperCase()&&(D.length>0&&E.push(D),D=[]);for(var I=G[J].points,q=0,v=I.length;v>q;q+=2){D.push([I[q],I[q+1]])}}D.length>0&&E.push(D);for(var J=0,N=G.length;N>J;J++){var R=G[J].command,I=G[J].points;switch(R){case"L":Q.lineTo(I[0],I[1]);break;case"M":Q.moveTo(I[0],I[1]);break;case"C":Q.bezierCurveTo(I[0],I[1],I[2],I[3],I[4],I[5]);break;case"Q":Q.quadraticCurveTo(I[0],I[1],I[2],I[3]);break;case"A":var F=I[0],S=I[1],B=I[2],z=I[3],O=I[4],T=I[5],P=I[6],K=I[7],X=B>z?B:z,A=B>z?1:B/z,w=B>z?z/B:1;Q.translate(F,S),Q.rotate(P),Q.scale(A,w),Q.arc(0,0,X,O,O+T,1-K),Q.scale(1/A,1/w),Q.rotate(-P),Q.translate(-F,-S);break;case"z":Q.closePath()}}},getRect:function(B){if(B.__rect){return B.__rect}var D;D="stroke"==B.brushType||"fill"==B.brushType?B.lineWidth||1:0;for(var z=Number.MAX_VALUE,u=Number.MIN_VALUE,C=Number.MAX_VALUE,q=Number.MIN_VALUE,p=B.x||0,E=B.y||0,y=B.pathArray||this.buildPathArray(B.path),A=0;A<y.length;A++){for(var w=y[A].points,v=0;v<w.length;v++){v%2===0?(w[v]+p<z&&(z=w[v]),w[v]+p>u&&(u=w[v])):(w[v]+E<C&&(C=w[v]),w[v]+E>q&&(q=w[v]))}}var x;return x=z===Number.MAX_VALUE||u===Number.MIN_VALUE||C===Number.MAX_VALUE||q===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(z-D/2),y:Math.round(C-D/2),width:u-z+D,height:q-C+D},B.__rect=x,x}},h("../tool/util").inherits(f,d),f});